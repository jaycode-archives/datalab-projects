<!DOCTYPE html>
<!-- saved from url=(0153)https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>(archive-1) 2.a. Data Wrangling</title>
  <link rel="shortcut icon" type="image/x-icon" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/static/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="./(archive-1) 2.a. Data Wrangling_files/codemirror.css">
  <link rel="stylesheet" href="./(archive-1) 2.a. Data Wrangling_files/style.min.css" type="text/css">
  <link rel="stylesheet" href="./(archive-1) 2.a. Data Wrangling_files/custom.css" type="text/css">
<script async="" src="./(archive-1) 2.a. Data Wrangling_files/analytics.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./(archive-1) 2.a. Data Wrangling_files/contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./(archive-1) 2.a. Data Wrangling_files/custom.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./(archive-1) 2.a. Data Wrangling_files/extension.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/javascript/javascript" src="./(archive-1) 2.a. Data Wrangling_files/javascript.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="extensions/charting" src="./(archive-1) 2.a. Data Wrangling_files/charting.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="element" src="./(archive-1) 2.a. Data Wrangling_files/element.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="style" src="./(archive-1) 2.a. Data Wrangling_files/style.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/text/sql/text/sql" src="./(archive-1) 2.a. Data Wrangling_files/sql.js"></script><link type="text/css" rel="stylesheet" href="./(archive-1) 2.a. Data Wrangling_files/charting.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="visualization" src="./(archive-1) 2.a. Data Wrangling_files/visualization.js"></script><script type="text/javascript" async="" src="./(archive-1) 2.a. Data Wrangling_files/jsapi"></script><script type="text/javascript" src="./(archive-1) 2.a. Data Wrangling_files/saved_resource"></script><link type="text/css" href="./(archive-1) 2.a. Data Wrangling_files/ui+en,table+en.css" rel="stylesheet"><script type="text/javascript" src="./(archive-1) 2.a. Data Wrangling_files/format+en,default+en,ui+en,table+en.I.js"></script></head>
<body class="notebook_app command_mode" data-project="" data-base-url="/" data-ws-url="" data-notebook-name="(archive-1)%202.a.%20Data%20Wrangling.ipynb" data-notebook-path="Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb" data-feedback-id="717112" data-analytics-id="UA-54894152-3" data-analytics-path="408390d810c99bbdf3083828ed8fd52763e6e1874a0acc8ac34cefbc85a9c5fe" data-analytics-title="notebook" data-project-num="803616047008" data-project-id="datalab-projects-1331" data-version-id="0.5.20160527" data-instance-id="561b5a45-7726-484a-bbc6-1ee1e59337b3" data-instance-name="main" data-user-id="TeguhWPurwanto@gmail.com">
  <div id="app">
    <div id="appBar">
      <span id="logo" class="nav navbar-brand pull-left">
        <a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/tree"><img src="./(archive-1) 2.a. Data Wrangling_files/logo.png" alt="Google Cloud DataLab"></a>
      </span>
      <span id="save_widget" class="pull-left save_widget">
        <button class="btn" title="Rename notebook"><span id="notebook_name" class="filename">(archive-1) 2.a. Data Wrangling</span></button>
        <span class="autosave_status">(autosaved)</span>
      </span>
      <div class="btn-toolbar pull-right">
        <div class="btn-group">
          <button class="btn" data-toggle="dropdown" title="Help Links">
            <span class="fa fa-question-circle"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a id="keyboardHelpLink" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Keyboard Shortcuts</a></li>
            <li><a id="markdownHelpLink" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Markdown Syntax</a></li>
            <li class="divider"></li>
            <li><a href="https://cloud.google.com/bigquery/what-is-bigquery" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>BigQuery&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></a></li>
            <li><a href="https://cloud.google.com/storage/docs/overview" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Cloud Storage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></a></li>
            <li class="divider"></li>
            <li><a href="https://developers.google.com/chart/" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Google Charts</span></a></li>
            <li><a href="http://matplotlib.org/contents.html" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Matplotlib</span></a></li>
            <li><a href="http://pandas.pydata.org/pandas-docs/stable/" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Pandas</span></a></li>
            <li><a href="http://scikit-learn.org/stable/" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>SciKit-Learn</span></a></li>
          </ul>
        </div>
        <div class="btn-group">
          <button class="btn" data-toggle="dropdown" title="User and Project Information">
            <span class="fa fa-user"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" id="userId">TeguhWPurwanto@gmail.com</a></li>
            <li class="divider"></li>
            <li><a href="https://console.developers.google.com/project/datalab-projects-1331" id="consoleLink" target="_blank">Developer Console</a></li>
            <li><a href="https://console.developers.google.com/project/datalab-projects-1331/appengine/versions?moduleId=datalab" id="instancesLink" target="_blank">Developer Console: Cloud Datalab Instances</a></li>
            <li><a href="https://console.developers.google.com/project/datalab-projects-1331/clouddev/develop/browse/default/datalab_main" id="repoLink" target="_blank">Developer Console: Git Repository</a></li>
          </ul>
        </div>
        <div class="btn-group">
          <button id="feedbackButton" title="Provide feedback">
            <span class="fa fa-comment"></span>
          </button>
        </div>
        <div class="btn-group">
          <button id="aboutButton" title="About Google Cloud Datalab">
            <span class="fa fa-info-circle"></span>
          </button>
        </div>
      </div>
    </div>
    <div id="appContent">
      <div id="mainArea">
        <div id="mainToolbar">
          <div class="btn-toolbar pull-left">
            <div class="btn-group">
              <button type="button" class="btn" data-toggle="dropdown" title="Notebook commands">
                <span class="fa fa-book"></span> Notebook <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li id="saveButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Save</a></li>
                <li id="saveCopyButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Save copy</a></li>
                <li id="renameButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Rename...</a></li>
                <li class="divider"></li>
                <li id="downloadButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Download</a></li>
                <li class="divider"></li>
                <li id="convertHTMLButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Convert to HTML</a></li>
                <li id="convertPythonButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Convert to Python</a></li>
              </ul>
            </div>
          </div>
          <div class="btn-toolbar pull-right">
            <div class="btn-group">
              <button id="addCodeCellButton" type="button" class="btn" title="Append a new code cell">
                <span class="fa fa-plus-square"></span> Add Code
              </button>
              <button id="addMarkdownCellButton" type="button" class="btn" title="Append a new markdown cell">
                <span class="fa fa-plus-square"></span> Add Markdown
              </button>
              <button id="deleteCellButton" type="button" class="btn" title="Delete the selected cell">
                <span class="fa fa-minus-square"></span> Delete
              </button>
              <button id="moveCellUpButton" type="button" class="btn" title="Move the selected cell up">
                <span class="fa fa-chevron-up"></span> Move Up
              </button>
              <button id="moveCellDownButton" type="button" class="btn" title="Move the selected cell down">
                <span class="fa fa-chevron-down"></span> Move Down
              </button>
            </div>
            <div class="btn-group">
              <button id="runButton" type="button" class="btn" title="Run the selected cell">
                <span class="fa fa-play"></span> Run
              </button>
              <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li id="runAllButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Run all Cells</a></li>
                <li id="runToButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Run to this Cell</a></li>
                <li id="runFromButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Run from this Cell</a></li>
              </ul>
            </div>
            <div class="btn-group">
              <button id="clearButton" type="button" class="btn" title="Clear outputs of the selected cell">
                <span class="fa fa-minus-square-o"></span> Clear
              </button>
              <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li id="clearAllButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#">Clear all Cells</a></li>
              </ul>
            </div>
            <div class="btn-group">
              <button id="resetSessionButton" type="button" class="btn" title="Restart the current notebook session">
                <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i> Reset Session
              </button>
            </div>
          </div>
        </div>
        <div id="mainContent" class="container">
          <div id="ipython-main-app">
            <div id="notebook_panel" style="position: relative">
              <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell code_cell rendered completed selected" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 777px; margin-bottom: -17px; border-right-width: 13px; min-height: 432px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>20</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-variable">decomposition</span> <span class="cm-keyword">import</span> <span class="cm-variable">PCA</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">gcp</span>.<span class="cm-variable">bigquery</span> <span class="cm-keyword">as</span> <span class="cm-variable">bq</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">datetime</span> <span class="cm-keyword">import</span> <span class="cm-variable">date</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">datetime</span> <span class="cm-keyword">import</span> <span class="cm-variable">timedelta</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pdb</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">poi_n_range</span> = <span class="cm-number">10</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">poi_schema</span> = []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">poi_n_range</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">poi_n</span> = <span class="cm-variable">i</span><span class="cm-operator">+</span><span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">poi_schema</span>.<span class="cm-variable">append</span>({<span class="cm-string">'name'</span>: <span class="cm-string">'poi{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">poi_n</span>), <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">prev_n_range</span> = <span class="cm-number">5</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">prev_gap_schema</span> = []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">prev_n_range</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">prev_n</span> = <span class="cm-variable">i</span><span class="cm-operator">+</span><span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">prev_gap_schema</span>.<span class="cm-variable">append</span>({<span class="cm-string">'name'</span>: <span class="cm-string">'previous_gap{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">prev_n</span>), <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>})</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 432px;"></div><div class="CodeMirror-gutters" style="height: 445px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 54px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Gaps Table</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">First, make a simple <span class="cm-strong">**gaps**</span> table, then fill it with data from other tables.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 54px;"></div><div class="CodeMirror-gutters" style="display: none; height: 67px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Gaps-Table">Gaps Table<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#Gaps-Table">¶</a></h1>
<p>First, make a simple <strong>gaps</strong> table, then fill it with data from other tables.</p>
</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 894px; margin-bottom: -17px; border-right-width: 13px; min-height: 747px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>35</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%bigquery udf -m orders_create_additional_fields</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Pad with 0 or given string.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int n Number to add padding to.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int width Width of number + padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param string z (Optional) Other string to replace '0' as padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-variable">pad</span>(<span class="cm-def">n</span>, <span class="cm-def">width</span>, <span class="cm-def">z</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">z</span> <span class="cm-operator">=</span> <span class="cm-variable-2">z</span> <span class="cm-operator">||</span> <span class="cm-string">'0'</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">n</span> <span class="cm-operator">=</span> <span class="cm-variable-2">n</span> <span class="cm-operator">+</span> <span class="cm-string">''</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable-2">width</span> <span class="cm-operator">?</span> <span class="cm-variable-2">n</span> : <span class="cm-keyword">new</span> <span class="cm-variable">Array</span>(<span class="cm-variable-2">width</span> <span class="cm-operator">-</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>).<span class="cm-property">join</span>(<span class="cm-variable-2">z</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">n</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Create additional fields on orders table for gaps table creation.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param {{order_id: string, driver_id: string, passenger_id: string,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">            start_district_hash: string, dest_district_hash: string, price: float,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">            time: string}} r</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param function({{order_id: string, driver_id: string, passenger_id: string,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     start_district_hash: string, dest_district_hash: string, price: float,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     time: string, timeslot: string, timeofday_slot: integer, day_in_week: integer,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     date: string}}) emitFn</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span>(<span class="cm-def">r</span>, <span class="cm-def">emitFn</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">t</span> <span class="cm-operator">=</span> <span class="cm-variable-2">r</span>.<span class="cm-property">time</span>.<span class="cm-property">split</span>(<span class="cm-string-2">/[ :\-]/</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">slot</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">floor</span>((<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">3</span>]) <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">+</span> <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">4</span>])) <span class="cm-operator">/</span> <span class="cm-number">10</span>) <span class="cm-operator">+</span> <span class="cm-number">1</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">               <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">slot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeofday_slot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">slot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">date</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>], <span class="cm-number">2</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">day_in_week</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Date</span>(<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">0</span>]), <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>])<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>])).<span class="cm-property">getDay</span>();</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">emitFn</span>(<span class="cm-variable-2">r</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 747px;"></div><div class="CodeMirror-gutters" style="height: 760px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 831px; margin-bottom: -17px; border-right-width: 13px; min-height: 201px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%%</span><span class="cm-variable">bigquery</span> <span class="cm-variable">execute</span> <span class="cm-operator">-</span><span class="cm-variable">t</span> <span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">gaps</span> <span class="cm-operator">-</span><span class="cm-variable">m</span> <span class="cm-variable">create</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SELECT</span> <span class="cm-variable">district_id</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">orders</span>.<span class="cm-variable">timeslot</span>) <span class="cm-variable">AS</span> <span class="cm-variable">timeslot</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">orders</span>.<span class="cm-variable">date</span>) <span class="cm-variable">AS</span> <span class="cm-variable">date</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">day_in_week</span>) <span class="cm-variable">AS</span> <span class="cm-variable">day_in_week</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">timeofday_slot</span>) <span class="cm-variable">AS</span> <span class="cm-variable">timeofday_slot</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">SUM</span>(<span class="cm-variable">price</span>) <span class="cm-variable">AS</span> <span class="cm-variable">sum_price</span>, <span class="cm-variable">AVG</span>(<span class="cm-variable">price</span>) <span class="cm-variable">AS</span> <span class="cm-variable">avg_price</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">SUM</span>(<span class="cm-variable">IF</span>(<span class="cm-variable">driver_id</span> = <span class="cm-string">'NULL'</span>, <span class="cm-number">1</span>, <span class="cm-number">0</span>)) <span class="cm-variable">AS</span> <span class="cm-variable">gap</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FROM</span> <span class="cm-variable">orders_create_additional_fields</span>([<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">orders</span>]) <span class="cm-variable">AS</span> <span class="cm-variable">orders</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">JOIN</span> [<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">districts</span>] <span class="cm-variable">AS</span> <span class="cm-variable">districts</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">ON</span> <span class="cm-variable">orders</span>.<span class="cm-variable">start_district_hash</span> = <span class="cm-variable">districts</span>.<span class="cm-variable">district_hash</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">GROUP</span> <span class="cm-variable">BY</span> <span class="cm-variable">district_id</span>, <span class="cm-variable">orders</span>.<span class="cm-variable">timeslot</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 201px;"></div><div class="CodeMirror-gutters" style="height: 214px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_html rendered_html output_result">
    <div class="bqtv" id="9_146580323844"><div class="google-visualization-table" style="position: relative; z-index: 0; max-width: 100%; max-height: 100%;"><div style="position: relative; overflow: auto; max-width: 100%; max-height: 100%;"><table class="google-visualization-table-table" cellspacing="0"><thead><tr class="gchart-table-headerrow"><th class="gchart-table-headercell">&nbsp;</th><th class="gchart-table-headercell">district_id</th><th class="gchart-table-headercell">timeslot</th><th class="gchart-table-headercell">date</th><th class="gchart-table-headercell">day_in_week</th><th class="gchart-table-headercell">timeofday_slot</th><th class="gchart-table-headercell">sum_price</th><th class="gchart-table-headercell">avg_price</th><th class="gchart-table-headercell">gap</th></tr></thead><tbody><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">1</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell">2016-01-09-77</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">77</td><td class="gchart-table-cell google-visualization-table-td-number">2,620.1</td><td class="gchart-table-cell google-visualization-table-td-number">12.597</td><td class="gchart-table-cell google-visualization-table-td-number">8</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">2</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell">2016-01-09-100</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">100</td><td class="gchart-table-cell google-visualization-table-td-number">1,451.3</td><td class="gchart-table-cell google-visualization-table-td-number">14.369</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">3</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-09-139</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">139</td><td class="gchart-table-cell google-visualization-table-td-number">12,994</td><td class="gchart-table-cell google-visualization-table-td-number">28.876</td><td class="gchart-table-cell google-visualization-table-td-number">261</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">4</td><td class="gchart-table-cell google-visualization-table-td-number">37</td><td class="gchart-table-cell">2016-01-09-69</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">69</td><td class="gchart-table-cell google-visualization-table-td-number">3,259</td><td class="gchart-table-cell google-visualization-table-td-number">18.412</td><td class="gchart-table-cell google-visualization-table-td-number">46</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">5</td><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell">2016-01-09-89</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">89</td><td class="gchart-table-cell google-visualization-table-td-number">626.2</td><td class="gchart-table-cell google-visualization-table-td-number">20.873</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">6</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell">2016-01-06-50</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">50</td><td class="gchart-table-cell google-visualization-table-td-number">7,357.2</td><td class="gchart-table-cell google-visualization-table-td-number">13.987</td><td class="gchart-table-cell google-visualization-table-td-number">278</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">7</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell">2016-01-06-47</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">47</td><td class="gchart-table-cell google-visualization-table-td-number">5,666.9</td><td class="gchart-table-cell google-visualization-table-td-number">16.191</td><td class="gchart-table-cell google-visualization-table-td-number">111</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">8</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell">2016-01-06-109</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">109</td><td class="gchart-table-cell google-visualization-table-td-number">7,444.6</td><td class="gchart-table-cell google-visualization-table-td-number">19.387</td><td class="gchart-table-cell google-visualization-table-td-number">87</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">9</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell">2016-01-06-123</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">123</td><td class="gchart-table-cell google-visualization-table-td-number">2,953.1</td><td class="gchart-table-cell google-visualization-table-td-number">19.428</td><td class="gchart-table-cell google-visualization-table-td-number">4</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">10</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell">2016-01-06-28</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">28</td><td class="gchart-table-cell google-visualization-table-td-number">336</td><td class="gchart-table-cell google-visualization-table-td-number">14.609</td><td class="gchart-table-cell google-visualization-table-td-number">9</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">11</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell">2016-01-06-94</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">94</td><td class="gchart-table-cell google-visualization-table-td-number">3,976.2</td><td class="gchart-table-cell google-visualization-table-td-number">19.396</td><td class="gchart-table-cell google-visualization-table-td-number">6</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">12</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-44</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">44</td><td class="gchart-table-cell google-visualization-table-td-number">5,446</td><td class="gchart-table-cell google-visualization-table-td-number">16.453</td><td class="gchart-table-cell google-visualization-table-td-number">52</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">13</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-46</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">46</td><td class="gchart-table-cell google-visualization-table-td-number">14,069.4</td><td class="gchart-table-cell google-visualization-table-td-number">18.343</td><td class="gchart-table-cell google-visualization-table-td-number">508</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">14</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-104</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">104</td><td class="gchart-table-cell google-visualization-table-td-number">9,315.7</td><td class="gchart-table-cell google-visualization-table-td-number">16.846</td><td class="gchart-table-cell google-visualization-table-td-number">134</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">15</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-130</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">130</td><td class="gchart-table-cell google-visualization-table-td-number">6,496</td><td class="gchart-table-cell google-visualization-table-td-number">16.079</td><td class="gchart-table-cell google-visualization-table-td-number">82</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">16</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-136</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">136</td><td class="gchart-table-cell google-visualization-table-td-number">4,143.8</td><td class="gchart-table-cell google-visualization-table-td-number">16.709</td><td class="gchart-table-cell google-visualization-table-td-number">20</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">17</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-126</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">126</td><td class="gchart-table-cell google-visualization-table-td-number">6,803.6</td><td class="gchart-table-cell google-visualization-table-td-number">17.718</td><td class="gchart-table-cell google-visualization-table-td-number">46</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">18</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-48</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell google-visualization-table-td-number">18,642.2</td><td class="gchart-table-cell google-visualization-table-td-number">19.023</td><td class="gchart-table-cell google-visualization-table-td-number">730</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">19</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-72</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">72</td><td class="gchart-table-cell google-visualization-table-td-number">6,342.6</td><td class="gchart-table-cell google-visualization-table-td-number">17.816</td><td class="gchart-table-cell google-visualization-table-td-number">144</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">20</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-85</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">85</td><td class="gchart-table-cell google-visualization-table-td-number">6,414.6</td><td class="gchart-table-cell google-visualization-table-td-number">15.093</td><td class="gchart-table-cell google-visualization-table-td-number">151</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">21</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-19-90</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">90</td><td class="gchart-table-cell google-visualization-table-td-number">7,778.4</td><td class="gchart-table-cell google-visualization-table-td-number">18.389</td><td class="gchart-table-cell google-visualization-table-td-number">120</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">22</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-12-30</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">30</td><td class="gchart-table-cell google-visualization-table-td-number">554</td><td class="gchart-table-cell google-visualization-table-td-number">19.103</td><td class="gchart-table-cell google-visualization-table-td-number">4</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">23</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-12-81</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">81</td><td class="gchart-table-cell google-visualization-table-td-number">4,978.8</td><td class="gchart-table-cell google-visualization-table-td-number">16.009</td><td class="gchart-table-cell google-visualization-table-td-number">33</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">24</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-12-64</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell google-visualization-table-td-number">3,923.7</td><td class="gchart-table-cell google-visualization-table-td-number">18.684</td><td class="gchart-table-cell google-visualization-table-td-number">9</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">25</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell">2016-01-12-105</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">105</td><td class="gchart-table-cell google-visualization-table-td-number">8,734.2</td><td class="gchart-table-cell google-visualization-table-td-number">17.261</td><td class="gchart-table-cell google-visualization-table-td-number">78</td></tr></tbody></table></div><div class="google-visualization-table-div-page gradient"><div class="charts-inline-block charts-custom-button charts-custom-button-disabled charts-custom-button-collapse-right" role="button" aria-disabled="true" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-prev"></span></div></div></div><div class="charts-inline-block charts-custom-button charts-custom-button-collapse-left" role="button" tabindex="0" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-next"></span></div></div></div></div><div style="clear: both; width: 100%; height: 0px;"></div></div></div>
    <br>(rows: 163491, time: 24.7s,     1GB processed, job: job_S8t4avoFa9SzTUsOV-atv0jDIxQ)<br>
    <script>
      require(['extensions/charting', 'element!9_146580323844', 'style!/static/extensions/charting.css'],
        function(charts, dom) {
          charts.render(dom,
            {
              chartStyle:"paged_table",
              dataName:"3",
              fields:"district_id,timeslot,date,day_in_week,timeofday_slot,sum_price,avg_price,gap",
              totalRows:163491,
              rowsPerPage:25,
            }, {}, {"rows": [{"c": [{"v": 1}, {"v": "2016-01-09-77"}, {"v": "2016-01-09"}, {"v": 6}, {"v": 77}, {"v": 2620.1000000000004}, {"v": 12.596634615384618}, {"v": 8}]}, {"c": [{"v": 20}, {"v": "2016-01-09-100"}, {"v": "2016-01-09"}, {"v": 6}, {"v": 100}, {"v": 1451.3000000000004}, {"v": 14.369306930693073}, {"v": 1}]}, {"c": [{"v": 7}, {"v": "2016-01-09-139"}, {"v": "2016-01-09"}, {"v": 6}, {"v": 139}, {"v": 12994.0}, {"v": 28.875555555555554}, {"v": 261}]}, {"c": [{"v": 37}, {"v": "2016-01-09-69"}, {"v": "2016-01-09"}, {"v": 6}, {"v": 69}, {"v": 3259.000000000001}, {"v": 18.41242937853108}, {"v": 46}]}, {"c": [{"v": 9}, {"v": "2016-01-09-89"}, {"v": "2016-01-09"}, {"v": 6}, {"v": 89}, {"v": 626.2}, {"v": 20.873333333333335}, {"v": 2}]}, {"c": [{"v": 48}, {"v": "2016-01-06-50"}, {"v": "2016-01-06"}, {"v": 3}, {"v": 50}, {"v": 7357.2}, {"v": 13.987072243346008}, {"v": 278}]}, {"c": [{"v": 48}, {"v": "2016-01-06-47"}, {"v": "2016-01-06"}, {"v": 3}, {"v": 47}, {"v": 5666.900000000001}, {"v": 16.191142857142857}, {"v": 111}]}, {"c": [{"v": 48}, {"v": "2016-01-06-109"}, {"v": "2016-01-06"}, {"v": 3}, {"v": 109}, {"v": 7444.600000000001}, {"v": 19.38697916666667}, {"v": 87}]}, {"c": [{"v": 48}, {"v": "2016-01-06-123"}, {"v": "2016-01-06"}, {"v": 3}, {"v": 123}, {"v": 2953.0999999999995}, {"v": 19.428289473684206}, {"v": 4}]}, {"c": [{"v": 48}, {"v": "2016-01-06-28"}, {"v": "2016-01-06"}, {"v": 3}, {"v": 28}, {"v": 336.0}, {"v": 14.608695652173912}, {"v": 9}]}, {"c": [{"v": 48}, {"v": "2016-01-06-94"}, {"v": "2016-01-06"}, {"v": 3}, {"v": 94}, {"v": 3976.2000000000007}, {"v": 19.396097560975612}, {"v": 6}]}, {"c": [{"v": 23}, {"v": "2016-01-19-44"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 44}, {"v": 5445.999999999997}, {"v": 16.453172205438058}, {"v": 52}]}, {"c": [{"v": 23}, {"v": "2016-01-19-46"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 46}, {"v": 14069.399999999998}, {"v": 18.343415906127767}, {"v": 508}]}, {"c": [{"v": 23}, {"v": "2016-01-19-104"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 104}, {"v": 9315.699999999997}, {"v": 16.84575045207956}, {"v": 134}]}, {"c": [{"v": 23}, {"v": "2016-01-19-130"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 130}, {"v": 6495.999999999997}, {"v": 16.079207920792072}, {"v": 82}]}, {"c": [{"v": 23}, {"v": "2016-01-19-136"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 136}, {"v": 4143.799999999999}, {"v": 16.708870967741934}, {"v": 20}]}, {"c": [{"v": 23}, {"v": "2016-01-19-126"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 126}, {"v": 6803.599999999998}, {"v": 17.717708333333327}, {"v": 46}]}, {"c": [{"v": 23}, {"v": "2016-01-19-48"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 48}, {"v": 18642.199999999993}, {"v": 19.02265306122448}, {"v": 730}]}, {"c": [{"v": 23}, {"v": "2016-01-19-72"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 72}, {"v": 6342.6}, {"v": 17.81629213483146}, {"v": 144}]}, {"c": [{"v": 23}, {"v": "2016-01-19-85"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 85}, {"v": 6414.599999999999}, {"v": 15.093176470588235}, {"v": 151}]}, {"c": [{"v": 23}, {"v": "2016-01-19-90"}, {"v": "2016-01-19"}, {"v": 2}, {"v": 90}, {"v": 7778.399999999998}, {"v": 18.3886524822695}, {"v": 120}]}, {"c": [{"v": 23}, {"v": "2016-01-12-30"}, {"v": "2016-01-12"}, {"v": 2}, {"v": 30}, {"v": 554.0}, {"v": 19.103448275862068}, {"v": 4}]}, {"c": [{"v": 23}, {"v": "2016-01-12-81"}, {"v": "2016-01-12"}, {"v": 2}, {"v": 81}, {"v": 4978.8}, {"v": 16.009003215434085}, {"v": 33}]}, {"c": [{"v": 23}, {"v": "2016-01-12-64"}, {"v": "2016-01-12"}, {"v": 2}, {"v": 64}, {"v": 3923.700000000001}, {"v": 18.68428571428572}, {"v": 9}]}, {"c": [{"v": 23}, {"v": "2016-01-12-105"}, {"v": "2016-01-12"}, {"v": 2}, {"v": 105}, {"v": 8734.2}, {"v": 17.26126482213439}, {"v": 78}]}], "cols": [{"type": "number", "id": "district_id", "label": "district_id"}, {"type": "string", "id": "timeslot", "label": "timeslot"}, {"type": "string", "id": "date", "label": "date"}, {"type": "number", "id": "day_in_week", "label": "day_in_week"}, {"type": "number", "id": "timeofday_slot", "label": "timeofday_slot"}, {"type": "number", "id": "sum_price", "label": "sum_price"}, {"type": "number", "id": "avg_price", "label": "avg_price"}, {"type": "number", "id": "gap", "label": "gap"}]});
        }
      );
    </script>
  </div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 786px; margin-bottom: -17px; border-right-width: 13px; min-height: 180px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%sql --module tester</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-function">SUM</span>(<span class="cm-variable">price</span>) <span class="cm-keyword">FROM</span> <span class="cm-atom">datalab-projects-1331:xjk_algo_comp.orders</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> <span class="cm-variable">start_district_hash</span> = <span class="cm-string">'d4ec2125aff74eded207d2d915ef682f'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">AND</span> (<span class="cm-function">time</span> <span class="cm-keyword">LIKE</span> <span class="cm-string">"%2016-01-01 00:5%"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Reference only. Use above query to check if aggregation was correct, by comparing the</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># result of that from sum of district_hash = 51 and timeslot "2016-01-01-6", which </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># should be 126498.0.</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 180px;"></div><div class="CodeMirror-gutters" style="height: 193px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 201px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># +1 timeslot</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We are going to use past data to predict the gaps for the next 10 minutes (or in other words, the next timeslot). To do this, we need to update timeslot related information. Specifically we are going to do the following:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">1. Add <span class="cm-comment">`timeslot`</span> feature by one:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  - '2016-01-45' to '2016-01-46'</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  - '2016-01-144' to '2016-02-1'</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">2. Update <span class="cm-comment">`date`</span> and <span class="cm-comment">`slot`</span> features accordingly.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">3. Recalculate <span class="cm-comment">`day_in_week`</span> feature.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 201px;"></div><div class="CodeMirror-gutters" style="display: none; height: 214px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="+1-timeslot">+1 timeslot<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#+1-timeslot">¶</a></h1>
<p>We are going to use past data to predict the gaps for the next 10 minutes (or in other words, the next timeslot). To do this, we need to update timeslot related information. Specifically we are going to do the following:</p>
<ol>
<li>Add <code>timeslot</code> feature by one:<ul>
<li>'2016-01-45' to '2016-01-46'</li>
<li>'2016-01-144' to '2016-02-1'</li>
</ul>
</li>
<li>Update <code>date</code> and <code>slot</code> features accordingly.</li>
<li>Recalculate <code>day_in_week</code> feature.</li>
</ol>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 867px; margin-bottom: -17px; border-right-width: 13px; min-height: 1482px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>70</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%bigquery udf --module gaps_plus_one_timeslot</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// Use this when testing</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// %%javascript</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Pad with 0 or given string.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int n Number to add padding to.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int width Width of number + padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param string z (Optional) Other string to replace '0' as padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-variable">pad</span>(<span class="cm-def">n</span>, <span class="cm-def">width</span>, <span class="cm-def">z</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">z</span> <span class="cm-operator">=</span> <span class="cm-variable-2">z</span> <span class="cm-operator">||</span> <span class="cm-string">'0'</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">n</span> <span class="cm-operator">=</span> <span class="cm-variable-2">n</span> <span class="cm-operator">+</span> <span class="cm-string">''</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable-2">width</span> <span class="cm-operator">?</span> <span class="cm-variable-2">n</span> : <span class="cm-keyword">new</span> <span class="cm-variable">Array</span>(<span class="cm-variable-2">width</span> <span class="cm-operator">-</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>).<span class="cm-property">join</span>(<span class="cm-variable-2">z</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">n</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Add one timeslot and adjust other relevant tables.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param {{district_id: integer, timeslot: string, date: string, day_in_week: integer,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">            timeofday_slot: integer, sum_price: float, avg_price: float, gap: integer}} r</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param function({{district_id: integer, timeslot: string, date: string, day_in_week: integer,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                timeofday_slot: integer, sum_price: float, avg_price: float, gap: integer,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                timeslot_original: string}}) emitFn</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span>(<span class="cm-def">r</span>, <span class="cm-def">emitFn</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">t</span> <span class="cm-operator">=</span> <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span>.<span class="cm-property">split</span>(<span class="cm-string-2">/-/</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">oldslot</span> <span class="cm-operator">=</span> <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">3</span>]);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">newslot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">oldslot</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">d</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Date</span>(<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">0</span>]), <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>])<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>]));</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span> (<span class="cm-variable-2">oldslot</span> <span class="cm-operator">==</span> <span class="cm-number">144</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable-2">newslot</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable-2">d</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Date</span>(<span class="cm-variable-2">d</span>.<span class="cm-property">setDate</span>(<span class="cm-variable-2">d</span>.<span class="cm-property">getDate</span>() <span class="cm-operator">+</span> <span class="cm-number">1</span>));</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable-2">r</span>.<span class="cm-property">day_in_week</span> <span class="cm-operator">=</span> <span class="cm-variable-2">d</span>.<span class="cm-property">getDay</span>();</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable-2">r</span>.<span class="cm-property">date</span> <span class="cm-operator">=</span> <span class="cm-variable-2">d</span>.<span class="cm-property">getFullYear</span>() <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">d</span>.<span class="cm-property">getMonth</span>()<span class="cm-operator">+</span><span class="cm-number">1</span>, <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">             <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">d</span>.<span class="cm-property">getDate</span>(), <span class="cm-number">2</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot_original</span> <span class="cm-operator">=</span> <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">d</span>.<span class="cm-property">getFullYear</span>() <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">d</span>.<span class="cm-property">getMonth</span>()<span class="cm-operator">+</span><span class="cm-number">1</span>, <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">               <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">d</span>.<span class="cm-property">getDate</span>(), <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">newslot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeofday_slot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">newslot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">emitFn</span>(<span class="cm-variable-2">r</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">50</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">51</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// For testing (without `new Date()` after date added by 1 setDate returns milliseconds)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">52</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">53</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// var test_row = {</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">54</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   district_id: 1,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">55</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   timeslot: '2016-01-22-144',</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">56</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   date: '2016-01-22',</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">57</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   day_in_week: 5,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">58</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   timeofday_slot: 144,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">59</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   sum_price: 0.0,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">60</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   avg_price: 0.0,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">61</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   gap: 11,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">62</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// };</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">63</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">64</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// function emitter(r) {</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">65</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   for (var p in r) {</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">66</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//     element.append(p + '=' + r[p] + '&lt;br&gt;');</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">67</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">//   }</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">68</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// }</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">69</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">70</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// udf(test_row, emitter);</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 1482px;"></div><div class="CodeMirror-gutters" style="height: 1495px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 822px; margin-bottom: -17px; border-right-width: 13px; min-height: 117px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%%</span><span class="cm-variable">bigquery</span> <span class="cm-variable">execute</span> <span class="cm-operator">-</span><span class="cm-variable">t</span> <span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">future_gaps</span> <span class="cm-operator">-</span><span class="cm-variable">m</span> <span class="cm-variable">create</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SELECT</span> <span class="cm-variable">district_id</span>, <span class="cm-variable">timeslot</span>, <span class="cm-variable">date</span>, <span class="cm-variable">day_in_week</span>, <span class="cm-variable">timeofday_slot</span>, <span class="cm-variable">sum_price</span>, <span class="cm-variable">avg_price</span>, <span class="cm-variable">gap</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">timeslot_original</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FROM</span> <span class="cm-variable">gaps_plus_one_timeslot</span>([<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">gaps</span>])</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 117px;"></div><div class="CodeMirror-gutters" style="height: 130px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Gaps Table + Other Tables</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Gaps-Table-+-Other-Tables">Gaps Table + Other Tables<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#Gaps-Table-+-Other-Tables">¶</a></h1>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 957px; margin-bottom: -17px; border-right-width: 13px; min-height: 1398px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>66</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%%</span><span class="cm-variable">bigquery</span> <span class="cm-variable">execute</span> <span class="cm-operator">-</span><span class="cm-variable">t</span> <span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">future_gaps_processed</span> <span class="cm-operator">-</span><span class="cm-variable">m</span> <span class="cm-variable">create</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SELECT</span> <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">district_id</span>) <span class="cm-variable">AS</span> <span class="cm-variable">district_id</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">timeslot</span>) <span class="cm-variable">AS</span> <span class="cm-variable">timeslot</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">date</span>) <span class="cm-variable">AS</span> <span class="cm-variable">date</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">day_in_week</span>) <span class="cm-variable">AS</span> <span class="cm-variable">day_in_week</span>, <span class="cm-variable">IF</span>(<span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">day_in_week</span>) = <span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">0</span>) <span class="cm-variable">AS</span> <span class="cm-variable">is_sunday</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">timeofday_slot</span>) <span class="cm-variable">AS</span> <span class="cm-variable">timeofday_slot</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">sum_price</span>) <span class="cm-variable">AS</span> <span class="cm-variable">sum_price</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">avg_price</span>) <span class="cm-variable">AS</span> <span class="cm-variable">avg_price</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">gaps</span>.<span class="cm-variable">gap</span>) <span class="cm-variable">AS</span> <span class="cm-variable">gap</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_5</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_7</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f11_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f11_8</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f13_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f13_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f13_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f13_8</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14_10</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14_10</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14_6</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f14_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f14_8</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_7</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f15_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f15_8</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_10</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_10</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_11</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_11</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_12</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_12</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_3</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f16_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f16_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f17</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f17</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f17_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f17_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f17_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f17_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f17_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f17_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f17_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f17_5</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f19</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f19</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f19_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f19_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f19_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f19_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f19_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f19_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f19_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f19_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_10</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_10</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_11</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_11</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_5</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_7</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f1_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f1_8</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_5</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_7</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_8</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f20_9</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f20_9</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f21_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f21_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f21_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f21_2</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f22</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f22</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f22_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f22_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f22_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f22_2</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f22_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f22_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f22_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f22_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f22_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f22_5</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23_2</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23_5</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f23_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f23_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f24</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f24</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f24_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f24_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f24_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f24_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f24_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f24_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f25</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f25</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f25_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f25_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f25_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f25_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f25_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f25_7</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f25_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f25_8</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f25_9</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f25_9</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_10</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_10</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_11</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_11</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_12</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_12</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_13</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_13</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_5</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_7</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f2_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f2_8</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f3_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f3_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f3_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f3_2</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f3_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f3_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_1</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_10</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_10</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_11</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_11</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_13</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_13</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_14</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_14</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_16</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_16</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_17</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_17</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_18</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_18</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_3</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_5</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_7</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_8</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f4_9</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f4_9</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f5</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f5_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f5_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f5_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f5_3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f5_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f5_4</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f6</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f6</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f6_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f6_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f6_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f6_2</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f6_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f6_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f7</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f7</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f8</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f8</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">50</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f8_1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f8_1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f8_2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f8_2</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f8_3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f8_3</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">51</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f8_4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f8_4</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">pois</span>.<span class="cm-variable">f8_5</span>) <span class="cm-variable">AS</span> <span class="cm-variable">f8_5</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">52</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">weather</span>.<span class="cm-variable">weather</span>) <span class="cm-variable">AS</span> <span class="cm-variable">weather</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">53</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">weather</span>.<span class="cm-variable">temperature</span>) <span class="cm-variable">AS</span> <span class="cm-variable">weather_temperature</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">weather</span>.<span class="cm-variable">pm25</span>) <span class="cm-variable">AS</span> <span class="cm-variable">weather_pm25</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">54</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">traffic</span>.<span class="cm-variable">tj_level1</span>) <span class="cm-variable">AS</span> <span class="cm-variable">traffic_tj_level1</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">traffic</span>.<span class="cm-variable">tj_level2</span>) <span class="cm-variable">AS</span> <span class="cm-variable">traffic_tj_level2</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">55</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">FIRST</span>(<span class="cm-variable">traffic</span>.<span class="cm-variable">tj_level3</span>) <span class="cm-variable">AS</span> <span class="cm-variable">traffic_tj_level3</span>, <span class="cm-variable">FIRST</span>(<span class="cm-variable">traffic</span>.<span class="cm-variable">tj_level4</span>) <span class="cm-variable">AS</span> <span class="cm-variable">traffic_tj_level4</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">56</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FROM</span> [<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">future_gaps</span>] <span class="cm-keyword">as</span> <span class="cm-variable">gaps</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">57</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">LEFT</span> <span class="cm-variable">JOIN</span> [<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">districts</span>] <span class="cm-keyword">as</span> <span class="cm-variable">districts</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">58</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">ON</span> <span class="cm-variable">districts</span>.<span class="cm-variable">district_id</span> = <span class="cm-variable">gaps</span>.<span class="cm-variable">district_id</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">59</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">LEFT</span> <span class="cm-variable">JOIN</span> [<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">pois</span>] <span class="cm-keyword">as</span> <span class="cm-variable">pois</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">60</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">ON</span> <span class="cm-variable">pois</span>.<span class="cm-variable">district_hash</span> = <span class="cm-variable">districts</span>.<span class="cm-variable">district_hash</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">61</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">LEFT</span> <span class="cm-variable">JOIN</span> [<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">weather</span>] <span class="cm-keyword">as</span> <span class="cm-variable">weather</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">62</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">ON</span> <span class="cm-variable">weather</span>.<span class="cm-variable">timeslot</span> = <span class="cm-variable">gaps</span>.<span class="cm-variable">timeslot</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">63</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">LEFT</span> <span class="cm-variable">JOIN</span> [<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp</span>.<span class="cm-variable">traffic</span>] <span class="cm-keyword">as</span> <span class="cm-variable">traffic</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">64</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">ON</span> <span class="cm-variable">traffic</span>.<span class="cm-variable">timeslot</span> = <span class="cm-variable">gaps</span>.<span class="cm-variable">timeslot</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">65</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">AND</span> <span class="cm-variable">traffic</span>.<span class="cm-variable">district_hash</span> = <span class="cm-variable">districts</span>.<span class="cm-variable">district_hash</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">66</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">GROUP</span> <span class="cm-variable">BY</span> <span class="cm-variable">gaps</span>.<span class="cm-variable">district_id</span>, <span class="cm-variable">gaps</span>.<span class="cm-variable">timeslot</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 1398px;"></div><div class="CodeMirror-gutters" style="height: 1411px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 54px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># PCA</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Combine POIs (features starting with 'f...') into n number of features.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 54px;"></div><div class="CodeMirror-gutters" style="display: none; height: 67px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="PCA">PCA<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#PCA">¶</a></h1>
<p>Combine POIs (features starting with 'f...') into n number of features.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 831px; margin-bottom: -17px; border-right-width: 13px; min-height: 327px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>15</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pois</span> = <span class="cm-string">"""</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f1<span class="cm-tab" role="presentation" cm-text="	">  </span>f11<span class="cm-tab" role="presentation" cm-text="	"> </span>f11_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_5<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_6<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_7<span class="cm-tab" role="presentation" cm-text="	">   </span>f11_8<span class="cm-tab" role="presentation" cm-text="	">   </span>f13_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f13_8<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f14<span class="cm-tab" role="presentation" cm-text="	"> </span>f14_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f14_10<span class="cm-tab" role="presentation" cm-text="	">  </span>f14_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f14_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f14_6<span class="cm-tab" role="presentation" cm-text="	">   </span>f14_8<span class="cm-tab" role="presentation" cm-text="	">   </span>f15<span class="cm-tab" role="presentation" cm-text="	"> </span>f15_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f15_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f15_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f15_4<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f15_6<span class="cm-tab" role="presentation" cm-text="	">   </span>f15_7<span class="cm-tab" role="presentation" cm-text="	">   </span>f15_8<span class="cm-tab" role="presentation" cm-text="	">   </span>f16<span class="cm-tab" role="presentation" cm-text="	"> </span>f16_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f16_10<span class="cm-tab" role="presentation" cm-text="	">  </span>f16_11<span class="cm-tab" role="presentation" cm-text="	">  </span>f16_12<span class="cm-tab" role="presentation" cm-text="	">  </span>f16_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f16_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f16_6<span class="cm-tab" role="presentation" cm-text="	">   </span>f17<span class="cm-tab" role="presentation" cm-text="	"> </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f17_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f17_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f17_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f17_5<span class="cm-tab" role="presentation" cm-text="	">   </span>f19<span class="cm-tab" role="presentation" cm-text="	"> </span>f19_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f19_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f19_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f19_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f1_1<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_10<span class="cm-tab" role="presentation" cm-text="	">   </span>f1_11<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f1_2<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_3<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_4<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_5<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_6<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_7<span class="cm-tab" role="presentation" cm-text="	">    </span>f1_8<span class="cm-tab" role="presentation" cm-text="	">    </span>f20<span class="cm-tab" role="presentation" cm-text="	"> </span>f20_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f20_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f20_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f20_5<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f20_6<span class="cm-tab" role="presentation" cm-text="	">   </span>f20_7<span class="cm-tab" role="presentation" cm-text="	">   </span>f20_8<span class="cm-tab" role="presentation" cm-text="	">   </span>f20_9<span class="cm-tab" role="presentation" cm-text="	">   </span>f21_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f21_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f22<span class="cm-tab" role="presentation" cm-text="	"> </span>f22_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f22_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f22_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f22_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f22_5<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f23<span class="cm-tab" role="presentation" cm-text="	"> </span>f23_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f23_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f23_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f23_4<span class="cm-tab" role="presentation" cm-text="	">   </span>f23_5<span class="cm-tab" role="presentation" cm-text="	">   </span>f23_6<span class="cm-tab" role="presentation" cm-text="	">   </span>f24<span class="cm-tab" role="presentation" cm-text="	"> </span>f24_1<span class="cm-tab" role="presentation" cm-text="	">   </span>f24_2<span class="cm-tab" role="presentation" cm-text="	">   </span>f24_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f25<span class="cm-tab" role="presentation" cm-text="	"> </span>f25_1<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f25_3<span class="cm-tab" role="presentation" cm-text="	">   </span>f25_7<span class="cm-tab" role="presentation" cm-text="	">   </span>f25_8<span class="cm-tab" role="presentation" cm-text="	">   </span>f25_9<span class="cm-tab" role="presentation" cm-text="	">   </span>f2_1<span class="cm-tab" role="presentation" cm-text="	">    </span>f2_10<span class="cm-tab" role="presentation" cm-text="	">   </span>f2_11<span class="cm-tab" role="presentation" cm-text="	">   </span>f2_12<span class="cm-tab" role="presentation" cm-text="	">   </span>f2_13<span class="cm-tab" role="presentation" cm-text="	">   </span>f2_2<span class="cm-tab" role="presentation" cm-text="	">    </span>f2_4<span class="cm-tab" role="presentation" cm-text="	">    </span>f2_5<span class="cm-tab" role="presentation" cm-text="	">    </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f2_6<span class="cm-tab" role="presentation" cm-text="	">    </span>f2_7<span class="cm-tab" role="presentation" cm-text="	">    </span>f2_8<span class="cm-tab" role="presentation" cm-text="	">    </span>f3_1<span class="cm-tab" role="presentation" cm-text="	">    </span>f3_2<span class="cm-tab" role="presentation" cm-text="	">    </span>f3_3<span class="cm-tab" role="presentation" cm-text="	">    </span>f4<span class="cm-tab" role="presentation" cm-text="	">  </span>f4_1<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_10<span class="cm-tab" role="presentation" cm-text="	">   </span>f4_11<span class="cm-tab" role="presentation" cm-text="	">   </span>f4_13<span class="cm-tab" role="presentation" cm-text="	">   </span>f4_14<span class="cm-tab" role="presentation" cm-text="	">   </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f4_16<span class="cm-tab" role="presentation" cm-text="	">   </span>f4_17<span class="cm-tab" role="presentation" cm-text="	">   </span>f4_18<span class="cm-tab" role="presentation" cm-text="	">   </span>f4_2<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_3<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_5<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_6<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_7<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_8<span class="cm-tab" role="presentation" cm-text="	">    </span>f4_9<span class="cm-tab" role="presentation" cm-text="	">    </span>f5<span class="cm-tab" role="presentation" cm-text="	">  </span>f5_1<span class="cm-tab" role="presentation" cm-text="	">    </span></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">f5_3<span class="cm-tab" role="presentation" cm-text="	">    </span>f5_4<span class="cm-tab" role="presentation" cm-text="	">    </span>f6<span class="cm-tab" role="presentation" cm-text="	">  </span>f6_1<span class="cm-tab" role="presentation" cm-text="	">    </span>f6_2<span class="cm-tab" role="presentation" cm-text="	">    </span>f6_4<span class="cm-tab" role="presentation" cm-text="	">    </span>f7<span class="cm-tab" role="presentation" cm-text="	">  </span>f8<span class="cm-tab" role="presentation" cm-text="	">  </span>f8_1<span class="cm-tab" role="presentation" cm-text="	">    </span>f8_2<span class="cm-tab" role="presentation" cm-text="	">    </span>f8_3<span class="cm-tab" role="presentation" cm-text="	">    </span>f8_4<span class="cm-tab" role="presentation" cm-text="	">    </span>f8_5</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pois</span> = <span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">"{}"</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">x</span>.<span class="cm-variable">strip</span>()), <span class="cm-variable">pois</span>.<span class="cm-variable">split</span>(<span class="cm-string">'\t'</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span>(<span class="cm-variable">pois</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 327px;"></div><div class="CodeMirror-gutters" style="height: 340px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 660px; margin-bottom: -17px; border-right-width: 13px; min-height: 54px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%sql --module q</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> * <span class="cm-keyword">FROM</span> [<span class="cm-atom">datalab-projects-1331:xjk_algo_comp.future_gaps_processed</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 54px;"></div><div class="CodeMirror-gutters" style="height: 67px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 957px; margin-bottom: -17px; border-right-width: 13px; min-height: 558px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>26</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">query</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Query</span>(<span class="cm-variable">q</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tableresult</span> = <span class="cm-variable">query</span>.<span class="cm-variable">results</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">poi_fields</span> = [<span class="cm-string">'f1'</span>, <span class="cm-string">'f11'</span>, <span class="cm-string">'f11_1'</span>, <span class="cm-string">'f11_2'</span>, <span class="cm-string">'f11_3'</span>, <span class="cm-string">'f11_4'</span>, <span class="cm-string">'f11_5'</span>, <span class="cm-string">'f11_6'</span>, <span class="cm-string">'f11_7'</span>, <span class="cm-string">'f11_8'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f13_4'</span>, <span class="cm-string">'f13_8'</span>, <span class="cm-string">'f14'</span>, <span class="cm-string">'f14_1'</span>, <span class="cm-string">'f14_10'</span>, <span class="cm-string">'f14_2'</span>, <span class="cm-string">'f14_3'</span>, <span class="cm-string">'f14_6'</span>, <span class="cm-string">'f14_8'</span>, <span class="cm-string">'f15'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f15_1'</span>, <span class="cm-string">'f15_2'</span>, <span class="cm-string">'f15_3'</span>, <span class="cm-string">'f15_4'</span>, <span class="cm-string">'f15_6'</span>, <span class="cm-string">'f15_7'</span>, <span class="cm-string">'f15_8'</span>, <span class="cm-string">'f16'</span>, <span class="cm-string">'f16_1'</span>, <span class="cm-string">'f16_10'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f16_11'</span>, <span class="cm-string">'f16_12'</span>, <span class="cm-string">'f16_3'</span>, <span class="cm-string">'f16_4'</span>, <span class="cm-string">'f16_6'</span>, <span class="cm-string">'f17'</span>, <span class="cm-string">'f17_2'</span>, <span class="cm-string">'f17_3'</span>, <span class="cm-string">'f17_4'</span>, <span class="cm-string">'f17_5'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f19'</span>, <span class="cm-string">'f19_1'</span>, <span class="cm-string">'f19_2'</span>, <span class="cm-string">'f19_3'</span>, <span class="cm-string">'f19_4'</span>, <span class="cm-string">'f1_1'</span>, <span class="cm-string">'f1_10'</span>, <span class="cm-string">'f1_11'</span>, <span class="cm-string">'f1_2'</span>, <span class="cm-string">'f1_3'</span>, <span class="cm-string">'f1_4'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f1_5'</span>, <span class="cm-string">'f1_6'</span>, <span class="cm-string">'f1_7'</span>, <span class="cm-string">'f1_8'</span>, <span class="cm-string">'f20'</span>, <span class="cm-string">'f20_1'</span>, <span class="cm-string">'f20_2'</span>, <span class="cm-string">'f20_4'</span>, <span class="cm-string">'f20_5'</span>, <span class="cm-string">'f20_6'</span>, <span class="cm-string">'f20_7'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f20_8'</span>, <span class="cm-string">'f20_9'</span>, <span class="cm-string">'f21_1'</span>, <span class="cm-string">'f21_2'</span>, <span class="cm-string">'f22'</span>, <span class="cm-string">'f22_1'</span>, <span class="cm-string">'f22_2'</span>, <span class="cm-string">'f22_3'</span>, <span class="cm-string">'f22_4'</span>, <span class="cm-string">'f22_5'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f23'</span>, <span class="cm-string">'f23_1'</span>, <span class="cm-string">'f23_2'</span>, <span class="cm-string">'f23_3'</span>, <span class="cm-string">'f23_4'</span>, <span class="cm-string">'f23_5'</span>, <span class="cm-string">'f23_6'</span>, <span class="cm-string">'f24'</span>, <span class="cm-string">'f24_1'</span>, <span class="cm-string">'f24_2'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f24_3'</span>, <span class="cm-string">'f25'</span>, <span class="cm-string">'f25_1'</span>, <span class="cm-string">'f25_3'</span>, <span class="cm-string">'f25_7'</span>, <span class="cm-string">'f25_8'</span>, <span class="cm-string">'f25_9'</span>, <span class="cm-string">'f2_1'</span>, <span class="cm-string">'f2_10'</span>, <span class="cm-string">'f2_11'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f2_12'</span>, <span class="cm-string">'f2_13'</span>, <span class="cm-string">'f2_2'</span>, <span class="cm-string">'f2_4'</span>, <span class="cm-string">'f2_5'</span>, <span class="cm-string">'f2_6'</span>, <span class="cm-string">'f2_7'</span>, <span class="cm-string">'f2_8'</span>, <span class="cm-string">'f3_1'</span>, <span class="cm-string">'f3_2'</span>, <span class="cm-string">'f3_3'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f4'</span>, <span class="cm-string">'f4_1'</span>, <span class="cm-string">'f4_10'</span>, <span class="cm-string">'f4_11'</span>, <span class="cm-string">'f4_13'</span>, <span class="cm-string">'f4_14'</span>, <span class="cm-string">'f4_16'</span>, <span class="cm-string">'f4_17'</span>, <span class="cm-string">'f4_18'</span>, <span class="cm-string">'f4_2'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f4_3'</span>, <span class="cm-string">'f4_5'</span>, <span class="cm-string">'f4_6'</span>, <span class="cm-string">'f4_7'</span>, <span class="cm-string">'f4_8'</span>, <span class="cm-string">'f4_9'</span>, <span class="cm-string">'f5'</span>, <span class="cm-string">'f5_1'</span>, <span class="cm-string">'f5_3'</span>, <span class="cm-string">'f5_4'</span>, <span class="cm-string">'f6'</span>, <span class="cm-string">'f6_1'</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-string">'f6_2'</span>, <span class="cm-string">'f6_4'</span>, <span class="cm-string">'f7'</span>, <span class="cm-string">'f8'</span>, <span class="cm-string">'f8_1'</span>, <span class="cm-string">'f8_2'</span>, <span class="cm-string">'f8_3'</span>, <span class="cm-string">'f8_4'</span>, <span class="cm-string">'f8_5'</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_fields</span> = <span class="cm-variable">tableresult</span>[<span class="cm-number">0</span>].<span class="cm-variable">keys</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data</span> = []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pois_data</span> = <span class="cm-variable">np</span>.<span class="cm-variable">zeros</span>((<span class="cm-variable">tableresult</span>.<span class="cm-variable">length</span>, <span class="cm-builtin">len</span>(<span class="cm-variable">poi_fields</span>)))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'there are {} rows'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">tableresult</span>.<span class="cm-variable">length</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">rcounter</span>, <span class="cm-variable">row</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">tableresult</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">fcounter</span>, <span class="cm-variable">field</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">poi_fields</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">pois_data</span>[<span class="cm-variable">rcounter</span>, <span class="cm-variable">fcounter</span>] = <span class="cm-variable">row</span>.<span class="cm-variable">pop</span>(<span class="cm-variable">field</span>, <span class="cm-builtin">None</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">all_data</span>.<span class="cm-variable">append</span>(<span class="cm-variable">row</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span> <span class="cm-variable">rcounter</span> <span class="cm-operator">%</span> <span class="cm-number">5000</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">'processed {} rows'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">rcounter</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 558px;"></div><div class="CodeMirror-gutters" style="height: 571px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>there are 163491 rows
processed 0 rows
processed 5000 rows
processed 10000 rows
processed 15000 rows
processed 20000 rows
processed 25000 rows
processed 30000 rows
processed 35000 rows
processed 40000 rows
processed 45000 rows
processed 50000 rows
processed 55000 rows
processed 60000 rows
processed 65000 rows
processed 70000 rows
processed 75000 rows
processed 80000 rows
processed 85000 rows
processed 90000 rows
processed 95000 rows
processed 100000 rows
processed 105000 rows
processed 110000 rows
processed 115000 rows
processed 120000 rows
processed 125000 rows
processed 130000 rows
processed 135000 rows
processed 140000 rows
processed 145000 rows
processed 150000 rows
processed 155000 rows
processed 160000 rows
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 381px; margin-bottom: -17px; border-right-width: 13px; min-height: 54px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pca</span> = <span class="cm-variable">PCA</span>(<span class="cm-variable">n_components</span>=<span class="cm-variable">poi_n_range</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pois_data_s</span> = <span class="cm-variable">pca</span>.<span class="cm-variable">fit_transform</span>(<span class="cm-variable">pois_data</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 54px;"></div><div class="CodeMirror-gutters" style="height: 67px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 705px; margin-bottom: -17px; border-right-width: 13px; min-height: 75px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">rcounter</span>, <span class="cm-variable">row</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">all_data</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">index</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">pois_data_s</span>.<span class="cm-variable">shape</span>[<span class="cm-number">1</span>]):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">all_data</span>[<span class="cm-variable">rcounter</span>][<span class="cm-string">'poi{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">index</span><span class="cm-operator">+</span><span class="cm-number">1</span>)] = <span class="cm-variable">pois_data_s</span>[<span class="cm-variable">rcounter</span>, <span class="cm-variable">index</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 75px;"></div><div class="CodeMirror-gutters" style="height: 88px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 840px; margin-bottom: -17px; border-right-width: 13px; min-height: 684px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>32</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>([</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'district_id'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'timeslot'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'date'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'timeofday_slot'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'day_in_week'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'is_sunday'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'sum_price'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'avg_price'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level1'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level2'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level3'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level4'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'weather'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'weather_pm25'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'weather_temperature'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'gap'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">] <span class="cm-operator">+</span> <span class="cm-variable">poi_schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp.future_gaps_final1'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">delete</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span> = <span class="cm-variable">pd</span>.<span class="cm-variable">DataFrame</span>(<span class="cm-variable">all_data</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level1'</span>] = <span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level1'</span>].<span class="cm-variable">fillna</span>(<span class="cm-number">0</span>).<span class="cm-variable">astype</span>(<span class="cm-string">'int64'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level2'</span>] = <span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level2'</span>].<span class="cm-variable">fillna</span>(<span class="cm-number">0</span>).<span class="cm-variable">astype</span>(<span class="cm-string">'int64'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level3'</span>] = <span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level3'</span>].<span class="cm-variable">fillna</span>(<span class="cm-number">0</span>).<span class="cm-variable">astype</span>(<span class="cm-string">'int64'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level4'</span>] = <span class="cm-variable">all_data_df</span>[<span class="cm-string">'traffic_tj_level4'</span>].<span class="cm-variable">fillna</span>(<span class="cm-number">0</span>).<span class="cm-variable">astype</span>(<span class="cm-string">'int64'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data_df</span>[<span class="cm-string">'weather'</span>] = <span class="cm-variable">all_data_df</span>[<span class="cm-string">'weather'</span>].<span class="cm-variable">fillna</span>(<span class="cm-number">0</span>).<span class="cm-variable">astype</span>(<span class="cm-string">'int64'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span>.<span class="cm-variable">insert_data</span>(<span class="cm-variable">all_data_df</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 684px;"></div><div class="CodeMirror-gutters" style="height: 697px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[27]:</div><div class="output_subarea output_html rendered_html output_result">
    <div class="bqtv" id="6_146579895021"><div class="google-visualization-table" style="position: relative; z-index: 0; max-width: 100%; max-height: 100%;"><div style="position: relative; overflow: auto; max-width: 100%; max-height: 100%;"><table class="google-visualization-table-table" cellspacing="0"><thead><tr class="gchart-table-headerrow"><th class="gchart-table-headercell unsorted">district_id<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">timeslot<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">date<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">timeofday_slot<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">day_in_week<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">is_sunday<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">sum_price<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">avg_price<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level1<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level2<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level3<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level4<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">weather<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">weather_pm25<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">weather_temperature<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">gap<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi1<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi2<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi3<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi4<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi5<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi6<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi7<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi8<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi9<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi10<span class="google-visualization-table-sortind"></span></th></tr></thead><tbody><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">31</td><td class="gchart-table-cell">2016-01-01-132</td><td class="gchart-table-cell">2016-01-01</td><td class="gchart-table-cell google-visualization-table-td-number">132</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">131</td><td class="gchart-table-cell google-visualization-table-td-number">14.556</td><td class="gchart-table-cell google-visualization-table-td-number">630</td><td class="gchart-table-cell google-visualization-table-td-number">60</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">-55,528.669</td><td class="gchart-table-cell google-visualization-table-td-number">-3,665.788</td><td class="gchart-table-cell google-visualization-table-td-number">121.681</td><td class="gchart-table-cell google-visualization-table-td-number">-5,696.16</td><td class="gchart-table-cell google-visualization-table-td-number">-1,436.159</td><td class="gchart-table-cell google-visualization-table-td-number">1,383.487</td><td class="gchart-table-cell google-visualization-table-td-number">-4,241.301</td><td class="gchart-table-cell google-visualization-table-td-number">707.761</td><td class="gchart-table-cell google-visualization-table-td-number">2,489.72</td><td class="gchart-table-cell google-visualization-table-td-number">-1,447.516</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell">2016-01-16-60</td><td class="gchart-table-cell">2016-01-16</td><td class="gchart-table-cell google-visualization-table-td-number">60</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1,790.3</td><td class="gchart-table-cell google-visualization-table-td-number">17.903</td><td class="gchart-table-cell google-visualization-table-td-number">1,654</td><td class="gchart-table-cell google-visualization-table-td-number">313</td><td class="gchart-table-cell google-visualization-table-td-number">73</td><td class="gchart-table-cell google-visualization-table-td-number">81</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">117</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">128,675.369</td><td class="gchart-table-cell google-visualization-table-td-number">31,288.841</td><td class="gchart-table-cell google-visualization-table-td-number">-14,001.178</td><td class="gchart-table-cell google-visualization-table-td-number">1,242.641</td><td class="gchart-table-cell google-visualization-table-td-number">39,493.875</td><td class="gchart-table-cell google-visualization-table-td-number">23,091.719</td><td class="gchart-table-cell google-visualization-table-td-number">7,526.825</td><td class="gchart-table-cell google-visualization-table-td-number">-12,527.044</td><td class="gchart-table-cell google-visualization-table-td-number">-2,534.168</td><td class="gchart-table-cell google-visualization-table-td-number">295.209</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell">2016-01-20-71</td><td class="gchart-table-cell">2016-01-20</td><td class="gchart-table-cell google-visualization-table-td-number">71</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">140</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell google-visualization-table-td-number">191</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">-62,654.032</td><td class="gchart-table-cell google-visualization-table-td-number">6,028.485</td><td class="gchart-table-cell google-visualization-table-td-number">-4,445.549</td><td class="gchart-table-cell google-visualization-table-td-number">-10,283.329</td><td class="gchart-table-cell google-visualization-table-td-number">5,597.916</td><td class="gchart-table-cell google-visualization-table-td-number">-709.945</td><td class="gchart-table-cell google-visualization-table-td-number">730.248</td><td class="gchart-table-cell google-visualization-table-td-number">1,275.142</td><td class="gchart-table-cell google-visualization-table-td-number">298.17</td><td class="gchart-table-cell google-visualization-table-td-number">2,850.165</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell">2016-01-14-83</td><td class="gchart-table-cell">2016-01-14</td><td class="gchart-table-cell google-visualization-table-td-number">83</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">245</td><td class="gchart-table-cell google-visualization-table-td-number">24.5</td><td class="gchart-table-cell google-visualization-table-td-number">361</td><td class="gchart-table-cell google-visualization-table-td-number">68</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell google-visualization-table-td-number">16</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">125</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">-55,675.972</td><td class="gchart-table-cell google-visualization-table-td-number">197.557</td><td class="gchart-table-cell google-visualization-table-td-number">1,409.86</td><td class="gchart-table-cell google-visualization-table-td-number">-5,526.462</td><td class="gchart-table-cell google-visualization-table-td-number">-1,318.212</td><td class="gchart-table-cell google-visualization-table-td-number">441.985</td><td class="gchart-table-cell google-visualization-table-td-number">-1,170.481</td><td class="gchart-table-cell google-visualization-table-td-number">972.374</td><td class="gchart-table-cell google-visualization-table-td-number">1,210.753</td><td class="gchart-table-cell google-visualization-table-td-number">964.329</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell">2016-01-19-91</td><td class="gchart-table-cell">2016-01-19</td><td class="gchart-table-cell google-visualization-table-td-number">91</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">375.1</td><td class="gchart-table-cell google-visualization-table-td-number">34.1</td><td class="gchart-table-cell google-visualization-table-td-number">318</td><td class="gchart-table-cell google-visualization-table-td-number">86</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">103</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">-55,675.972</td><td class="gchart-table-cell google-visualization-table-td-number">197.557</td><td class="gchart-table-cell google-visualization-table-td-number">1,409.86</td><td class="gchart-table-cell google-visualization-table-td-number">-5,526.462</td><td class="gchart-table-cell google-visualization-table-td-number">-1,318.212</td><td class="gchart-table-cell google-visualization-table-td-number">441.985</td><td class="gchart-table-cell google-visualization-table-td-number">-1,170.481</td><td class="gchart-table-cell google-visualization-table-td-number">972.374</td><td class="gchart-table-cell google-visualization-table-td-number">1,210.753</td><td class="gchart-table-cell google-visualization-table-td-number">964.329</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">45</td><td class="gchart-table-cell">2016-01-12-94</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">94</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">105.8</td><td class="gchart-table-cell google-visualization-table-td-number">35.267</td><td class="gchart-table-cell google-visualization-table-td-number">110</td><td class="gchart-table-cell google-visualization-table-td-number">16</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">-66,735.126</td><td class="gchart-table-cell google-visualization-table-td-number">-3,337.616</td><td class="gchart-table-cell google-visualization-table-td-number">-5,161.294</td><td class="gchart-table-cell google-visualization-table-td-number">-10,325.811</td><td class="gchart-table-cell google-visualization-table-td-number">2,348.68</td><td class="gchart-table-cell google-visualization-table-td-number">-2,748.106</td><td class="gchart-table-cell google-visualization-table-td-number">-1,872.774</td><td class="gchart-table-cell google-visualization-table-td-number">2,975.825</td><td class="gchart-table-cell google-visualization-table-td-number">586.35</td><td class="gchart-table-cell google-visualization-table-td-number">1,090.329</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell">2016-01-18-46</td><td class="gchart-table-cell">2016-01-18</td><td class="gchart-table-cell google-visualization-table-td-number">46</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1,993.3</td><td class="gchart-table-cell google-visualization-table-td-number">14.137</td><td class="gchart-table-cell google-visualization-table-td-number">1,445</td><td class="gchart-table-cell google-visualization-table-td-number">327</td><td class="gchart-table-cell google-visualization-table-td-number">88</td><td class="gchart-table-cell google-visualization-table-td-number">80</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">81</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">48,245.89</td><td class="gchart-table-cell google-visualization-table-td-number">-341.806</td><td class="gchart-table-cell google-visualization-table-td-number">8,231.713</td><td class="gchart-table-cell google-visualization-table-td-number">29,193.673</td><td class="gchart-table-cell google-visualization-table-td-number">4,288.375</td><td class="gchart-table-cell google-visualization-table-td-number">-28,909.261</td><td class="gchart-table-cell google-visualization-table-td-number">-4,401.507</td><td class="gchart-table-cell google-visualization-table-td-number">-5,676.784</td><td class="gchart-table-cell google-visualization-table-td-number">-8,417.264</td><td class="gchart-table-cell google-visualization-table-td-number">-435.325</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">42</td><td class="gchart-table-cell">2016-01-20-1</td><td class="gchart-table-cell">2016-01-20</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">645</td><td class="gchart-table-cell google-visualization-table-td-number">19.545</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">5,159.047</td><td class="gchart-table-cell google-visualization-table-td-number">25,063.546</td><td class="gchart-table-cell google-visualization-table-td-number">26,556.776</td><td class="gchart-table-cell google-visualization-table-td-number">14,427.926</td><td class="gchart-table-cell google-visualization-table-td-number">-21,064.583</td><td class="gchart-table-cell google-visualization-table-td-number">1,391.519</td><td class="gchart-table-cell google-visualization-table-td-number">1,272.363</td><td class="gchart-table-cell google-visualization-table-td-number">-10,635.053</td><td class="gchart-table-cell google-visualization-table-td-number">4,077.151</td><td class="gchart-table-cell google-visualization-table-td-number">1,679.005</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">10</td><td class="gchart-table-cell">2016-01-13-58</td><td class="gchart-table-cell">2016-01-13</td><td class="gchart-table-cell google-visualization-table-td-number">58</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">150.7</td><td class="gchart-table-cell google-visualization-table-td-number">21.529</td><td class="gchart-table-cell google-visualization-table-td-number">160</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">84</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">-67,611.826</td><td class="gchart-table-cell google-visualization-table-td-number">-898.594</td><td class="gchart-table-cell google-visualization-table-td-number">-7,635.177</td><td class="gchart-table-cell google-visualization-table-td-number">-8,032.089</td><td class="gchart-table-cell google-visualization-table-td-number">5,210.178</td><td class="gchart-table-cell google-visualization-table-td-number">-2,477.075</td><td class="gchart-table-cell google-visualization-table-td-number">1,930.207</td><td class="gchart-table-cell google-visualization-table-td-number">929.994</td><td class="gchart-table-cell google-visualization-table-td-number">-88.204</td><td class="gchart-table-cell google-visualization-table-td-number">738.212</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">32</td><td class="gchart-table-cell">2016-01-02-108</td><td class="gchart-table-cell">2016-01-02</td><td class="gchart-table-cell google-visualization-table-td-number">108</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">130</td><td class="gchart-table-cell google-visualization-table-td-number">18.571</td><td class="gchart-table-cell google-visualization-table-td-number">148</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">85</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">-61,194.568</td><td class="gchart-table-cell google-visualization-table-td-number">-1,660.198</td><td class="gchart-table-cell google-visualization-table-td-number">-240.66</td><td class="gchart-table-cell google-visualization-table-td-number">-7,812.038</td><td class="gchart-table-cell google-visualization-table-td-number">-314.309</td><td class="gchart-table-cell google-visualization-table-td-number">951.826</td><td class="gchart-table-cell google-visualization-table-td-number">-2,217.22</td><td class="gchart-table-cell google-visualization-table-td-number">271.076</td><td class="gchart-table-cell google-visualization-table-td-number">1,307.603</td><td class="gchart-table-cell google-visualization-table-td-number">-446.363</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">51</td><td class="gchart-table-cell">2016-01-09-76</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">76</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">7,977.1</td><td class="gchart-table-cell google-visualization-table-td-number">17.342</td><td class="gchart-table-cell google-visualization-table-td-number">3,666</td><td class="gchart-table-cell google-visualization-table-td-number">1,685</td><td class="gchart-table-cell google-visualization-table-td-number">513</td><td class="gchart-table-cell google-visualization-table-td-number">317</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">159</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">708,222.866</td><td class="gchart-table-cell google-visualization-table-td-number">56,252.643</td><td class="gchart-table-cell google-visualization-table-td-number">45,318.944</td><td class="gchart-table-cell google-visualization-table-td-number">-31,516.352</td><td class="gchart-table-cell google-visualization-table-td-number">6,643.825</td><td class="gchart-table-cell google-visualization-table-td-number">-6,255.78</td><td class="gchart-table-cell google-visualization-table-td-number">-5,874.628</td><td class="gchart-table-cell google-visualization-table-td-number">5,230.071</td><td class="gchart-table-cell google-visualization-table-td-number">960.212</td><td class="gchart-table-cell google-visualization-table-td-number">925.726</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell">2016-01-12-99</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">99</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">279.9</td><td class="gchart-table-cell google-visualization-table-td-number">31.1</td><td class="gchart-table-cell google-visualization-table-td-number">424</td><td class="gchart-table-cell google-visualization-table-td-number">120</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">68</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-49,107.54</td><td class="gchart-table-cell google-visualization-table-td-number">-2,692.847</td><td class="gchart-table-cell google-visualization-table-td-number">9,935.232</td><td class="gchart-table-cell google-visualization-table-td-number">-3,298.624</td><td class="gchart-table-cell google-visualization-table-td-number">-5,935.495</td><td class="gchart-table-cell google-visualization-table-td-number">4,401.336</td><td class="gchart-table-cell google-visualization-table-td-number">-6,351.154</td><td class="gchart-table-cell google-visualization-table-td-number">-1,298.909</td><td class="gchart-table-cell google-visualization-table-td-number">1,189.792</td><td class="gchart-table-cell google-visualization-table-td-number">-567.575</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">34</td><td class="gchart-table-cell">2016-01-13-74</td><td class="gchart-table-cell">2016-01-13</td><td class="gchart-table-cell google-visualization-table-td-number">74</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">365.2</td><td class="gchart-table-cell google-visualization-table-td-number">24.347</td><td class="gchart-table-cell google-visualization-table-td-number">245</td><td class="gchart-table-cell google-visualization-table-td-number">53</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">88</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell google-visualization-table-td-number">-59,244.571</td><td class="gchart-table-cell google-visualization-table-td-number">-263.083</td><td class="gchart-table-cell google-visualization-table-td-number">239.665</td><td class="gchart-table-cell google-visualization-table-td-number">-3,525.035</td><td class="gchart-table-cell google-visualization-table-td-number">1,619.954</td><td class="gchart-table-cell google-visualization-table-td-number">-1,711.396</td><td class="gchart-table-cell google-visualization-table-td-number">-1,192.703</td><td class="gchart-table-cell google-visualization-table-td-number">-1,900.857</td><td class="gchart-table-cell google-visualization-table-td-number">123.528</td><td class="gchart-table-cell google-visualization-table-td-number">1,466.2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">43</td><td class="gchart-table-cell">2016-01-01-67</td><td class="gchart-table-cell">2016-01-01</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">445</td><td class="gchart-table-cell google-visualization-table-td-number">89</td><td class="gchart-table-cell google-visualization-table-td-number">209</td><td class="gchart-table-cell google-visualization-table-td-number">27</td><td class="gchart-table-cell google-visualization-table-td-number">10</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">205</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">-65,688.688</td><td class="gchart-table-cell google-visualization-table-td-number">-3,762.966</td><td class="gchart-table-cell google-visualization-table-td-number">-3,358.616</td><td class="gchart-table-cell google-visualization-table-td-number">-8,909.258</td><td class="gchart-table-cell google-visualization-table-td-number">2,158.686</td><td class="gchart-table-cell google-visualization-table-td-number">-849.345</td><td class="gchart-table-cell google-visualization-table-td-number">-1,091.309</td><td class="gchart-table-cell google-visualization-table-td-number">940.58</td><td class="gchart-table-cell google-visualization-table-td-number">581.202</td><td class="gchart-table-cell google-visualization-table-td-number">-727.832</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">40</td><td class="gchart-table-cell">2016-01-03-144</td><td class="gchart-table-cell">2016-01-03</td><td class="gchart-table-cell google-visualization-table-td-number">144</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">82</td><td class="gchart-table-cell google-visualization-table-td-number">41</td><td class="gchart-table-cell google-visualization-table-td-number">193</td><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">187</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-64,931.495</td><td class="gchart-table-cell google-visualization-table-td-number">-3,401.962</td><td class="gchart-table-cell google-visualization-table-td-number">-4,726.897</td><td class="gchart-table-cell google-visualization-table-td-number">-7,591.197</td><td class="gchart-table-cell google-visualization-table-td-number">1,775.654</td><td class="gchart-table-cell google-visualization-table-td-number">-241.225</td><td class="gchart-table-cell google-visualization-table-td-number">-1,948.923</td><td class="gchart-table-cell google-visualization-table-td-number">549.509</td><td class="gchart-table-cell google-visualization-table-td-number">1,107.801</td><td class="gchart-table-cell google-visualization-table-td-number">953.16</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell">2016-01-17-9</td><td class="gchart-table-cell">2016-01-17</td><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">889</td><td class="gchart-table-cell google-visualization-table-td-number">17.096</td><td class="gchart-table-cell google-visualization-table-td-number">1,118</td><td class="gchart-table-cell google-visualization-table-td-number">191</td><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell google-visualization-table-td-number">49</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">112</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">48,245.89</td><td class="gchart-table-cell google-visualization-table-td-number">-341.806</td><td class="gchart-table-cell google-visualization-table-td-number">8,231.713</td><td class="gchart-table-cell google-visualization-table-td-number">29,193.673</td><td class="gchart-table-cell google-visualization-table-td-number">4,288.375</td><td class="gchart-table-cell google-visualization-table-td-number">-28,909.261</td><td class="gchart-table-cell google-visualization-table-td-number">-4,401.507</td><td class="gchart-table-cell google-visualization-table-td-number">-5,676.784</td><td class="gchart-table-cell google-visualization-table-td-number">-8,417.264</td><td class="gchart-table-cell google-visualization-table-td-number">-435.325</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell">2016-01-05-132</td><td class="gchart-table-cell">2016-01-05</td><td class="gchart-table-cell google-visualization-table-td-number">132</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">536.4</td><td class="gchart-table-cell google-visualization-table-td-number">18.497</td><td class="gchart-table-cell google-visualization-table-td-number">554</td><td class="gchart-table-cell google-visualization-table-td-number">101</td><td class="gchart-table-cell google-visualization-table-td-number">35</td><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-47,755.889</td><td class="gchart-table-cell google-visualization-table-td-number">7,847.171</td><td class="gchart-table-cell google-visualization-table-td-number">-130.034</td><td class="gchart-table-cell google-visualization-table-td-number">3,424.895</td><td class="gchart-table-cell google-visualization-table-td-number">8,146.276</td><td class="gchart-table-cell google-visualization-table-td-number">-7,062.214</td><td class="gchart-table-cell google-visualization-table-td-number">3,952.963</td><td class="gchart-table-cell google-visualization-table-td-number">604.999</td><td class="gchart-table-cell google-visualization-table-td-number">-2,442.008</td><td class="gchart-table-cell google-visualization-table-td-number">-1,470.51</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell">2016-01-13-137</td><td class="gchart-table-cell">2016-01-13</td><td class="gchart-table-cell google-visualization-table-td-number">137</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">760.5</td><td class="gchart-table-cell google-visualization-table-td-number">9.627</td><td class="gchart-table-cell google-visualization-table-td-number">967</td><td class="gchart-table-cell google-visualization-table-td-number">109</td><td class="gchart-table-cell google-visualization-table-td-number">34</td><td class="gchart-table-cell google-visualization-table-td-number">45</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">106</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">-29,369.222</td><td class="gchart-table-cell google-visualization-table-td-number">-4,388.81</td><td class="gchart-table-cell google-visualization-table-td-number">16,971.091</td><td class="gchart-table-cell google-visualization-table-td-number">774.884</td><td class="gchart-table-cell google-visualization-table-td-number">-9,202.18</td><td class="gchart-table-cell google-visualization-table-td-number">7,186.435</td><td class="gchart-table-cell google-visualization-table-td-number">-10,669.801</td><td class="gchart-table-cell google-visualization-table-td-number">-2,019.581</td><td class="gchart-table-cell google-visualization-table-td-number">-764.15</td><td class="gchart-table-cell google-visualization-table-td-number">-3,518.752</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell">2016-01-03-6</td><td class="gchart-table-cell">2016-01-03</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">1,192</td><td class="gchart-table-cell google-visualization-table-td-number">19.541</td><td class="gchart-table-cell google-visualization-table-td-number">1,479</td><td class="gchart-table-cell google-visualization-table-td-number">122</td><td class="gchart-table-cell google-visualization-table-td-number">29</td><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">147</td><td class="gchart-table-cell google-visualization-table-td-number">10</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell google-visualization-table-td-number">128,675.369</td><td class="gchart-table-cell google-visualization-table-td-number">31,288.841</td><td class="gchart-table-cell google-visualization-table-td-number">-14,001.178</td><td class="gchart-table-cell google-visualization-table-td-number">1,242.641</td><td class="gchart-table-cell google-visualization-table-td-number">39,493.875</td><td class="gchart-table-cell google-visualization-table-td-number">23,091.719</td><td class="gchart-table-cell google-visualization-table-td-number">7,526.825</td><td class="gchart-table-cell google-visualization-table-td-number">-12,527.044</td><td class="gchart-table-cell google-visualization-table-td-number">-2,534.168</td><td class="gchart-table-cell google-visualization-table-td-number">295.209</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">29</td><td class="gchart-table-cell">2016-01-17-99</td><td class="gchart-table-cell">2016-01-17</td><td class="gchart-table-cell google-visualization-table-td-number">99</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">747.1</td><td class="gchart-table-cell google-visualization-table-td-number">29.884</td><td class="gchart-table-cell google-visualization-table-td-number">724</td><td class="gchart-table-cell google-visualization-table-td-number">191</td><td class="gchart-table-cell google-visualization-table-td-number">61</td><td class="gchart-table-cell google-visualization-table-td-number">53</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-47,097.066</td><td class="gchart-table-cell google-visualization-table-td-number">3,307.056</td><td class="gchart-table-cell google-visualization-table-td-number">7,418.353</td><td class="gchart-table-cell google-visualization-table-td-number">3,174.131</td><td class="gchart-table-cell google-visualization-table-td-number">-3,171.538</td><td class="gchart-table-cell google-visualization-table-td-number">1,888.567</td><td class="gchart-table-cell google-visualization-table-td-number">-3,952.839</td><td class="gchart-table-cell google-visualization-table-td-number">-3,341.654</td><td class="gchart-table-cell google-visualization-table-td-number">3,770.59</td><td class="gchart-table-cell google-visualization-table-td-number">1,319.488</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">45</td><td class="gchart-table-cell">2016-01-06-17</td><td class="gchart-table-cell">2016-01-06</td><td class="gchart-table-cell google-visualization-table-td-number">17</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">21</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">55</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-66,735.126</td><td class="gchart-table-cell google-visualization-table-td-number">-3,337.616</td><td class="gchart-table-cell google-visualization-table-td-number">-5,161.294</td><td class="gchart-table-cell google-visualization-table-td-number">-10,325.811</td><td class="gchart-table-cell google-visualization-table-td-number">2,348.68</td><td class="gchart-table-cell google-visualization-table-td-number">-2,748.106</td><td class="gchart-table-cell google-visualization-table-td-number">-1,872.774</td><td class="gchart-table-cell google-visualization-table-td-number">2,975.825</td><td class="gchart-table-cell google-visualization-table-td-number">586.35</td><td class="gchart-table-cell google-visualization-table-td-number">1,090.329</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell">2016-01-13-107</td><td class="gchart-table-cell">2016-01-13</td><td class="gchart-table-cell google-visualization-table-td-number">107</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1,109.6</td><td class="gchart-table-cell google-visualization-table-td-number">22.645</td><td class="gchart-table-cell google-visualization-table-td-number">635</td><td class="gchart-table-cell google-visualization-table-td-number">164</td><td class="gchart-table-cell google-visualization-table-td-number">63</td><td class="gchart-table-cell google-visualization-table-td-number">39</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">93</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">-47,755.889</td><td class="gchart-table-cell google-visualization-table-td-number">7,847.171</td><td class="gchart-table-cell google-visualization-table-td-number">-130.034</td><td class="gchart-table-cell google-visualization-table-td-number">3,424.895</td><td class="gchart-table-cell google-visualization-table-td-number">8,146.276</td><td class="gchart-table-cell google-visualization-table-td-number">-7,062.214</td><td class="gchart-table-cell google-visualization-table-td-number">3,952.963</td><td class="gchart-table-cell google-visualization-table-td-number">604.999</td><td class="gchart-table-cell google-visualization-table-td-number">-2,442.008</td><td class="gchart-table-cell google-visualization-table-td-number">-1,470.51</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell">2016-01-04-59</td><td class="gchart-table-cell">2016-01-04</td><td class="gchart-table-cell google-visualization-table-td-number">59</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">443.2</td><td class="gchart-table-cell google-visualization-table-td-number">17.046</td><td class="gchart-table-cell google-visualization-table-td-number">748</td><td class="gchart-table-cell google-visualization-table-td-number">141</td><td class="gchart-table-cell google-visualization-table-td-number">47</td><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">202</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-33,769.19</td><td class="gchart-table-cell google-visualization-table-td-number">-1,151.348</td><td class="gchart-table-cell google-visualization-table-td-number">18,533.225</td><td class="gchart-table-cell google-visualization-table-td-number">6,789.145</td><td class="gchart-table-cell google-visualization-table-td-number">-23,522.035</td><td class="gchart-table-cell google-visualization-table-td-number">7,287.983</td><td class="gchart-table-cell google-visualization-table-td-number">-1,428.287</td><td class="gchart-table-cell google-visualization-table-td-number">-1,332.114</td><td class="gchart-table-cell google-visualization-table-td-number">3,062.105</td><td class="gchart-table-cell google-visualization-table-td-number">822.534</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">31</td><td class="gchart-table-cell">2016-01-11-48</td><td class="gchart-table-cell">2016-01-11</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">672</td><td class="gchart-table-cell google-visualization-table-td-number">17.684</td><td class="gchart-table-cell google-visualization-table-td-number">599</td><td class="gchart-table-cell google-visualization-table-td-number">119</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell google-visualization-table-td-number">27</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">42</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">-55,528.669</td><td class="gchart-table-cell google-visualization-table-td-number">-3,665.788</td><td class="gchart-table-cell google-visualization-table-td-number">121.681</td><td class="gchart-table-cell google-visualization-table-td-number">-5,696.16</td><td class="gchart-table-cell google-visualization-table-td-number">-1,436.159</td><td class="gchart-table-cell google-visualization-table-td-number">1,383.487</td><td class="gchart-table-cell google-visualization-table-td-number">-4,241.301</td><td class="gchart-table-cell google-visualization-table-td-number">707.761</td><td class="gchart-table-cell google-visualization-table-td-number">2,489.72</td><td class="gchart-table-cell google-visualization-table-td-number">-1,447.516</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell">2016-01-09-75</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">75</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2,422.9</td><td class="gchart-table-cell google-visualization-table-td-number">13.461</td><td class="gchart-table-cell google-visualization-table-td-number">1,471</td><td class="gchart-table-cell google-visualization-table-td-number">385</td><td class="gchart-table-cell google-visualization-table-td-number">141</td><td class="gchart-table-cell google-visualization-table-td-number">111</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">159</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">48,245.89</td><td class="gchart-table-cell google-visualization-table-td-number">-341.806</td><td class="gchart-table-cell google-visualization-table-td-number">8,231.713</td><td class="gchart-table-cell google-visualization-table-td-number">29,193.673</td><td class="gchart-table-cell google-visualization-table-td-number">4,288.375</td><td class="gchart-table-cell google-visualization-table-td-number">-28,909.261</td><td class="gchart-table-cell google-visualization-table-td-number">-4,401.507</td><td class="gchart-table-cell google-visualization-table-td-number">-5,676.784</td><td class="gchart-table-cell google-visualization-table-td-number">-8,417.264</td><td class="gchart-table-cell google-visualization-table-td-number">-435.325</td></tr></tbody></table></div></div></div>
    <br>(rows: 0, datalab-projects-1331:xjk_algo_comp.future_gaps_final1)<br>
    <script>
      require(['extensions/charting', 'element!6_146579895021', 'style!/static/extensions/charting.css'],
        function(charts, dom) {
          charts.render(dom,
            {
              chartStyle:"table",
              dataName:"0",
              fields:"district_id,timeslot,date,timeofday_slot,day_in_week,is_sunday,sum_price,avg_price,traffic_tj_level1,traffic_tj_level2,traffic_tj_level3,traffic_tj_level4,weather,weather_pm25,weather_temperature,gap,poi1,poi2,poi3,poi4,poi5,poi6,poi7,poi8,poi9,poi10",
              totalRows:0,
              rowsPerPage:25,
            }, {}, {"rows": [{"c": [{"v": 31}, {"v": "2016-01-01-132"}, {"v": "2016-01-01"}, {"v": 132}, {"v": 5}, {"v": 0}, {"v": 131.0}, {"v": 14.555555555555555}, {"v": 630}, {"v": 60}, {"v": 14}, {"v": 14}, {"v": 2}, {"v": 128.0}, {"v": 8.0}, {"v": 4}, {"v": -55528.66884130713}, {"v": -3665.7877311167153}, {"v": 121.6808390985545}, {"v": -5696.160211060884}, {"v": -1436.1586356324203}, {"v": 1383.4872069013009}, {"v": -4241.30111214407}, {"v": 707.7608789795905}, {"v": 2489.720043658358}, {"v": -1447.5159216762775}]}, {"c": [{"v": 12}, {"v": "2016-01-16-60"}, {"v": "2016-01-16"}, {"v": 60}, {"v": 6}, {"v": 0}, {"v": 1790.3}, {"v": 17.903}, {"v": 1654}, {"v": 313}, {"v": 73}, {"v": 81}, {"v": 8}, {"v": 117.0}, {"v": 3.0}, {"v": 2}, {"v": 128675.36912207802}, {"v": 31288.84109163725}, {"v": -14001.177619992111}, {"v": 1242.6406271417618}, {"v": 39493.87489403659}, {"v": 23091.719403190295}, {"v": 7526.824808706235}, {"v": -12527.044275131584}, {"v": -2534.1675751230996}, {"v": 295.2087029388201}]}, {"c": [{"v": 56}, {"v": "2016-01-20-71"}, {"v": "2016-01-20"}, {"v": 71}, {"v": 3}, {"v": 0}, {"v": 140.0}, {"v": 20.0}, {"v": 191}, {"v": 23}, {"v": 20}, {"v": 5}, {"v": null}, {"v": null}, {"v": null}, {"v": 4}, {"v": -62654.031675997874}, {"v": 6028.484803735022}, {"v": -4445.548851447891}, {"v": -10283.329063610014}, {"v": 5597.915947424435}, {"v": -709.9454471567989}, {"v": 730.2480447667864}, {"v": 1275.1416968467174}, {"v": 298.16995815888276}, {"v": 2850.1647988092195}]}, {"c": [{"v": 38}, {"v": "2016-01-14-83"}, {"v": "2016-01-14"}, {"v": 83}, {"v": 4}, {"v": 0}, {"v": 245.0}, {"v": 24.5}, {"v": 361}, {"v": 68}, {"v": 20}, {"v": 16}, {"v": 2}, {"v": 125.0}, {"v": 8.0}, {"v": 2}, {"v": -55675.97168334918}, {"v": 197.55749255608782}, {"v": 1409.8597901207015}, {"v": -5526.461837325348}, {"v": -1318.2119825386803}, {"v": 441.98451441921895}, {"v": -1170.4813351876405}, {"v": 972.3741228581148}, {"v": 1210.753183088647}, {"v": 964.3285146391023}]}, {"c": [{"v": 38}, {"v": "2016-01-19-91"}, {"v": "2016-01-19"}, {"v": 91}, {"v": 2}, {"v": 0}, {"v": 375.1}, {"v": 34.1}, {"v": 318}, {"v": 86}, {"v": 11}, {"v": 7}, {"v": 2}, {"v": 103.0}, {"v": 5.0}, {"v": 3}, {"v": -55675.97168334918}, {"v": 197.55749255608782}, {"v": 1409.8597901207015}, {"v": -5526.461837325348}, {"v": -1318.2119825386803}, {"v": 441.98451441921895}, {"v": -1170.4813351876405}, {"v": 972.3741228581148}, {"v": 1210.753183088647}, {"v": 964.3285146391023}]}, {"c": [{"v": 45}, {"v": "2016-01-12-94"}, {"v": "2016-01-12"}, {"v": 94}, {"v": 2}, {"v": 0}, {"v": 105.8}, {"v": 35.266666666666666}, {"v": 110}, {"v": 16}, {"v": 0}, {"v": 0}, {"v": 3}, {"v": 64.0}, {"v": 4.0}, {"v": 2}, {"v": -66735.12644689214}, {"v": -3337.615706720996}, {"v": -5161.294210154281}, {"v": -10325.810608069978}, {"v": 2348.6801289249465}, {"v": -2748.1056363380744}, {"v": -1872.7739757954253}, {"v": 2975.825116126914}, {"v": 586.350266489691}, {"v": 1090.328754730865}]}, {"c": [{"v": 1}, {"v": "2016-01-18-46"}, {"v": "2016-01-18"}, {"v": 46}, {"v": 1}, {"v": 0}, {"v": 1993.2999999999995}, {"v": 14.13687943262411}, {"v": 1445}, {"v": 327}, {"v": 88}, {"v": 80}, {"v": 2}, {"v": 81.0}, {"v": 3.0}, {"v": 1}, {"v": 48245.89005979162}, {"v": -341.80638034240724}, {"v": 8231.712629865922}, {"v": 29193.673193590483}, {"v": 4288.374781572557}, {"v": -28909.26136546567}, {"v": -4401.506794546594}, {"v": -5676.7844147532805}, {"v": -8417.263753188867}, {"v": -435.3247474599002}]}, {"c": [{"v": 42}, {"v": "2016-01-20-1"}, {"v": "2016-01-20"}, {"v": 1}, {"v": 3}, {"v": 0}, {"v": 645.0}, {"v": 19.545454545454547}, {"v": null}, {"v": null}, {"v": null}, {"v": null}, {"v": null}, {"v": null}, {"v": null}, {"v": 0}, {"v": 5159.046993673655}, {"v": 25063.54640523879}, {"v": 26556.77623545344}, {"v": 14427.925791292902}, {"v": -21064.583491410158}, {"v": 1391.519130193114}, {"v": 1272.362952493876}, {"v": -10635.052799429292}, {"v": 4077.150794378404}, {"v": 1679.0045073341585}]}, {"c": [{"v": 10}, {"v": "2016-01-13-58"}, {"v": "2016-01-13"}, {"v": 58}, {"v": 3}, {"v": 0}, {"v": 150.70000000000002}, {"v": 21.528571428571432}, {"v": 160}, {"v": 14}, {"v": 0}, {"v": 2}, {"v": 2}, {"v": 84.0}, {"v": 3.0}, {"v": 4}, {"v": -67611.82610801347}, {"v": -898.5941828023707}, {"v": -7635.177177613466}, {"v": -8032.089387741988}, {"v": 5210.1782665080755}, {"v": -2477.0750304801663}, {"v": 1930.2069894775955}, {"v": 929.9941455407438}, {"v": -88.20441842574546}, {"v": 738.2117674524503}]}, {"c": [{"v": 32}, {"v": "2016-01-02-108"}, {"v": "2016-01-02"}, {"v": 108}, {"v": 6}, {"v": 0}, {"v": 130.0}, {"v": 18.571428571428573}, {"v": 148}, {"v": 13}, {"v": 0}, {"v": 2}, {"v": 2}, {"v": 85.0}, {"v": 14.0}, {"v": 3}, {"v": -61194.568389101645}, {"v": -1660.1976219990602}, {"v": -240.65955409524784}, {"v": -7812.03838761322}, {"v": -314.30945933104056}, {"v": 951.8262447256409}, {"v": -2217.22041197867}, {"v": 271.07585259212425}, {"v": 1307.6025657742475}, {"v": -446.3634054322516}]}, {"c": [{"v": 51}, {"v": "2016-01-09-76"}, {"v": "2016-01-09"}, {"v": 76}, {"v": 6}, {"v": 0}, {"v": 7977.100000000002}, {"v": 17.34152173913044}, {"v": 3666}, {"v": 1685}, {"v": 513}, {"v": 317}, {"v": 2}, {"v": 159.0}, {"v": 8.0}, {"v": 8}, {"v": 708222.8661305557}, {"v": 56252.64325249546}, {"v": 45318.94431890442}, {"v": -31516.352076592088}, {"v": 6643.824980215071}, {"v": -6255.779985737854}, {"v": -5874.627822750455}, {"v": 5230.070882955488}, {"v": 960.2123371321513}, {"v": 925.7262012233465}]}, {"c": [{"v": 18}, {"v": "2016-01-12-99"}, {"v": "2016-01-12"}, {"v": 99}, {"v": 2}, {"v": 0}, {"v": 279.9}, {"v": 31.099999999999998}, {"v": 424}, {"v": 120}, {"v": 18}, {"v": 23}, {"v": 3}, {"v": 68.0}, {"v": 4.0}, {"v": 0}, {"v": -49107.539914295325}, {"v": -2692.8470826402217}, {"v": 9935.231718783902}, {"v": -3298.623881626631}, {"v": -5935.494576067303}, {"v": 4401.336391459551}, {"v": -6351.153722798013}, {"v": -1298.9092515318114}, {"v": 1189.791714078885}, {"v": -567.575422733107}]}, {"c": [{"v": 34}, {"v": "2016-01-13-74"}, {"v": "2016-01-13"}, {"v": 74}, {"v": 3}, {"v": 0}, {"v": 365.20000000000005}, {"v": 24.34666666666667}, {"v": 245}, {"v": 53}, {"v": 18}, {"v": 6}, {"v": 2}, {"v": 88.0}, {"v": 3.0}, {"v": 9}, {"v": -59244.57133508226}, {"v": -263.082847100255}, {"v": 239.66515450360902}, {"v": -3525.03461628383}, {"v": 1619.9544111072937}, {"v": -1711.3959984852017}, {"v": -1192.7026155528206}, {"v": -1900.8571724936967}, {"v": 123.52838504241097}, {"v": 1466.2002843746586}]}, {"c": [{"v": 43}, {"v": "2016-01-01-67"}, {"v": "2016-01-01"}, {"v": 67}, {"v": 5}, {"v": 0}, {"v": 445.0}, {"v": 89.0}, {"v": 209}, {"v": 27}, {"v": 10}, {"v": 2}, {"v": 2}, {"v": 205.0}, {"v": 6.0}, {"v": 4}, {"v": -65688.687929178}, {"v": -3762.9655791458395}, {"v": -3358.616171192248}, {"v": -8909.25794311007}, {"v": 2158.6864287823623}, {"v": -849.3451221330146}, {"v": -1091.3085568779072}, {"v": 940.5799515551687}, {"v": 581.2016903790037}, {"v": -727.8323581405847}]}, {"c": [{"v": 40}, {"v": "2016-01-03-144"}, {"v": "2016-01-03"}, {"v": 144}, {"v": 0}, {"v": 1}, {"v": 82.0}, {"v": 41.0}, {"v": 193}, {"v": 25}, {"v": 5}, {"v": 3}, {"v": 2}, {"v": 187.0}, {"v": 13.0}, {"v": 0}, {"v": -64931.49467540745}, {"v": -3401.9619504950874}, {"v": -4726.897273478495}, {"v": -7591.197201663188}, {"v": 1775.6541279919063}, {"v": -241.2248511901506}, {"v": -1948.922771986791}, {"v": 549.5085007553547}, {"v": 1107.8009935188818}, {"v": 953.1597396209328}]}, {"c": [{"v": 1}, {"v": "2016-01-17-9"}, {"v": "2016-01-17"}, {"v": 9}, {"v": 0}, {"v": 1}, {"v": 889.0}, {"v": 17.096153846153847}, {"v": 1118}, {"v": 191}, {"v": 56}, {"v": 49}, {"v": 4}, {"v": 112.0}, {"v": 7.0}, {"v": 4}, {"v": 48245.89005979162}, {"v": -341.80638034240724}, {"v": 8231.712629865922}, {"v": 29193.673193590483}, {"v": 4288.374781572557}, {"v": -28909.26136546567}, {"v": -4401.506794546594}, {"v": -5676.7844147532805}, {"v": -8417.263753188867}, {"v": -435.3247474599002}]}, {"c": [{"v": 9}, {"v": "2016-01-05-132"}, {"v": "2016-01-05"}, {"v": 132}, {"v": 2}, {"v": 0}, {"v": 536.3999999999999}, {"v": 18.496551724137927}, {"v": 554}, {"v": 101}, {"v": 35}, {"v": 38}, {"v": 4}, {"v": 48.0}, {"v": 8.0}, {"v": 1}, {"v": -47755.888529398544}, {"v": 7847.170880750486}, {"v": -130.03442563754814}, {"v": 3424.894692060525}, {"v": 8146.276411878912}, {"v": -7062.213652837777}, {"v": 3952.962970273269}, {"v": 604.9993960734463}, {"v": -2442.007538450393}, {"v": -1470.5099543868812}]}, {"c": [{"v": 20}, {"v": "2016-01-13-137"}, {"v": "2016-01-13"}, {"v": 137}, {"v": 3}, {"v": 0}, {"v": 760.5000000000001}, {"v": 9.626582278481013}, {"v": 967}, {"v": 109}, {"v": 34}, {"v": 45}, {"v": 2}, {"v": 106.0}, {"v": 3.0}, {"v": 4}, {"v": -29369.221533006694}, {"v": -4388.810432640775}, {"v": 16971.091111949005}, {"v": 774.8843292892159}, {"v": -9202.180065764165}, {"v": 7186.4352809034135}, {"v": -10669.800888175441}, {"v": -2019.5812647136083}, {"v": -764.150163424909}, {"v": -3518.7520365660193}]}, {"c": [{"v": 12}, {"v": "2016-01-03-6"}, {"v": "2016-01-03"}, {"v": 6}, {"v": 0}, {"v": 1}, {"v": 1192.0}, {"v": 19.540983606557376}, {"v": 1479}, {"v": 122}, {"v": 29}, {"v": 25}, {"v": 4}, {"v": 147.0}, {"v": 10.0}, {"v": 12}, {"v": 128675.36912207802}, {"v": 31288.84109163725}, {"v": -14001.177619992111}, {"v": 1242.6406271417618}, {"v": 39493.87489403659}, {"v": 23091.719403190295}, {"v": 7526.824808706235}, {"v": -12527.044275131584}, {"v": -2534.1675751230996}, {"v": 295.2087029388201}]}, {"c": [{"v": 29}, {"v": "2016-01-17-99"}, {"v": "2016-01-17"}, {"v": 99}, {"v": 0}, {"v": 1}, {"v": 747.1}, {"v": 29.884}, {"v": 724}, {"v": 191}, {"v": 61}, {"v": 53}, {"v": 4}, {"v": 48.0}, {"v": 6.0}, {"v": 0}, {"v": -47097.06636653798}, {"v": 3307.0560566067043}, {"v": 7418.353023578275}, {"v": 3174.1305994501704}, {"v": -3171.53771641945}, {"v": 1888.5667622108429}, {"v": -3952.838620917695}, {"v": -3341.653834759758}, {"v": 3770.59023866098}, {"v": 1319.4877578087917}]}, {"c": [{"v": 45}, {"v": "2016-01-06-17"}, {"v": "2016-01-06"}, {"v": 17}, {"v": 3}, {"v": 0}, {"v": 5.0}, {"v": 5.0}, {"v": 21}, {"v": 6}, {"v": 1}, {"v": 0}, {"v": 3}, {"v": 55.0}, {"v": 8.0}, {"v": 1}, {"v": -66735.12644689214}, {"v": -3337.615706720996}, {"v": -5161.294210154281}, {"v": -10325.810608069978}, {"v": 2348.6801289249465}, {"v": -2748.1056363380744}, {"v": -1872.7739757954253}, {"v": 2975.825116126914}, {"v": 586.350266489691}, {"v": 1090.328754730865}]}, {"c": [{"v": 9}, {"v": "2016-01-13-107"}, {"v": "2016-01-13"}, {"v": 107}, {"v": 3}, {"v": 0}, {"v": 1109.6000000000001}, {"v": 22.644897959183677}, {"v": 635}, {"v": 164}, {"v": 63}, {"v": 39}, {"v": 2}, {"v": 93.0}, {"v": 4.0}, {"v": 3}, {"v": -47755.888529398544}, {"v": 7847.170880750486}, {"v": -130.03442563754814}, {"v": 3424.894692060525}, {"v": 8146.276411878912}, {"v": -7062.213652837777}, {"v": 3952.962970273269}, {"v": 604.9993960734463}, {"v": -2442.007538450393}, {"v": -1470.5099543868812}]}, {"c": [{"v": 11}, {"v": "2016-01-04-59"}, {"v": "2016-01-04"}, {"v": 59}, {"v": 1}, {"v": 0}, {"v": 443.20000000000005}, {"v": 17.04615384615385}, {"v": 748}, {"v": 141}, {"v": 47}, {"v": 25}, {"v": 8}, {"v": 202.0}, {"v": 12.0}, {"v": 0}, {"v": -33769.189869272246}, {"v": -1151.3482885368967}, {"v": 18533.225073816397}, {"v": 6789.145017891535}, {"v": -23522.03515773121}, {"v": 7287.9830410494815}, {"v": -1428.2865100300417}, {"v": -1332.1135902923972}, {"v": 3062.105263397846}, {"v": 822.5335611019855}]}, {"c": [{"v": 31}, {"v": "2016-01-11-48"}, {"v": "2016-01-11"}, {"v": 48}, {"v": 1}, {"v": 0}, {"v": 672.0}, {"v": 17.68421052631579}, {"v": 599}, {"v": 119}, {"v": 20}, {"v": 27}, {"v": 4}, {"v": 42.0}, {"v": 7.0}, {"v": 8}, {"v": -55528.66884130713}, {"v": -3665.7877311167153}, {"v": 121.6808390985545}, {"v": -5696.160211060884}, {"v": -1436.1586356324203}, {"v": 1383.4872069013009}, {"v": -4241.30111214407}, {"v": 707.7608789795905}, {"v": 2489.720043658358}, {"v": -1447.5159216762775}]}, {"c": [{"v": 1}, {"v": "2016-01-09-75"}, {"v": "2016-01-09"}, {"v": 75}, {"v": 6}, {"v": 0}, {"v": 2422.8999999999996}, {"v": 13.460555555555553}, {"v": 1471}, {"v": 385}, {"v": 141}, {"v": 111}, {"v": 2}, {"v": 159.0}, {"v": 8.0}, {"v": 5}, {"v": 48245.89005979162}, {"v": -341.80638034240724}, {"v": 8231.712629865922}, {"v": 29193.673193590483}, {"v": 4288.374781572557}, {"v": -28909.26136546567}, {"v": -4401.506794546594}, {"v": -5676.7844147532805}, {"v": -8417.263753188867}, {"v": -435.3247474599002}]}], "cols": [{"type": "number", "id": "district_id", "label": "district_id"}, {"type": "string", "id": "timeslot", "label": "timeslot"}, {"type": "string", "id": "date", "label": "date"}, {"type": "number", "id": "timeofday_slot", "label": "timeofday_slot"}, {"type": "number", "id": "day_in_week", "label": "day_in_week"}, {"type": "number", "id": "is_sunday", "label": "is_sunday"}, {"type": "number", "id": "sum_price", "label": "sum_price"}, {"type": "number", "id": "avg_price", "label": "avg_price"}, {"type": "number", "id": "traffic_tj_level1", "label": "traffic_tj_level1"}, {"type": "number", "id": "traffic_tj_level2", "label": "traffic_tj_level2"}, {"type": "number", "id": "traffic_tj_level3", "label": "traffic_tj_level3"}, {"type": "number", "id": "traffic_tj_level4", "label": "traffic_tj_level4"}, {"type": "number", "id": "weather", "label": "weather"}, {"type": "number", "id": "weather_pm25", "label": "weather_pm25"}, {"type": "number", "id": "weather_temperature", "label": "weather_temperature"}, {"type": "number", "id": "gap", "label": "gap"}, {"type": "number", "id": "poi1", "label": "poi1"}, {"type": "number", "id": "poi2", "label": "poi2"}, {"type": "number", "id": "poi3", "label": "poi3"}, {"type": "number", "id": "poi4", "label": "poi4"}, {"type": "number", "id": "poi5", "label": "poi5"}, {"type": "number", "id": "poi6", "label": "poi6"}, {"type": "number", "id": "poi7", "label": "poi7"}, {"type": "number", "id": "poi8", "label": "poi8"}, {"type": "number", "id": "poi9", "label": "poi9"}, {"type": "number", "id": "poi10", "label": "poi10"}]});
        }
      );
    </script>
  </div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 54px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Previous Gap</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Add <span class="cm-comment">`previous_gap`</span> field to data.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 54px;"></div><div class="CodeMirror-gutters" style="display: none; height: 67px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Previous-Gap">Previous Gap<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#Previous-Gap">¶</a></h1>
<p>Add <code>previous_gap</code> field to data.</p>
</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 552px; margin-bottom: -17px; border-right-width: 13px; min-height: 117px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%sql --module q</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> *</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> [<span class="cm-atom">datalab-projects-1331:xjk_algo_comp.future_gaps_final1</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">ORDER</span> <span class="cm-keyword">BY</span> <span class="cm-variable">timeslot</span>, <span class="cm-variable">district_id</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 117px;"></div><div class="CodeMirror-gutters" style="height: 130px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 732px; margin-bottom: -17px; border-right-width: 13px; min-height: 201px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">query</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Query</span>(<span class="cm-variable">q</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tableresult</span> = <span class="cm-variable">query</span>.<span class="cm-variable">results</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">previous_gaps</span> = {}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'there are {} rows'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">tableresult</span>.<span class="cm-variable">length</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">rcounter</span>, <span class="cm-variable">row</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">tableresult</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">previous_gaps</span>[<span class="cm-string">'{}:{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">row</span>[<span class="cm-string">'timeslot'</span>], <span class="cm-variable">row</span>[<span class="cm-string">'district_id'</span>])] = <span class="cm-variable">row</span>[<span class="cm-string">'gap'</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span> <span class="cm-variable">rcounter</span> <span class="cm-operator">%</span> <span class="cm-number">5000</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">'processed {} rows'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">rcounter</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 201px;"></div><div class="CodeMirror-gutters" style="height: 214px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>there are 163491 rows
processed 0 rows
processed 5000 rows
processed 10000 rows
processed 15000 rows
processed 20000 rows
processed 25000 rows
processed 30000 rows
processed 35000 rows
processed 40000 rows
processed 45000 rows
processed 50000 rows
processed 55000 rows
processed 60000 rows
processed 65000 rows
processed 70000 rows
processed 75000 rows
processed 80000 rows
processed 85000 rows
processed 90000 rows
processed 95000 rows
processed 100000 rows
processed 105000 rows
processed 110000 rows
processed 115000 rows
processed 120000 rows
processed 125000 rows
processed 130000 rows
processed 135000 rows
processed 140000 rows
processed 145000 rows
processed 150000 rows
processed 155000 rows
processed 160000 rows
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 759px; margin-bottom: -17px; border-right-width: 13px; min-height: 432px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>20</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">all_data</span> = []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'there are {} rows'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">tableresult</span>.<span class="cm-variable">length</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">rcounter</span>, <span class="cm-variable">row</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">tableresult</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">timeslot_r</span> = <span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">int</span>(<span class="cm-variable">x</span>), <span class="cm-variable">row</span>[<span class="cm-string">'timeslot'</span>].<span class="cm-variable">split</span>(<span class="cm-string">'-'</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">prev_n_range</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">prev_n</span> = <span class="cm-variable">i</span><span class="cm-operator">+</span><span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">slot</span> = <span class="cm-variable">timeslot_r</span>[<span class="cm-number">3</span>] <span class="cm-operator">-</span> <span class="cm-variable">prev_n</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">date_obj</span> = <span class="cm-variable">date</span>(<span class="cm-variable">timeslot_r</span>[<span class="cm-number">0</span>], <span class="cm-variable">timeslot_r</span>[<span class="cm-number">1</span>], <span class="cm-variable">timeslot_r</span>[<span class="cm-number">2</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">slot</span> <span class="cm-operator">&lt;=</span> <span class="cm-number">0</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">slot</span> = <span class="cm-number">144</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">date_obj</span> = <span class="cm-variable">date_obj</span> <span class="cm-operator">-</span> <span class="cm-variable">timedelta</span>(<span class="cm-variable">days</span>=<span class="cm-number">1</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">prev_timestamp</span> = <span class="cm-string">'{}-{}-{}-{}'</span>.<span class="cm-builtin">format</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">date_obj</span>.<span class="cm-variable">year</span>, <span class="cm-builtin">str</span>(<span class="cm-variable">date_obj</span>.<span class="cm-variable">month</span>).<span class="cm-variable">zfill</span>(<span class="cm-number">2</span>), <span class="cm-builtin">str</span>(<span class="cm-variable">date_obj</span>.<span class="cm-variable">day</span>).<span class="cm-variable">zfill</span>(<span class="cm-number">2</span>), <span class="cm-variable">slot</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">prev_index</span> = <span class="cm-string">'{}:{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">prev_timestamp</span>, <span class="cm-variable">row</span>[<span class="cm-string">'district_id'</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">row</span>[<span class="cm-string">'previous_gap{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">prev_n</span>)] = <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">prev_index</span> <span class="cm-keyword">in</span> <span class="cm-variable">previous_gaps</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">row</span>[<span class="cm-string">'previous_gap{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">prev_n</span>)] = <span class="cm-variable">previous_gaps</span>[<span class="cm-variable">prev_index</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">all_data</span>.<span class="cm-variable">append</span>(<span class="cm-variable">row</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span> <span class="cm-variable">rcounter</span> <span class="cm-operator">%</span> <span class="cm-number">5000</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">'processed {} rows'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">rcounter</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 432px;"></div><div class="CodeMirror-gutters" style="height: 445px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>there are 163491 rows
processed 0 rows
processed 5000 rows
processed 10000 rows
processed 15000 rows
processed 20000 rows
processed 25000 rows
processed 30000 rows
processed 35000 rows
processed 40000 rows
processed 45000 rows
processed 50000 rows
processed 55000 rows
processed 60000 rows
processed 65000 rows
processed 70000 rows
processed 75000 rows
processed 80000 rows
processed 85000 rows
processed 90000 rows
processed 95000 rows
processed 100000 rows
processed 105000 rows
processed 110000 rows
processed 115000 rows
processed 120000 rows
processed 125000 rows
processed 130000 rows
processed 135000 rows
processed 140000 rows
processed 145000 rows
processed 150000 rows
processed 155000 rows
processed 160000 rows
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 669px; margin-bottom: -17px; border-right-width: 13px; min-height: 495px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>23</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>([</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'district_id'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'timeslot'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'date'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'timeofday_slot'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'day_in_week'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'is_sunday'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'sum_price'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'avg_price'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level1'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level2'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level3'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'traffic_tj_level4'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'weather'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'weather_pm25'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'weather_temperature'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    {<span class="cm-string">'name'</span>: <span class="cm-string">'gap'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">] <span class="cm-operator">+</span> <span class="cm-variable">poi_schema</span> <span class="cm-operator">+</span> <span class="cm-variable">prev_gap_schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp.future_gaps_final2'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">delete</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span>.<span class="cm-variable">insert_data</span>(<span class="cm-variable">all_data</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 495px;"></div><div class="CodeMirror-gutters" style="height: 508px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[12]:</div><div class="output_subarea output_html rendered_html output_result">
    <div class="bqtv" id="2_146581006143"><div class="google-visualization-table" style="position: relative; z-index: 0; max-width: 100%; max-height: 100%;"><div style="position: relative; overflow: auto; max-width: 100%; max-height: 100%;"><table class="google-visualization-table-table" cellspacing="0"><thead><tr class="gchart-table-headerrow"><th class="gchart-table-headercell unsorted">district_id<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">timeslot<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">date<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">timeofday_slot<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">day_in_week<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">is_sunday<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">sum_price<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">avg_price<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level1<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level2<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level3<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">traffic_tj_level4<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">weather<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">weather_pm25<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">weather_temperature<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">gap<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi1<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi2<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi3<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi4<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi5<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi6<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi7<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi8<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi9<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">poi10<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">previous_gap1<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">previous_gap2<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">previous_gap3<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">previous_gap4<span class="google-visualization-table-sortind"></span></th><th class="gchart-table-headercell unsorted">previous_gap5<span class="google-visualization-table-sortind"></span></th></tr></thead><tbody><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell">2016-01-04-10</td><td class="gchart-table-cell">2016-01-04</td><td class="gchart-table-cell google-visualization-table-td-number">10</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">127</td><td class="gchart-table-cell google-visualization-table-td-number">25.4</td><td class="gchart-table-cell google-visualization-table-td-number">643</td><td class="gchart-table-cell google-visualization-table-td-number">58</td><td class="gchart-table-cell google-visualization-table-td-number">33</td><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">192</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-30,607.742</td><td class="gchart-table-cell google-visualization-table-td-number">3,946.777</td><td class="gchart-table-cell google-visualization-table-td-number">16,612.404</td><td class="gchart-table-cell google-visualization-table-td-number">-390.103</td><td class="gchart-table-cell google-visualization-table-td-number">-10,345.942</td><td class="gchart-table-cell google-visualization-table-td-number">2,559.251</td><td class="gchart-table-cell google-visualization-table-td-number">-5,740.01</td><td class="gchart-table-cell google-visualization-table-td-number">-4,110.476</td><td class="gchart-table-cell google-visualization-table-td-number">-286.1</td><td class="gchart-table-cell google-visualization-table-td-number">-925.376</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">24</td><td class="gchart-table-cell">2016-01-04-116</td><td class="gchart-table-cell">2016-01-04</td><td class="gchart-table-cell google-visualization-table-td-number">116</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1,260.4</td><td class="gchart-table-cell google-visualization-table-td-number">16.159</td><td class="gchart-table-cell google-visualization-table-td-number">1,052</td><td class="gchart-table-cell google-visualization-table-td-number">400</td><td class="gchart-table-cell google-visualization-table-td-number">105</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">226</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">19,523.241</td><td class="gchart-table-cell google-visualization-table-td-number">4,962.968</td><td class="gchart-table-cell google-visualization-table-td-number">-1,374.25</td><td class="gchart-table-cell google-visualization-table-td-number">16,082.708</td><td class="gchart-table-cell google-visualization-table-td-number">3,468.897</td><td class="gchart-table-cell google-visualization-table-td-number">8,432.755</td><td class="gchart-table-cell google-visualization-table-td-number">1,453.927</td><td class="gchart-table-cell google-visualization-table-td-number">-3,655.439</td><td class="gchart-table-cell google-visualization-table-td-number">1,804.03</td><td class="gchart-table-cell google-visualization-table-td-number">2,994.381</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">6</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell">2016-01-05-36</td><td class="gchart-table-cell">2016-01-05</td><td class="gchart-table-cell google-visualization-table-td-number">36</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">75</td><td class="gchart-table-cell google-visualization-table-td-number">37.5</td><td class="gchart-table-cell google-visualization-table-td-number">500</td><td class="gchart-table-cell google-visualization-table-td-number">34</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">127</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-30,607.742</td><td class="gchart-table-cell google-visualization-table-td-number">3,946.777</td><td class="gchart-table-cell google-visualization-table-td-number">16,612.404</td><td class="gchart-table-cell google-visualization-table-td-number">-390.103</td><td class="gchart-table-cell google-visualization-table-td-number">-10,345.942</td><td class="gchart-table-cell google-visualization-table-td-number">2,559.251</td><td class="gchart-table-cell google-visualization-table-td-number">-5,740.01</td><td class="gchart-table-cell google-visualization-table-td-number">-4,110.476</td><td class="gchart-table-cell google-visualization-table-td-number">-286.1</td><td class="gchart-table-cell google-visualization-table-td-number">-925.376</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">63</td><td class="gchart-table-cell">2016-01-11-130</td><td class="gchart-table-cell">2016-01-11</td><td class="gchart-table-cell google-visualization-table-td-number">130</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">70</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">82</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-59,504.792</td><td class="gchart-table-cell google-visualization-table-td-number">3,880</td><td class="gchart-table-cell google-visualization-table-td-number">-1,536.405</td><td class="gchart-table-cell google-visualization-table-td-number">-3,749.029</td><td class="gchart-table-cell google-visualization-table-td-number">-2,045.789</td><td class="gchart-table-cell google-visualization-table-td-number">7,374.2</td><td class="gchart-table-cell google-visualization-table-td-number">3,202.509</td><td class="gchart-table-cell google-visualization-table-td-number">7,557.127</td><td class="gchart-table-cell google-visualization-table-td-number">-2,784.457</td><td class="gchart-table-cell google-visualization-table-td-number">1,940.571</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">36</td><td class="gchart-table-cell">2016-01-14-89</td><td class="gchart-table-cell">2016-01-14</td><td class="gchart-table-cell google-visualization-table-td-number">89</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">262.6</td><td class="gchart-table-cell google-visualization-table-td-number">15.447</td><td class="gchart-table-cell google-visualization-table-td-number">264</td><td class="gchart-table-cell google-visualization-table-td-number">29</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">121</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">-64,632.862</td><td class="gchart-table-cell google-visualization-table-td-number">-2,037.096</td><td class="gchart-table-cell google-visualization-table-td-number">-5,723.93</td><td class="gchart-table-cell google-visualization-table-td-number">-5,377.368</td><td class="gchart-table-cell google-visualization-table-td-number">3,747.841</td><td class="gchart-table-cell google-visualization-table-td-number">-5,267.392</td><td class="gchart-table-cell google-visualization-table-td-number">-1,423.361</td><td class="gchart-table-cell google-visualization-table-td-number">2,624.754</td><td class="gchart-table-cell google-visualization-table-td-number">694.525</td><td class="gchart-table-cell google-visualization-table-td-number">1,524.145</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">57</td><td class="gchart-table-cell">2016-01-10-67</td><td class="gchart-table-cell">2016-01-10</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">313</td><td class="gchart-table-cell google-visualization-table-td-number">10.793</td><td class="gchart-table-cell google-visualization-table-td-number">523</td><td class="gchart-table-cell google-visualization-table-td-number">95</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">173</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">-47,773.223</td><td class="gchart-table-cell google-visualization-table-td-number">257.739</td><td class="gchart-table-cell google-visualization-table-td-number">2,191.724</td><td class="gchart-table-cell google-visualization-table-td-number">752.021</td><td class="gchart-table-cell google-visualization-table-td-number">454.553</td><td class="gchart-table-cell google-visualization-table-td-number">-3,717.499</td><td class="gchart-table-cell google-visualization-table-td-number">1,848.419</td><td class="gchart-table-cell google-visualization-table-td-number">-400.272</td><td class="gchart-table-cell google-visualization-table-td-number">684.008</td><td class="gchart-table-cell google-visualization-table-td-number">-745.14</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">54</td><td class="gchart-table-cell">2016-01-02-15</td><td class="gchart-table-cell">2016-01-02</td><td class="gchart-table-cell google-visualization-table-td-number">15</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">202</td><td class="gchart-table-cell google-visualization-table-td-number">33.667</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">163</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-48,692.791</td><td class="gchart-table-cell google-visualization-table-td-number">5,023.943</td><td class="gchart-table-cell google-visualization-table-td-number">4,011.233</td><td class="gchart-table-cell google-visualization-table-td-number">-1,168.116</td><td class="gchart-table-cell google-visualization-table-td-number">-7,489.874</td><td class="gchart-table-cell google-visualization-table-td-number">1,615.017</td><td class="gchart-table-cell google-visualization-table-td-number">501.629</td><td class="gchart-table-cell google-visualization-table-td-number">-527.164</td><td class="gchart-table-cell google-visualization-table-td-number">1,293.423</td><td class="gchart-table-cell google-visualization-table-td-number">1,256.378</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">57</td><td class="gchart-table-cell">2016-01-10-39</td><td class="gchart-table-cell">2016-01-10</td><td class="gchart-table-cell google-visualization-table-td-number">39</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">15</td><td class="gchart-table-cell google-visualization-table-td-number">7.5</td><td class="gchart-table-cell google-visualization-table-td-number">286</td><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">159</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-47,773.223</td><td class="gchart-table-cell google-visualization-table-td-number">257.739</td><td class="gchart-table-cell google-visualization-table-td-number">2,191.724</td><td class="gchart-table-cell google-visualization-table-td-number">752.021</td><td class="gchart-table-cell google-visualization-table-td-number">454.553</td><td class="gchart-table-cell google-visualization-table-td-number">-3,717.499</td><td class="gchart-table-cell google-visualization-table-td-number">1,848.419</td><td class="gchart-table-cell google-visualization-table-td-number">-400.272</td><td class="gchart-table-cell google-visualization-table-td-number">684.008</td><td class="gchart-table-cell google-visualization-table-td-number">-745.14</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">46</td><td class="gchart-table-cell">2016-01-17-38</td><td class="gchart-table-cell">2016-01-17</td><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">448</td><td class="gchart-table-cell google-visualization-table-td-number">29.867</td><td class="gchart-table-cell google-visualization-table-td-number">823</td><td class="gchart-table-cell google-visualization-table-td-number">82</td><td class="gchart-table-cell google-visualization-table-td-number">32</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">102</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">18,767.162</td><td class="gchart-table-cell google-visualization-table-td-number">2,451.159</td><td class="gchart-table-cell google-visualization-table-td-number">16,298.072</td><td class="gchart-table-cell google-visualization-table-td-number">22,162.127</td><td class="gchart-table-cell google-visualization-table-td-number">1,191.453</td><td class="gchart-table-cell google-visualization-table-td-number">-3,225.917</td><td class="gchart-table-cell google-visualization-table-td-number">-5,561.897</td><td class="gchart-table-cell google-visualization-table-td-number">-7,660.232</td><td class="gchart-table-cell google-visualization-table-td-number">-3,264.586</td><td class="gchart-table-cell google-visualization-table-td-number">1,146.246</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">58</td><td class="gchart-table-cell">2016-01-09-140</td><td class="gchart-table-cell">2016-01-09</td><td class="gchart-table-cell google-visualization-table-td-number">140</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">33</td><td class="gchart-table-cell google-visualization-table-td-number">16.5</td><td class="gchart-table-cell google-visualization-table-td-number">224</td><td class="gchart-table-cell google-visualization-table-td-number">15</td><td class="gchart-table-cell google-visualization-table-td-number">15</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">183</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-64,227.768</td><td class="gchart-table-cell google-visualization-table-td-number">-2,781.683</td><td class="gchart-table-cell google-visualization-table-td-number">-2,423.979</td><td class="gchart-table-cell google-visualization-table-td-number">-6,508.848</td><td class="gchart-table-cell google-visualization-table-td-number">-359.595</td><td class="gchart-table-cell google-visualization-table-td-number">870.759</td><td class="gchart-table-cell google-visualization-table-td-number">-1,502.462</td><td class="gchart-table-cell google-visualization-table-td-number">55.358</td><td class="gchart-table-cell google-visualization-table-td-number">1,128.781</td><td class="gchart-table-cell google-visualization-table-td-number">1,463.88</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">53</td><td class="gchart-table-cell">2016-01-21-43</td><td class="gchart-table-cell">2016-01-21</td><td class="gchart-table-cell google-visualization-table-td-number">43</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">337</td><td class="gchart-table-cell google-visualization-table-td-number">37.444</td><td class="gchart-table-cell google-visualization-table-td-number">240</td><td class="gchart-table-cell google-visualization-table-td-number">17</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">49</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-63,660.541</td><td class="gchart-table-cell google-visualization-table-td-number">-4,384.508</td><td class="gchart-table-cell google-visualization-table-td-number">-4,188.364</td><td class="gchart-table-cell google-visualization-table-td-number">-8,202.021</td><td class="gchart-table-cell google-visualization-table-td-number">1,580.761</td><td class="gchart-table-cell google-visualization-table-td-number">-251.228</td><td class="gchart-table-cell google-visualization-table-td-number">-2,523.218</td><td class="gchart-table-cell google-visualization-table-td-number">477.515</td><td class="gchart-table-cell google-visualization-table-td-number">930.248</td><td class="gchart-table-cell google-visualization-table-td-number">54.766</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">41</td><td class="gchart-table-cell">2016-01-18-54</td><td class="gchart-table-cell">2016-01-18</td><td class="gchart-table-cell google-visualization-table-td-number">54</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">309.7</td><td class="gchart-table-cell google-visualization-table-td-number">18.218</td><td class="gchart-table-cell google-visualization-table-td-number">254</td><td class="gchart-table-cell google-visualization-table-td-number">45</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">&nbsp;</td><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell google-visualization-table-td-number">-63,794.168</td><td class="gchart-table-cell google-visualization-table-td-number">-2,381.664</td><td class="gchart-table-cell google-visualization-table-td-number">-3,549.849</td><td class="gchart-table-cell google-visualization-table-td-number">-7,280.209</td><td class="gchart-table-cell google-visualization-table-td-number">1,028.167</td><td class="gchart-table-cell google-visualization-table-td-number">486.378</td><td class="gchart-table-cell google-visualization-table-td-number">-634.336</td><td class="gchart-table-cell google-visualization-table-td-number">799.451</td><td class="gchart-table-cell google-visualization-table-td-number">409.697</td><td class="gchart-table-cell google-visualization-table-td-number">-477.198</td><td class="gchart-table-cell google-visualization-table-td-number">10</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">35</td><td class="gchart-table-cell">2016-01-05-109</td><td class="gchart-table-cell">2016-01-05</td><td class="gchart-table-cell google-visualization-table-td-number">109</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">350.7</td><td class="gchart-table-cell google-visualization-table-td-number">19.483</td><td class="gchart-table-cell google-visualization-table-td-number">329</td><td class="gchart-table-cell google-visualization-table-td-number">44</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">42</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-62,108.405</td><td class="gchart-table-cell google-visualization-table-td-number">-1,597.454</td><td class="gchart-table-cell google-visualization-table-td-number">-2,281.342</td><td class="gchart-table-cell google-visualization-table-td-number">-5,367.72</td><td class="gchart-table-cell google-visualization-table-td-number">131.704</td><td class="gchart-table-cell google-visualization-table-td-number">6.323</td><td class="gchart-table-cell google-visualization-table-td-number">-1,158.91</td><td class="gchart-table-cell google-visualization-table-td-number">1,808.463</td><td class="gchart-table-cell google-visualization-table-td-number">9.694</td><td class="gchart-table-cell google-visualization-table-td-number">933.534</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-08-83</td><td class="gchart-table-cell">2016-01-08</td><td class="gchart-table-cell google-visualization-table-td-number">83</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2,465.4</td><td class="gchart-table-cell google-visualization-table-td-number">17.865</td><td class="gchart-table-cell google-visualization-table-td-number">1,961</td><td class="gchart-table-cell google-visualization-table-td-number">557</td><td class="gchart-table-cell google-visualization-table-td-number">204</td><td class="gchart-table-cell google-visualization-table-td-number">96</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">104</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">194,502.177</td><td class="gchart-table-cell google-visualization-table-td-number">-118,529.111</td><td class="gchart-table-cell google-visualization-table-td-number">41,855.603</td><td class="gchart-table-cell google-visualization-table-td-number">-25,162.951</td><td class="gchart-table-cell google-visualization-table-td-number">-6,096.775</td><td class="gchart-table-cell google-visualization-table-td-number">-186.003</td><td class="gchart-table-cell google-visualization-table-td-number">11,923.002</td><td class="gchart-table-cell google-visualization-table-td-number">-4,404.595</td><td class="gchart-table-cell google-visualization-table-td-number">-6,875.543</td><td class="gchart-table-cell google-visualization-table-td-number">-377.032</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">4</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell">2016-01-12-92</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">92</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">130.5</td><td class="gchart-table-cell google-visualization-table-td-number">18.643</td><td class="gchart-table-cell google-visualization-table-td-number">377</td><td class="gchart-table-cell google-visualization-table-td-number">82</td><td class="gchart-table-cell google-visualization-table-td-number">24</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-55,675.972</td><td class="gchart-table-cell google-visualization-table-td-number">197.557</td><td class="gchart-table-cell google-visualization-table-td-number">1,409.86</td><td class="gchart-table-cell google-visualization-table-td-number">-5,526.462</td><td class="gchart-table-cell google-visualization-table-td-number">-1,318.212</td><td class="gchart-table-cell google-visualization-table-td-number">441.985</td><td class="gchart-table-cell google-visualization-table-td-number">-1,170.481</td><td class="gchart-table-cell google-visualization-table-td-number">972.374</td><td class="gchart-table-cell google-visualization-table-td-number">1,210.753</td><td class="gchart-table-cell google-visualization-table-td-number">964.329</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">3</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">57</td><td class="gchart-table-cell">2016-01-13-83</td><td class="gchart-table-cell">2016-01-13</td><td class="gchart-table-cell google-visualization-table-td-number">83</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">106</td><td class="gchart-table-cell google-visualization-table-td-number">6.625</td><td class="gchart-table-cell google-visualization-table-td-number">522</td><td class="gchart-table-cell google-visualization-table-td-number">90</td><td class="gchart-table-cell google-visualization-table-td-number">27</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">90</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-47,773.223</td><td class="gchart-table-cell google-visualization-table-td-number">257.739</td><td class="gchart-table-cell google-visualization-table-td-number">2,191.724</td><td class="gchart-table-cell google-visualization-table-td-number">752.021</td><td class="gchart-table-cell google-visualization-table-td-number">454.553</td><td class="gchart-table-cell google-visualization-table-td-number">-3,717.499</td><td class="gchart-table-cell google-visualization-table-td-number">1,848.419</td><td class="gchart-table-cell google-visualization-table-td-number">-400.272</td><td class="gchart-table-cell google-visualization-table-td-number">684.008</td><td class="gchart-table-cell google-visualization-table-td-number">-745.14</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell">2016-01-01-83</td><td class="gchart-table-cell">2016-01-01</td><td class="gchart-table-cell google-visualization-table-td-number">83</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">329</td><td class="gchart-table-cell google-visualization-table-td-number">19.353</td><td class="gchart-table-cell google-visualization-table-td-number">412</td><td class="gchart-table-cell google-visualization-table-td-number">102</td><td class="gchart-table-cell google-visualization-table-td-number">23</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">214</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">-55,675.972</td><td class="gchart-table-cell google-visualization-table-td-number">197.557</td><td class="gchart-table-cell google-visualization-table-td-number">1,409.86</td><td class="gchart-table-cell google-visualization-table-td-number">-5,526.462</td><td class="gchart-table-cell google-visualization-table-td-number">-1,318.212</td><td class="gchart-table-cell google-visualization-table-td-number">441.985</td><td class="gchart-table-cell google-visualization-table-td-number">-1,170.481</td><td class="gchart-table-cell google-visualization-table-td-number">972.374</td><td class="gchart-table-cell google-visualization-table-td-number">1,210.753</td><td class="gchart-table-cell google-visualization-table-td-number">964.329</td><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell google-visualization-table-td-number">17</td><td class="gchart-table-cell google-visualization-table-td-number">24</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">14</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">44</td><td class="gchart-table-cell">2016-01-02-43</td><td class="gchart-table-cell">2016-01-02</td><td class="gchart-table-cell google-visualization-table-td-number">43</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">50</td><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell google-visualization-table-td-number">49</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">170</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">-65,241.696</td><td class="gchart-table-cell google-visualization-table-td-number">-3,025.628</td><td class="gchart-table-cell google-visualization-table-td-number">-3,997.351</td><td class="gchart-table-cell google-visualization-table-td-number">-9,049.148</td><td class="gchart-table-cell google-visualization-table-td-number">1,384.837</td><td class="gchart-table-cell google-visualization-table-td-number">328.916</td><td class="gchart-table-cell google-visualization-table-td-number">-2,172.949</td><td class="gchart-table-cell google-visualization-table-td-number">1,063.266</td><td class="gchart-table-cell google-visualization-table-td-number">891.806</td><td class="gchart-table-cell google-visualization-table-td-number">-139.342</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">51</td><td class="gchart-table-cell">2016-01-05-97</td><td class="gchart-table-cell">2016-01-05</td><td class="gchart-table-cell google-visualization-table-td-number">97</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">10,600.1</td><td class="gchart-table-cell google-visualization-table-td-number">19.168</td><td class="gchart-table-cell google-visualization-table-td-number">3,135</td><td class="gchart-table-cell google-visualization-table-td-number">1,869</td><td class="gchart-table-cell google-visualization-table-td-number">626</td><td class="gchart-table-cell google-visualization-table-td-number">311</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">39</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">16</td><td class="gchart-table-cell google-visualization-table-td-number">708,222.866</td><td class="gchart-table-cell google-visualization-table-td-number">56,252.643</td><td class="gchart-table-cell google-visualization-table-td-number">45,318.944</td><td class="gchart-table-cell google-visualization-table-td-number">-31,516.352</td><td class="gchart-table-cell google-visualization-table-td-number">6,643.825</td><td class="gchart-table-cell google-visualization-table-td-number">-6,255.78</td><td class="gchart-table-cell google-visualization-table-td-number">-5,874.628</td><td class="gchart-table-cell google-visualization-table-td-number">5,230.071</td><td class="gchart-table-cell google-visualization-table-td-number">960.212</td><td class="gchart-table-cell google-visualization-table-td-number">925.726</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">22</td><td class="gchart-table-cell google-visualization-table-td-number">178</td><td class="gchart-table-cell google-visualization-table-td-number">50</td><td class="gchart-table-cell google-visualization-table-td-number">8</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell">2016-01-12-121</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">121</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1,613.6</td><td class="gchart-table-cell google-visualization-table-td-number">18.763</td><td class="gchart-table-cell google-visualization-table-td-number">1,417</td><td class="gchart-table-cell google-visualization-table-td-number">285</td><td class="gchart-table-cell google-visualization-table-td-number">94</td><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">86</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">17,734.339</td><td class="gchart-table-cell google-visualization-table-td-number">-13,841.966</td><td class="gchart-table-cell google-visualization-table-td-number">-28,341.671</td><td class="gchart-table-cell google-visualization-table-td-number">5,611.533</td><td class="gchart-table-cell google-visualization-table-td-number">11,650.871</td><td class="gchart-table-cell google-visualization-table-td-number">2,326.984</td><td class="gchart-table-cell google-visualization-table-td-number">206.363</td><td class="gchart-table-cell google-visualization-table-td-number">4,512.207</td><td class="gchart-table-cell google-visualization-table-td-number">2,241.49</td><td class="gchart-table-cell google-visualization-table-td-number">-8,619.428</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell">2016-01-15-18</td><td class="gchart-table-cell">2016-01-15</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">37</td><td class="gchart-table-cell google-visualization-table-td-number">12.333</td><td class="gchart-table-cell google-visualization-table-td-number">409</td><td class="gchart-table-cell google-visualization-table-td-number">41</td><td class="gchart-table-cell google-visualization-table-td-number">14</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">188</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">-31,927.357</td><td class="gchart-table-cell google-visualization-table-td-number">17,027.531</td><td class="gchart-table-cell google-visualization-table-td-number">8,299.896</td><td class="gchart-table-cell google-visualization-table-td-number">3,632.541</td><td class="gchart-table-cell google-visualization-table-td-number">-1,024.618</td><td class="gchart-table-cell google-visualization-table-td-number">4,767.027</td><td class="gchart-table-cell google-visualization-table-td-number">6,389.64</td><td class="gchart-table-cell google-visualization-table-td-number">6,162.752</td><td class="gchart-table-cell google-visualization-table-td-number">-2,138.416</td><td class="gchart-table-cell google-visualization-table-td-number">166.993</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">57</td><td class="gchart-table-cell">2016-01-04-123</td><td class="gchart-table-cell">2016-01-04</td><td class="gchart-table-cell google-visualization-table-td-number">123</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">52</td><td class="gchart-table-cell google-visualization-table-td-number">6.5</td><td class="gchart-table-cell google-visualization-table-td-number">477</td><td class="gchart-table-cell google-visualization-table-td-number">72</td><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">211</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">-47,773.223</td><td class="gchart-table-cell google-visualization-table-td-number">257.739</td><td class="gchart-table-cell google-visualization-table-td-number">2,191.724</td><td class="gchart-table-cell google-visualization-table-td-number">752.021</td><td class="gchart-table-cell google-visualization-table-td-number">454.553</td><td class="gchart-table-cell google-visualization-table-td-number">-3,717.499</td><td class="gchart-table-cell google-visualization-table-td-number">1,848.419</td><td class="gchart-table-cell google-visualization-table-td-number">-400.272</td><td class="gchart-table-cell google-visualization-table-td-number">684.008</td><td class="gchart-table-cell google-visualization-table-td-number">-745.14</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">35</td><td class="gchart-table-cell">2016-01-12-38</td><td class="gchart-table-cell">2016-01-12</td><td class="gchart-table-cell google-visualization-table-td-number">38</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell google-visualization-table-td-number">106</td><td class="gchart-table-cell google-visualization-table-td-number">17</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">48</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-62,108.405</td><td class="gchart-table-cell google-visualization-table-td-number">-1,597.454</td><td class="gchart-table-cell google-visualization-table-td-number">-2,281.342</td><td class="gchart-table-cell google-visualization-table-td-number">-5,367.72</td><td class="gchart-table-cell google-visualization-table-td-number">131.704</td><td class="gchart-table-cell google-visualization-table-td-number">6.323</td><td class="gchart-table-cell google-visualization-table-td-number">-1,158.91</td><td class="gchart-table-cell google-visualization-table-td-number">1,808.463</td><td class="gchart-table-cell google-visualization-table-td-number">9.694</td><td class="gchart-table-cell google-visualization-table-td-number">933.534</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">0</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell google-visualization-table-td-number">26</td><td class="gchart-table-cell">2016-01-01-101</td><td class="gchart-table-cell">2016-01-01</td><td class="gchart-table-cell google-visualization-table-td-number">101</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">501.5</td><td class="gchart-table-cell google-visualization-table-td-number">21.804</td><td class="gchart-table-cell google-visualization-table-td-number">359</td><td class="gchart-table-cell google-visualization-table-td-number">80</td><td class="gchart-table-cell google-visualization-table-td-number">25</td><td class="gchart-table-cell google-visualization-table-td-number">11</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">168</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-59,316.198</td><td class="gchart-table-cell google-visualization-table-td-number">-4,734.678</td><td class="gchart-table-cell google-visualization-table-td-number">-504.892</td><td class="gchart-table-cell google-visualization-table-td-number">-4,147.465</td><td class="gchart-table-cell google-visualization-table-td-number">-582.4</td><td class="gchart-table-cell google-visualization-table-td-number">89.548</td><td class="gchart-table-cell google-visualization-table-td-number">-2,526.642</td><td class="gchart-table-cell google-visualization-table-td-number">-520.848</td><td class="gchart-table-cell google-visualization-table-td-number">453.972</td><td class="gchart-table-cell google-visualization-table-td-number">404.144</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">1</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell google-visualization-table-td-number">46</td><td class="gchart-table-cell">2016-01-17-18</td><td class="gchart-table-cell">2016-01-17</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell google-visualization-table-td-number">0</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">395</td><td class="gchart-table-cell google-visualization-table-td-number">23.235</td><td class="gchart-table-cell google-visualization-table-td-number">898</td><td class="gchart-table-cell google-visualization-table-td-number">122</td><td class="gchart-table-cell google-visualization-table-td-number">42</td><td class="gchart-table-cell google-visualization-table-td-number">30</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">115</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">18,767.162</td><td class="gchart-table-cell google-visualization-table-td-number">2,451.159</td><td class="gchart-table-cell google-visualization-table-td-number">16,298.072</td><td class="gchart-table-cell google-visualization-table-td-number">22,162.127</td><td class="gchart-table-cell google-visualization-table-td-number">1,191.453</td><td class="gchart-table-cell google-visualization-table-td-number">-3,225.917</td><td class="gchart-table-cell google-visualization-table-td-number">-5,561.897</td><td class="gchart-table-cell google-visualization-table-td-number">-7,660.232</td><td class="gchart-table-cell google-visualization-table-td-number">-3,264.586</td><td class="gchart-table-cell google-visualization-table-td-number">1,146.246</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr></tbody></table></div></div></div>
    <br>(rows: 0, datalab-projects-1331:xjk_algo_comp.future_gaps_final2)<br>
    <script>
      require(['extensions/charting', 'element!2_146581006143', 'style!/static/extensions/charting.css'],
        function(charts, dom) {
          charts.render(dom,
            {
              chartStyle:"table",
              dataName:"1",
              fields:"district_id,timeslot,date,timeofday_slot,day_in_week,is_sunday,sum_price,avg_price,traffic_tj_level1,traffic_tj_level2,traffic_tj_level3,traffic_tj_level4,weather,weather_pm25,weather_temperature,gap,poi1,poi2,poi3,poi4,poi5,poi6,poi7,poi8,poi9,poi10,previous_gap1,previous_gap2,previous_gap3,previous_gap4,previous_gap5",
              totalRows:0,
              rowsPerPage:25,
            }, {}, {"rows": [{"c": [{"v": 19}, {"v": "2016-01-04-10"}, {"v": "2016-01-04"}, {"v": 10}, {"v": 1}, {"v": 0}, {"v": 127.0}, {"v": 25.4}, {"v": 643}, {"v": 58}, {"v": 33}, {"v": 25}, {"v": 2}, {"v": 192.0}, {"v": 13.0}, {"v": 1}, {"v": -30607.742242210294}, {"v": 3946.777334152007}, {"v": 16612.404199587338}, {"v": -390.1030565311408}, {"v": -10345.942106647737}, {"v": 2559.251207386308}, {"v": -5740.0101766107155}, {"v": -4110.4755423831975}, {"v": -286.10008461213437}, {"v": -925.376266963528}, {"v": 1}, {"v": 8}, {"v": 0}, {"v": 0}, {"v": 1}]}, {"c": [{"v": 24}, {"v": "2016-01-04-116"}, {"v": "2016-01-04"}, {"v": 116}, {"v": 1}, {"v": 0}, {"v": 1260.4}, {"v": 16.15897435897436}, {"v": 1052}, {"v": 400}, {"v": 105}, {"v": 67}, {"v": 8}, {"v": 226.0}, {"v": 12.0}, {"v": 1}, {"v": 19523.24100993228}, {"v": 4962.96782650953}, {"v": -1374.2495338499116}, {"v": 16082.708382071507}, {"v": 3468.8973927133134}, {"v": 8432.755094709415}, {"v": 1453.926541164961}, {"v": -3655.4386586649694}, {"v": 1804.0300018923638}, {"v": 2994.381279975609}, {"v": 3}, {"v": 1}, {"v": 4}, {"v": 2}, {"v": 6}]}, {"c": [{"v": 19}, {"v": "2016-01-05-36"}, {"v": "2016-01-05"}, {"v": 36}, {"v": 2}, {"v": 0}, {"v": 75.0}, {"v": 37.5}, {"v": 500}, {"v": 34}, {"v": 11}, {"v": 11}, {"v": 4}, {"v": 127.0}, {"v": 11.0}, {"v": 1}, {"v": -30607.742242210294}, {"v": 3946.777334152007}, {"v": 16612.404199587338}, {"v": -390.1030565311408}, {"v": -10345.942106647737}, {"v": 2559.251207386308}, {"v": -5740.0101766107155}, {"v": -4110.4755423831975}, {"v": -286.10008461213437}, {"v": -925.376266963528}, {"v": 0}, {"v": 0}, {"v": 3}, {"v": 3}, {"v": 2}]}, {"c": [{"v": 63}, {"v": "2016-01-11-130"}, {"v": "2016-01-11"}, {"v": 130}, {"v": 1}, {"v": 0}, {"v": 8.0}, {"v": 8.0}, {"v": 70}, {"v": 14}, {"v": 1}, {"v": 0}, {"v": 4}, {"v": 82.0}, {"v": 5.0}, {"v": 0}, {"v": -59504.79185586645}, {"v": 3880.0004875293494}, {"v": -1536.4046047577729}, {"v": -3749.0292009156624}, {"v": -2045.789305994174}, {"v": 7374.200302694862}, {"v": 3202.5093598142066}, {"v": 7557.126860767149}, {"v": -2784.4567350278935}, {"v": 1940.5713186869084}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 2}, {"v": 0}]}, {"c": [{"v": 36}, {"v": "2016-01-14-89"}, {"v": "2016-01-14"}, {"v": 89}, {"v": 4}, {"v": 0}, {"v": 262.59999999999997}, {"v": 15.44705882352941}, {"v": 264}, {"v": 29}, {"v": 7}, {"v": 14}, {"v": 2}, {"v": 121.0}, {"v": 8.0}, {"v": 3}, {"v": -64632.86156037975}, {"v": -2037.0962321252669}, {"v": -5723.930330990788}, {"v": -5377.367723391139}, {"v": 3747.8406691258297}, {"v": -5267.392361356852}, {"v": -1423.3605211095714}, {"v": 2624.7536555669935}, {"v": 694.5247116475816}, {"v": 1524.1447658066968}, {"v": 2}, {"v": 2}, {"v": 0}, {"v": 0}, {"v": 0}]}, {"c": [{"v": 57}, {"v": "2016-01-10-67"}, {"v": "2016-01-10"}, {"v": 67}, {"v": 0}, {"v": 1}, {"v": 313.0}, {"v": 10.793103448275861}, {"v": 523}, {"v": 95}, {"v": 18}, {"v": 12}, {"v": 2}, {"v": 173.0}, {"v": 7.0}, {"v": 6}, {"v": -47773.22323187668}, {"v": 257.7393484854198}, {"v": 2191.7244765258706}, {"v": 752.021298700525}, {"v": 454.5530986064317}, {"v": -3717.498869037879}, {"v": 1848.419113846315}, {"v": -400.2721438307467}, {"v": 684.0082373708226}, {"v": -745.1399991640477}, {"v": 1}, {"v": 0}, {"v": 0}, {"v": 1}, {"v": 0}]}, {"c": [{"v": 54}, {"v": "2016-01-02-15"}, {"v": "2016-01-02"}, {"v": 15}, {"v": 6}, {"v": 0}, {"v": 202.0}, {"v": 33.666666666666664}, {"v": null}, {"v": null}, {"v": null}, {"v": null}, {"v": 2}, {"v": 163.0}, {"v": 8.0}, {"v": 1}, {"v": -48692.790605235336}, {"v": 5023.943173240101}, {"v": 4011.233328833058}, {"v": -1168.1156086830792}, {"v": -7489.87405270384}, {"v": 1615.0170148318837}, {"v": 501.62937649389056}, {"v": -527.1636014241343}, {"v": 1293.422760793384}, {"v": 1256.3776656419784}, {"v": 0}, {"v": 0}, {"v": 4}, {"v": 1}, {"v": 2}]}, {"c": [{"v": 57}, {"v": "2016-01-10-39"}, {"v": "2016-01-10"}, {"v": 39}, {"v": 0}, {"v": 1}, {"v": 15.0}, {"v": 7.5}, {"v": 286}, {"v": 19}, {"v": 7}, {"v": 13}, {"v": 8}, {"v": 159.0}, {"v": 6.0}, {"v": 0}, {"v": -47773.22323187668}, {"v": 257.7393484854198}, {"v": 2191.7244765258706}, {"v": 752.021298700525}, {"v": 454.5530986064317}, {"v": -3717.498869037879}, {"v": 1848.419113846315}, {"v": -400.2721438307467}, {"v": 684.0082373708226}, {"v": -745.1399991640477}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 0}]}, {"c": [{"v": 46}, {"v": "2016-01-17-38"}, {"v": "2016-01-17"}, {"v": 38}, {"v": 0}, {"v": 1}, {"v": 448.0}, {"v": 29.866666666666667}, {"v": 823}, {"v": 82}, {"v": 32}, {"v": 48}, {"v": 4}, {"v": 102.0}, {"v": 6.0}, {"v": 3}, {"v": 18767.16165687503}, {"v": 2451.1587975424773}, {"v": 16298.071715811115}, {"v": 22162.126647351284}, {"v": 1191.4530953054111}, {"v": -3225.9169157385472}, {"v": -5561.897347071493}, {"v": -7660.23184191594}, {"v": -3264.5856076231807}, {"v": 1146.2455574297123}, {"v": 2}, {"v": 1}, {"v": 0}, {"v": 2}, {"v": 0}]}, {"c": [{"v": 58}, {"v": "2016-01-09-140"}, {"v": "2016-01-09"}, {"v": 140}, {"v": 6}, {"v": 0}, {"v": 33.0}, {"v": 16.5}, {"v": 224}, {"v": 15}, {"v": 15}, {"v": 3}, {"v": 3}, {"v": 183.0}, {"v": 7.0}, {"v": 0}, {"v": -64227.7681026366}, {"v": -2781.683409864666}, {"v": -2423.978655731152}, {"v": -6508.847954398299}, {"v": -359.5946875690494}, {"v": 870.7594866133936}, {"v": -1502.4616592606394}, {"v": 55.35765812659116}, {"v": 1128.7813734974432}, {"v": 1463.8800320260932}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 1}]}, {"c": [{"v": 53}, {"v": "2016-01-21-43"}, {"v": "2016-01-21"}, {"v": 43}, {"v": 4}, {"v": 0}, {"v": 337.0}, {"v": 37.44444444444444}, {"v": 240}, {"v": 17}, {"v": 2}, {"v": 5}, {"v": 4}, {"v": 49.0}, {"v": 1.0}, {"v": 1}, {"v": -63660.54124372009}, {"v": -4384.508187659805}, {"v": -4188.363626321196}, {"v": -8202.021164806481}, {"v": 1580.7606018118715}, {"v": -251.2278841225697}, {"v": -2523.217713125798}, {"v": 477.5149073472266}, {"v": 930.2480500278718}, {"v": 54.766303382663686}, {"v": 0}, {"v": 2}, {"v": 2}, {"v": 0}, {"v": 2}]}, {"c": [{"v": 41}, {"v": "2016-01-18-54"}, {"v": "2016-01-18"}, {"v": 54}, {"v": 1}, {"v": 0}, {"v": 309.7}, {"v": 18.21764705882353}, {"v": 254}, {"v": 45}, {"v": 14}, {"v": 7}, {"v": null}, {"v": null}, {"v": null}, {"v": 9}, {"v": -63794.1683045981}, {"v": -2381.6643063379875}, {"v": -3549.849425554242}, {"v": -7280.208512607691}, {"v": 1028.1674706444596}, {"v": 486.3775065070298}, {"v": -634.3361377617749}, {"v": 799.4510793868378}, {"v": 409.6974772559967}, {"v": -477.19839667001077}, {"v": 10}, {"v": 2}, {"v": 11}, {"v": 13}, {"v": 0}]}, {"c": [{"v": 35}, {"v": "2016-01-05-109"}, {"v": "2016-01-05"}, {"v": 109}, {"v": 2}, {"v": 0}, {"v": 350.7}, {"v": 19.483333333333334}, {"v": 329}, {"v": 44}, {"v": 14}, {"v": 5}, {"v": 4}, {"v": 42.0}, {"v": 8.0}, {"v": 1}, {"v": -62108.40537426752}, {"v": -1597.4540409213016}, {"v": -2281.3415176206936}, {"v": -5367.720469804684}, {"v": 131.7044948496004}, {"v": 6.323113769207557}, {"v": -1158.9103961311603}, {"v": 1808.4631016349813}, {"v": 9.694361196531876}, {"v": 933.5337778022598}, {"v": 0}, {"v": 1}, {"v": 1}, {"v": 0}, {"v": 1}]}, {"c": [{"v": 7}, {"v": "2016-01-08-83"}, {"v": "2016-01-08"}, {"v": 83}, {"v": 5}, {"v": 0}, {"v": 2465.4000000000015}, {"v": 17.86521739130436}, {"v": 1961}, {"v": 557}, {"v": 204}, {"v": 96}, {"v": 3}, {"v": 104.0}, {"v": 6.0}, {"v": 4}, {"v": 194502.1768251736}, {"v": -118529.11141726472}, {"v": 41855.60263548842}, {"v": -25162.950979380294}, {"v": -6096.774738519995}, {"v": -186.00277981099455}, {"v": 11923.001767560034}, {"v": -4404.594733167425}, {"v": -6875.543023636828}, {"v": -377.03198692554037}, {"v": 8}, {"v": 4}, {"v": 6}, {"v": 1}, {"v": 4}]}, {"c": [{"v": 38}, {"v": "2016-01-12-92"}, {"v": "2016-01-12"}, {"v": 92}, {"v": 2}, {"v": 0}, {"v": 130.5}, {"v": 18.642857142857142}, {"v": 377}, {"v": 82}, {"v": 24}, {"v": 20}, {"v": 3}, {"v": 64.0}, {"v": 4.0}, {"v": 0}, {"v": -55675.97168334918}, {"v": 197.55749255608782}, {"v": 1409.8597901207015}, {"v": -5526.461837325348}, {"v": -1318.2119825386803}, {"v": 441.98451441921895}, {"v": -1170.4813351876405}, {"v": 972.3741228581148}, {"v": 1210.753183088647}, {"v": 964.3285146391023}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 3}]}, {"c": [{"v": 57}, {"v": "2016-01-13-83"}, {"v": "2016-01-13"}, {"v": 83}, {"v": 3}, {"v": 0}, {"v": 106.0}, {"v": 6.625}, {"v": 522}, {"v": 90}, {"v": 27}, {"v": 23}, {"v": 2}, {"v": 90.0}, {"v": 4.0}, {"v": 1}, {"v": -47773.22323187668}, {"v": 257.7393484854198}, {"v": 2191.7244765258706}, {"v": 752.021298700525}, {"v": 454.5530986064317}, {"v": -3717.498869037879}, {"v": 1848.419113846315}, {"v": -400.2721438307467}, {"v": 684.0082373708226}, {"v": -745.1399991640477}, {"v": 3}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 1}]}, {"c": [{"v": 38}, {"v": "2016-01-01-83"}, {"v": "2016-01-01"}, {"v": 83}, {"v": 5}, {"v": 0}, {"v": 329.0}, {"v": 19.352941176470587}, {"v": 412}, {"v": 102}, {"v": 23}, {"v": 20}, {"v": 2}, {"v": 214.0}, {"v": 11.0}, {"v": 7}, {"v": -55675.97168334918}, {"v": 197.55749255608782}, {"v": 1409.8597901207015}, {"v": -5526.461837325348}, {"v": -1318.2119825386803}, {"v": 441.98451441921895}, {"v": -1170.4813351876405}, {"v": 972.3741228581148}, {"v": 1210.753183088647}, {"v": 964.3285146391023}, {"v": 9}, {"v": 17}, {"v": 24}, {"v": 8}, {"v": 14}]}, {"c": [{"v": 44}, {"v": "2016-01-02-43"}, {"v": "2016-01-02"}, {"v": 43}, {"v": 6}, {"v": 0}, {"v": 50.0}, {"v": 25.0}, {"v": 49}, {"v": 7}, {"v": 1}, {"v": 3}, {"v": 2}, {"v": 170.0}, {"v": 7.0}, {"v": 2}, {"v": -65241.696328510974}, {"v": -3025.628111336731}, {"v": -3997.351379383407}, {"v": -9049.147801025816}, {"v": 1384.83728489974}, {"v": 328.9162523341969}, {"v": -2172.949052944524}, {"v": 1063.2661755751321}, {"v": 891.8056701634796}, {"v": -139.34230316669635}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 0}, {"v": 0}]}, {"c": [{"v": 51}, {"v": "2016-01-05-97"}, {"v": "2016-01-05"}, {"v": 97}, {"v": 2}, {"v": 0}, {"v": 10600.099999999999}, {"v": 19.168354430379743}, {"v": 3135}, {"v": 1869}, {"v": 626}, {"v": 311}, {"v": 4}, {"v": 39.0}, {"v": 8.0}, {"v": 16}, {"v": 708222.8661305557}, {"v": 56252.64325249546}, {"v": 45318.94431890442}, {"v": -31516.352076592088}, {"v": 6643.824980215071}, {"v": -6255.779985737854}, {"v": -5874.627822750455}, {"v": 5230.070882955488}, {"v": 960.2123371321513}, {"v": 925.7262012233465}, {"v": 6}, {"v": 22}, {"v": 178}, {"v": 50}, {"v": 8}]}, {"c": [{"v": 14}, {"v": "2016-01-12-121"}, {"v": "2016-01-12"}, {"v": 121}, {"v": 2}, {"v": 0}, {"v": 1613.5999999999995}, {"v": 18.76279069767441}, {"v": 1417}, {"v": 285}, {"v": 94}, {"v": 56}, {"v": 2}, {"v": 86.0}, {"v": 3.0}, {"v": 4}, {"v": 17734.3389758934}, {"v": -13841.966209369697}, {"v": -28341.67147182252}, {"v": 5611.532935324984}, {"v": 11650.87057184014}, {"v": 2326.9840676221397}, {"v": 206.36312239694496}, {"v": 4512.206893564415}, {"v": 2241.490098146428}, {"v": -8619.427634111038}, {"v": 2}, {"v": 1}, {"v": 4}, {"v": 1}, {"v": 1}]}, {"c": [{"v": 25}, {"v": "2016-01-15-18"}, {"v": "2016-01-15"}, {"v": 18}, {"v": 5}, {"v": 0}, {"v": 37.0}, {"v": 12.333333333333334}, {"v": 409}, {"v": 41}, {"v": 14}, {"v": 7}, {"v": 3}, {"v": 188.0}, {"v": 5.0}, {"v": 2}, {"v": -31927.356648464465}, {"v": 17027.530646824303}, {"v": 8299.896079676664}, {"v": 3632.5411485307463}, {"v": -1024.618415711511}, {"v": 4767.026607966623}, {"v": 6389.64024104815}, {"v": 6162.752207131447}, {"v": -2138.4157436498244}, {"v": 166.99327736474052}, {"v": 0}, {"v": 2}, {"v": 4}, {"v": 0}, {"v": 0}]}, {"c": [{"v": 57}, {"v": "2016-01-04-123"}, {"v": "2016-01-04"}, {"v": 123}, {"v": 1}, {"v": 0}, {"v": 52.0}, {"v": 6.5}, {"v": 477}, {"v": 72}, {"v": 19}, {"v": 8}, {"v": 4}, {"v": 211.0}, {"v": 12.0}, {"v": 0}, {"v": -47773.22323187668}, {"v": 257.7393484854198}, {"v": 2191.7244765258706}, {"v": 752.021298700525}, {"v": 454.5530986064317}, {"v": -3717.498869037879}, {"v": 1848.419113846315}, {"v": -400.2721438307467}, {"v": 684.0082373708226}, {"v": -745.1399991640477}, {"v": 0}, {"v": 1}, {"v": 1}, {"v": 0}, {"v": 2}]}, {"c": [{"v": 35}, {"v": "2016-01-12-38"}, {"v": "2016-01-12"}, {"v": 38}, {"v": 2}, {"v": 0}, {"v": 19.0}, {"v": 19.0}, {"v": 106}, {"v": 17}, {"v": 0}, {"v": 1}, {"v": 2}, {"v": 48.0}, {"v": 4.0}, {"v": 1}, {"v": -62108.40537426752}, {"v": -1597.4540409213016}, {"v": -2281.3415176206936}, {"v": -5367.720469804684}, {"v": 131.7044948496004}, {"v": 6.323113769207557}, {"v": -1158.9103961311603}, {"v": 1808.4631016349813}, {"v": 9.694361196531876}, {"v": 933.5337778022598}, {"v": 1}, {"v": 0}, {"v": 1}, {"v": 0}, {"v": 0}]}, {"c": [{"v": 26}, {"v": "2016-01-01-101"}, {"v": "2016-01-01"}, {"v": 101}, {"v": 5}, {"v": 0}, {"v": 501.5}, {"v": 21.804347826086957}, {"v": 359}, {"v": 80}, {"v": 25}, {"v": 11}, {"v": 2}, {"v": 168.0}, {"v": 12.0}, {"v": 1}, {"v": -59316.19770135737}, {"v": -4734.678150883374}, {"v": -504.89162687795965}, {"v": -4147.46537609326}, {"v": -582.3998573778894}, {"v": 89.5481513594684}, {"v": -2526.64154423666}, {"v": -520.8476126145814}, {"v": 453.97207853578675}, {"v": 404.1440862641897}, {"v": 3}, {"v": 1}, {"v": 3}, {"v": 2}, {"v": 1}]}, {"c": [{"v": 46}, {"v": "2016-01-17-18"}, {"v": "2016-01-17"}, {"v": 18}, {"v": 0}, {"v": 1}, {"v": 395.0}, {"v": 23.235294117647058}, {"v": 898}, {"v": 122}, {"v": 42}, {"v": 30}, {"v": 4}, {"v": 115.0}, {"v": 6.0}, {"v": 1}, {"v": 18767.16165687503}, {"v": 2451.1587975424773}, {"v": 16298.071715811115}, {"v": 22162.126647351284}, {"v": 1191.4530953054111}, {"v": -3225.9169157385472}, {"v": -5561.897347071493}, {"v": -7660.23184191594}, {"v": -3264.5856076231807}, {"v": 1146.2455574297123}, {"v": 2}, {"v": 3}, {"v": 2}, {"v": 4}, {"v": 2}]}], "cols": [{"type": "number", "id": "district_id", "label": "district_id"}, {"type": "string", "id": "timeslot", "label": "timeslot"}, {"type": "string", "id": "date", "label": "date"}, {"type": "number", "id": "timeofday_slot", "label": "timeofday_slot"}, {"type": "number", "id": "day_in_week", "label": "day_in_week"}, {"type": "number", "id": "is_sunday", "label": "is_sunday"}, {"type": "number", "id": "sum_price", "label": "sum_price"}, {"type": "number", "id": "avg_price", "label": "avg_price"}, {"type": "number", "id": "traffic_tj_level1", "label": "traffic_tj_level1"}, {"type": "number", "id": "traffic_tj_level2", "label": "traffic_tj_level2"}, {"type": "number", "id": "traffic_tj_level3", "label": "traffic_tj_level3"}, {"type": "number", "id": "traffic_tj_level4", "label": "traffic_tj_level4"}, {"type": "number", "id": "weather", "label": "weather"}, {"type": "number", "id": "weather_pm25", "label": "weather_pm25"}, {"type": "number", "id": "weather_temperature", "label": "weather_temperature"}, {"type": "number", "id": "gap", "label": "gap"}, {"type": "number", "id": "poi1", "label": "poi1"}, {"type": "number", "id": "poi2", "label": "poi2"}, {"type": "number", "id": "poi3", "label": "poi3"}, {"type": "number", "id": "poi4", "label": "poi4"}, {"type": "number", "id": "poi5", "label": "poi5"}, {"type": "number", "id": "poi6", "label": "poi6"}, {"type": "number", "id": "poi7", "label": "poi7"}, {"type": "number", "id": "poi8", "label": "poi8"}, {"type": "number", "id": "poi9", "label": "poi9"}, {"type": "number", "id": "poi10", "label": "poi10"}, {"type": "number", "id": "previous_gap1", "label": "previous_gap1"}, {"type": "number", "id": "previous_gap2", "label": "previous_gap2"}, {"type": "number", "id": "previous_gap3", "label": "previous_gap3"}, {"type": "number", "id": "previous_gap4", "label": "previous_gap4"}, {"type": "number", "id": "previous_gap5", "label": "previous_gap5"}]});
        }
      );
    </script>
  </div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 3px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
              <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
            </div>
          </div>
        </div>
      </div>
      <div id="sidebarArea">
        <div id="sidebarToolbar">
          <div class="btn-toolbar pull-left">
            <div class="btn-group">
              <button id="toggleSidebarButton" type="button" class="btn" title="Toggle the size of the sidebar">
                <span class="fa fa-chevron-right fa-flip-horizontal"></span>
              </button>
            </div>
            <div class="btn-group">
              <button id="navigationButton" type="button" class="btn">Navigation</button>
              <button id="helpButton" type="button" class="btn active">Help</button>
            </div>
          </div>
        </div>
        <div id="sidebarContent">
          <div id="navigation" style="display: none"><div><b>Notebook Outline</b></div><br><div><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" cellindex="1">Gaps Table</a></div><br><div><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" cellindex="5">+1 timeslot</a></div><br><div><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" cellindex="8">Gaps Table + Other Tables</a></div><br><div><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" cellindex="10">PCA</a></div><br><div><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/(archive-1)%202.a.%20Data%20Wrangling.ipynb#" cellindex="17">Previous Gap</a></div></div>
          <div id="help">
            <p><b>Help for Python APIs</b></p>
            <p>
              You can enter <code>class?</code> or <code>member?</code> within a code cell in the
              notebook to get help on a Python API.
            </p>
            <br>
            <p>
              For example, try <code>str?</code> to get help information on the built-in Python
              method to convert a value to its string representation.
            </p>
            <br>
            <p>
              Additional help topics and links are also available from the menu off the Help
              icon on the top of the page.
            </p>
            <br>
            <p><b>Docs and Samples</b></p>
            <p>
              The <a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/datalab/Readme.ipynb" target"_blank"="">Cloud Datalab Guide</a> featuring
              documentation and sample notebooks is also a great way to check out how you can use Cloud Datalab.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="./(archive-1) 2.a. Data Wrangling_files/promise.min.js"></script>
  <script src="./(archive-1) 2.a. Data Wrangling_files/socket.io.js"></script>
  <script src="./(archive-1) 2.a. Data Wrangling_files/require.js"></script>
  <script>
    window.mathjax_url = '';
    window.sys_info = {};
    require.config({
      baseUrl: '/static/',
      paths: {
        'auth/js/main': 'auth/js/main.min',
        custom : '/custom',
        nbextensions : '/nbextensions',
        widgets : '/deprecatedwidgets',
        kernelspecs : '/kernelspecs',
        underscore : 'components/underscore/underscore-min',
        backbone : 'components/backbone/backbone-min',
        jquery: 'components/jquery/jquery.min',
        bootstrap: 'components/bootstrap/js/bootstrap.min',
        bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
        jqueryui: 'components/jquery-ui/ui/minified/jquery-ui.min',
        moment: 'components/moment/moment',
        codemirror: 'components/codemirror',
        termjs: 'components/term.js/src/term',
      },
      shim: {
        underscore: {
          exports: '_'
        },
        backbone: {
          deps: ["underscore", "jquery"],
          exports: "Backbone"
        },
        bootstrap: {
          deps: ["jquery"],
          exports: "bootstrap"
        },
        bootstraptour: {
          deps: ["bootstrap"],
          exports: "Tour"
        },
        jqueryui: {
          deps: ["jquery"],
          exports: "$"
        }
      }
    });
    require.config({
       map: {
         '*': {
           'contents': 'services/contents',
         }
       }
     });
     window.datalab = {};
  </script>
  <script src="./(archive-1) 2.a. Data Wrangling_files/main.min.js" charset="utf-8"></script>
  <script src="./(archive-1) 2.a. Data Wrangling_files/api.js" async="true" defer="true"></script>
  <script type="text/fragment" id="cellStatus">
    <div class="status" style="display: none;">
      Running...
      <div class="progress progress-striped active">
        <div class="progress-bar" style="width: 100%"></div>
      </div>
    </div>
  </script>
  <script type="text/fragment" id="shortcutsHelp">
    <p>The notebook has two keyboard modes: Edit mode allows you to type code/text into a cell indicated by a raised cell with a shadow. Command mode allows notebook level actions.</p>
    <br>
    <p><b>Command Mode</b> (<code>Esc</code> to enable)</p>
    <div>
      <div><code>Enter</code>: edit mode</div>
      <div><code>Ctrl/Cmd+S</code>: save notebook</div>
      <div><code>Shift+Enter</code>: run cell, select next</div>
      <div><code>Ctrl+Enter</code>: run cell</div>
      <div><code>y</code>: to code</div>
      <div><code>m</code>: to markdown</div>
      <div><code>Up</code>: select previous cell</div>
      <div><code>Down</code>: select next cell</div>
      <div><code>Ctrl+K</code>: move cell up</div>
      <div><code>Ctrl+J</code>: move cell down</div>
      <div><code>a</code>: insert cell above</div>
      <div><code>b</code>: insert cell below</div>
      <div><code>x</code>: cut cell</div>
      <div><code>c</code>: copy cell</div>
      <div><code>v</code>: paste below</div>
      <div><code>dd</code>: delete cell</div>
      <div><code>z</code>: undo delete cell</div>
    </div>
    <br>
    <p><b>Edit Mode</b> (<code>Enter</code> to enable)</p>
    <div>
      <div><code>Esc</code>: command mode</div>
      <div><code>Ctrl/Cmd+S</code>: save notebook</div>
      <div><code>Shift+Enter</code>: run cell, select next</div>
      <div><code>Tab</code>: code completion or indent</div>
      <div><code>Shift+Tab</code>: quick help</div>
      <div><code>Ctrl/Cmd+]</code>: indent</div>
      <div><code>Ctrl/Cmd+[</code>: dedent</div>
      <div><code>Ctrl/Cmd+a</code>: select all</div>
      <div><code>Ctrl/Cmd+z</code>: undo</div>
      <div><code>Ctrl/Cmd+Shift+z</code>: redo</div>
      <div><code>Ctrl/Cmd+x</code>: cut selected</div>
      <div><code>Ctrl/Cmd+c</code>: copy selected</div>
      <div><code>Ctrl/Cmd+v</code>: paste</div>
    </div>
  </script>
  <script type="text/fragment" id="markdownHelp">
  <b>Markdown Syntax</b><br /><br />
      <b>Headers</b>
<pre># This is a level 1 header.
## This is a level 2 header.
### This is a level 3 header.</pre>
      <b>Emphasis</b>
<pre>*Italic text*
_Also italic_

**Bold text</pre>
      <b>Unordered Lists</b>
<pre>* Item 1
* Item 2
  * Item 2a</pre>
      <b>Ordered Lists</b>
<pre>1. Item 1
2. Item 2
   * Item 2a</pre>
      <b>Links</b>
<pre>http://cloud.google.com - automatic
[Text](url)</pre>
      <b>Images</b>
      <pre>![Alt Text](url)</pre>
      <b>Quoted Text</b>
<pre>&gt; Quoted Line 1
&gt; Quoted Line 2</pre>
      <b>Inline Code</b>
      <pre>Some `code` inline</pre>
      <b>Code Block</b>
<pre>Normal text

    Indented code text</pre>
    </div>
  </script>


</body></html>