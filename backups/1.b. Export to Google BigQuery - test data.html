<!DOCTYPE html>
<!-- saved from url=(0172)https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>1.b. Export to Google BigQuery - test data</title>
  <link rel="shortcut icon" type="image/x-icon" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/static/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="./1.b. Export to Google BigQuery - test data_files/codemirror.css">
  <link rel="stylesheet" href="./1.b. Export to Google BigQuery - test data_files/style.min.css" type="text/css">
  <link rel="stylesheet" href="./1.b. Export to Google BigQuery - test data_files/custom.css" type="text/css">
<script async="" src="./1.b. Export to Google BigQuery - test data_files/analytics.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./1.b. Export to Google BigQuery - test data_files/contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./1.b. Export to Google BigQuery - test data_files/custom.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./1.b. Export to Google BigQuery - test data_files/extension.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/javascript/javascript" src="./1.b. Export to Google BigQuery - test data_files/javascript.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="extensions/charting" src="./1.b. Export to Google BigQuery - test data_files/charting.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="element" src="./1.b. Export to Google BigQuery - test data_files/element.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="style" src="./1.b. Export to Google BigQuery - test data_files/style.js"></script><link type="text/css" rel="stylesheet" href="./1.b. Export to Google BigQuery - test data_files/charting.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="visualization" src="./1.b. Export to Google BigQuery - test data_files/visualization.js"></script><script type="text/javascript" async="" src="./1.b. Export to Google BigQuery - test data_files/jsapi"></script><script type="text/javascript" src="./1.b. Export to Google BigQuery - test data_files/saved_resource"></script><link type="text/css" href="./1.b. Export to Google BigQuery - test data_files/ui+en,table+en.css" rel="stylesheet"><script type="text/javascript" src="./1.b. Export to Google BigQuery - test data_files/format+en,default+en,ui+en,table+en.I.js"></script></head>
<body class="notebook_app command_mode" data-project="" data-base-url="/" data-ws-url="" data-notebook-name="1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb" data-notebook-path="Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb" data-feedback-id="717112" data-analytics-id="UA-54894152-3" data-analytics-path="0c5441ef222201b11e9588f4423efa50efe930efd4f9b4a0cf45560727e03450" data-analytics-title="notebook" data-project-num="803616047008" data-project-id="datalab-projects-1331" data-version-id="0.5.20160527" data-instance-id="fc414c2e-a65f-46e4-8fc0-3e935b86163c" data-instance-name="main" data-user-id="TeguhWPurwanto@gmail.com">
  <div id="app">
    <div id="appBar">
      <span id="logo" class="nav navbar-brand pull-left">
        <a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/tree"><img src="./1.b. Export to Google BigQuery - test data_files/logo.png" alt="Google Cloud DataLab"></a>
      </span>
      <span id="save_widget" class="pull-left save_widget">
        <button class="btn" title="Rename notebook"><span id="notebook_name" class="filename">1.b. Export to Google BigQuery - test data</span></button>
        <span class="autosave_status">(autosaved)</span>
      </span>
      <div class="btn-toolbar pull-right">
        <div class="btn-group">
          <button class="btn" data-toggle="dropdown" title="Help Links">
            <span class="fa fa-question-circle"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a id="keyboardHelpLink" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Keyboard Shortcuts</a></li>
            <li><a id="markdownHelpLink" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Markdown Syntax</a></li>
            <li class="divider"></li>
            <li><a href="https://cloud.google.com/bigquery/what-is-bigquery" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>BigQuery&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></a></li>
            <li><a href="https://cloud.google.com/storage/docs/overview" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Cloud Storage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></a></li>
            <li class="divider"></li>
            <li><a href="https://developers.google.com/chart/" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Google Charts</span></a></li>
            <li><a href="http://matplotlib.org/contents.html" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Matplotlib</span></a></li>
            <li><a href="http://pandas.pydata.org/pandas-docs/stable/" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>Pandas</span></a></li>
            <li><a href="http://scikit-learn.org/stable/" target="_blank"><i class="fa fa-external-link pull-right menu-icon"></i><span>SciKit-Learn</span></a></li>
          </ul>
        </div>
        <div class="btn-group">
          <button class="btn" data-toggle="dropdown" title="User and Project Information">
            <span class="fa fa-user"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" id="userId">TeguhWPurwanto@gmail.com</a></li>
            <li class="divider"></li>
            <li><a href="https://console.developers.google.com/project/datalab-projects-1331" id="consoleLink" target="_blank">Developer Console</a></li>
            <li><a href="https://console.developers.google.com/project/datalab-projects-1331/appengine/versions?moduleId=datalab" id="instancesLink" target="_blank">Developer Console: Cloud Datalab Instances</a></li>
            <li><a href="https://console.developers.google.com/project/datalab-projects-1331/clouddev/develop/browse/default/datalab_main" id="repoLink" target="_blank">Developer Console: Git Repository</a></li>
          </ul>
        </div>
        <div class="btn-group">
          <button id="feedbackButton" title="Provide feedback">
            <span class="fa fa-comment"></span>
          </button>
        </div>
        <div class="btn-group">
          <button id="aboutButton" title="About Google Cloud Datalab">
            <span class="fa fa-info-circle"></span>
          </button>
        </div>
      </div>
    </div>
    <div id="appContent">
      <div id="mainArea">
        <div id="mainToolbar">
          <div class="btn-toolbar pull-left">
            <div class="btn-group">
              <button type="button" class="btn" data-toggle="dropdown" title="Notebook commands">
                <span class="fa fa-book"></span> Notebook <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li id="saveButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Save</a></li>
                <li id="saveCopyButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Save copy</a></li>
                <li id="renameButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Rename...</a></li>
                <li class="divider"></li>
                <li id="downloadButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Download</a></li>
                <li class="divider"></li>
                <li id="convertHTMLButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Convert to HTML</a></li>
                <li id="convertPythonButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Convert to Python</a></li>
              </ul>
            </div>
          </div>
          <div class="btn-toolbar pull-right">
            <div class="btn-group">
              <button id="addCodeCellButton" type="button" class="btn" title="Append a new code cell">
                <span class="fa fa-plus-square"></span> Add Code
              </button>
              <button id="addMarkdownCellButton" type="button" class="btn" title="Append a new markdown cell">
                <span class="fa fa-plus-square"></span> Add Markdown
              </button>
              <button id="deleteCellButton" type="button" class="btn" title="Delete the selected cell">
                <span class="fa fa-minus-square"></span> Delete
              </button>
              <button id="moveCellUpButton" type="button" class="btn" title="Move the selected cell up">
                <span class="fa fa-chevron-up"></span> Move Up
              </button>
              <button id="moveCellDownButton" type="button" class="btn" title="Move the selected cell down">
                <span class="fa fa-chevron-down"></span> Move Down
              </button>
            </div>
            <div class="btn-group">
              <button id="runButton" type="button" class="btn" title="Run the selected cell">
                <span class="fa fa-play"></span> Run
              </button>
              <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li id="runAllButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Run all Cells</a></li>
                <li id="runToButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Run to this Cell</a></li>
                <li id="runFromButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Run from this Cell</a></li>
              </ul>
            </div>
            <div class="btn-group">
              <button id="clearButton" type="button" class="btn" title="Clear outputs of the selected cell">
                <span class="fa fa-minus-square-o"></span> Clear
              </button>
              <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li id="clearAllButton"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#">Clear all Cells</a></li>
              </ul>
            </div>
            <div class="btn-group">
              <button id="resetSessionButton" type="button" class="btn" title="Restart the current notebook session">
                <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i> Reset Session
              </button>
            </div>
          </div>
        </div>
        <div id="mainContent" class="container">
          <div id="ipython-main-app">
            <div id="notebook_panel" style="position: relative">
              <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Most work disappeared so there you go.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Most work disappeared so there you go.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 417px; margin-bottom: -17px; border-right-width: 13px; min-height: 390px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>&#8203;</span>x</span><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>18</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">cStringIO</span> <span class="cm-keyword">import</span> <span class="cm-variable">StringIO</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">gzip</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">glob</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">re</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pdb</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">gcp</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">gcp</span> <span class="cm-keyword">import</span> <span class="cm-variable">storage</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">gcp</span> <span class="cm-keyword">import</span> <span class="cm-variable">bigquery</span> <span class="cm-keyword">as</span> <span class="cm-variable">bq</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Import zip file from Google Cloud Storage</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">project</span> = <span class="cm-variable">gcp</span>.<span class="cm-variable">Context</span>.<span class="cm-variable">default</span>().<span class="cm-variable">project_id</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># project = 'datalab-dot-alien-oarlock-130015'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">bucket_name</span> = <span class="cm-variable">project</span> <span class="cm-operator">+</span> <span class="cm-string">'-datalab'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">bucket_path</span> = <span class="cm-string">'gs://'</span> <span class="cm-operator">+</span> <span class="cm-variable">bucket_name</span> <span class="cm-operator">+</span> <span class="cm-string">'/data'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'Bucket: '</span> <span class="cm-operator">+</span> <span class="cm-variable">bucket_path</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 390px;"></div><div class="CodeMirror-gutters" style="height: 403px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 759px; margin-bottom: -17px; border-right-width: 13px; min-height: 810px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>38</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Downloading and extracting the files from cloud storage.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">process_datafile</span>(<span class="cm-variable">localpath</span>, <span class="cm-variable">storagepath</span>, <span class="cm-variable">table</span>, <span class="cm-variable">mode</span>=<span class="cm-string">'create'</span>, <span class="cm-variable">overwrite</span>=<span class="cm-builtin">False</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">gzip_filename</span> = <span class="cm-string">'citydata.tar.gz'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">tar_filename</span> = <span class="cm-string">'citydata.tar'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">datadir</span> = <span class="cm-string">'season_1'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">storagepath_r</span> = <span class="cm-variable">storagepath</span>.<span class="cm-variable">split</span>(<span class="cm-string">'/'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment"># If data has not been extracted, extract it.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">isdir</span>(<span class="cm-variable">datadir</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># If citydata.tar has not been downloaded, download it</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">isfile</span>(<span class="cm-variable">tar_filename</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">bucket_object</span> = <span class="cm-string">'/'</span>.<span class="cm-variable">join</span>(<span class="cm-variable">storagepath_r</span>[:<span class="cm-number">3</span>]) <span class="cm-operator">+</span> <span class="cm-string">'/citydata.tar.gz'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-operator">%</span><span class="cm-variable">storage</span> <span class="cm-variable">read</span> <span class="cm-operator">--</span><span class="cm-builtin">object</span> <span class="cm-error">$</span><span class="cm-variable">bucket_object</span> <span class="cm-operator">--</span><span class="cm-variable">variable</span> <span class="cm-variable">compressed_file</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">gzip_file</span> = <span class="cm-variable">gzip</span>.<span class="cm-variable">GzipFile</span>(<span class="cm-variable">fileobj</span>=<span class="cm-variable">StringIO</span>(<span class="cm-variable">compressed_file</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">del</span> <span class="cm-variable">compressed_file</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">import</span> <span class="cm-variable">shutil</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">tar_filename</span>, <span class="cm-string">'wb'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f_out</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">shutil</span>.<span class="cm-variable">copyfileobj</span>(<span class="cm-variable">gzip_file</span>, <span class="cm-variable">f_out</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">import</span> <span class="cm-variable">tarfile</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tar</span> = <span class="cm-variable">tarfile</span>.<span class="cm-builtin">open</span>(<span class="cm-variable">tar_filename</span>, <span class="cm-string">"r"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tar</span>.<span class="cm-variable">extractall</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tar</span>.<span class="cm-variable">close</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">os</span>.<span class="cm-variable">remove</span>(<span class="cm-variable">tar_filename</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment"># Upload extracted file into GCS</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">bucketname</span> = <span class="cm-variable">storagepath_r</span>[<span class="cm-number">2</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">itempath</span> = <span class="cm-string">'/'</span>.<span class="cm-variable">join</span>(<span class="cm-variable">storagepath_r</span>[<span class="cm-number">3</span>:])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">item</span> = <span class="cm-variable">storage</span>.<span class="cm-variable">Item</span>(<span class="cm-variable">bucketname</span>, <span class="cm-variable">itempath</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">item</span>.<span class="cm-variable">exists</span>() <span class="cm-keyword">or</span> <span class="cm-variable">overwrite</span>:    </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">localpath</span>, <span class="cm-string">'rb'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">item</span>.<span class="cm-variable">write_to</span>(<span class="cm-variable">f</span>.<span class="cm-variable">read</span>(), <span class="cm-string">'text/plain'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment"># Load data into Google BigQuery</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">load</span>(<span class="cm-variable">storagepath</span>, <span class="cm-variable">mode</span>=<span class="cm-variable">mode</span>, <span class="cm-variable">csv_options</span>=<span class="cm-variable">bq</span>.<span class="cm-variable">CSVOptions</span>(<span class="cm-variable">delimiter</span>=<span class="cm-string">'\t'</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 810px;"></div><div class="CodeMirror-gutters" style="height: 823px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Process Test Data</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Process-Test-Data">Process Test Data<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#Process-Test-Data">¶</a></h1>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Districts</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Districts">Districts<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#Districts">¶</a></h2>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 633px; margin-bottom: -17px; border-right-width: 13px; min-height: 243px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp_test.districts'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>([</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'district_hash'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'district_id'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">localpath</span> = <span class="cm-string">'season_1/test_set_1/cluster_map/cluster_map'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">storagepath</span> = <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">bucket_path</span>,<span class="cm-variable">localpath</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">process_datafile</span>(<span class="cm-variable">localpath</span>, <span class="cm-variable">storagepath</span>, <span class="cm-variable">table</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 243px;"></div><div class="CodeMirror-gutters" style="height: 256px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Weather</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Weather">Weather<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#Weather">¶</a></h2>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 615px; margin-bottom: -17px; border-right-width: 13px; min-height: 306px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>14</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp_test.weather'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>([</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'time'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'weather'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'temperature'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'pm25'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">wildpath</span> = <span class="cm-string">'season_1/test_set_1/weather_data/*'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">localpath</span> <span class="cm-keyword">in</span> <span class="cm-variable">glob</span>.<span class="cm-variable">glob</span>(<span class="cm-variable">wildpath</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">storagepath</span> = <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">bucket_path</span>,<span class="cm-variable">localpath</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">process_datafile</span>(<span class="cm-variable">localpath</span>, <span class="cm-variable">storagepath</span>, <span class="cm-variable">table</span>, <span class="cm-variable">mode</span>=<span class="cm-string">'append'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 306px;"></div><div class="CodeMirror-gutters" style="height: 319px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 768px; margin-bottom: -17px; border-right-width: 13px; min-height: 621px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>29</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%bigquery udf --module transform_weather_time</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Pad with 0 or given string.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int n Number to add padding to.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int width Width of number + padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param string z (Optional) Other string to replace '0' as padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-variable">pad</span>(<span class="cm-def">n</span>, <span class="cm-def">width</span>, <span class="cm-def">z</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">z</span> <span class="cm-operator">=</span> <span class="cm-variable-2">z</span> <span class="cm-operator">||</span> <span class="cm-string">'0'</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">n</span> <span class="cm-operator">=</span> <span class="cm-variable-2">n</span> <span class="cm-operator">+</span> <span class="cm-string">''</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable-2">width</span> <span class="cm-operator">?</span> <span class="cm-variable-2">n</span> : <span class="cm-keyword">new</span> <span class="cm-variable">Array</span>(<span class="cm-variable-2">width</span> <span class="cm-operator">-</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>).<span class="cm-property">join</span>(<span class="cm-variable-2">z</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">n</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Transform timestamps of weather table into timeslots in weather table.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param {{time: string, weather: integer, temperature: float, pm25: float}} r</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param function({{time: string, weather: integer, temperature: float, pm25: float,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     timeslot: string}}) emitFn</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span>(<span class="cm-def">r</span>, <span class="cm-def">emitFn</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">t</span> <span class="cm-operator">=</span> <span class="cm-variable-2">r</span>.<span class="cm-property">time</span>.<span class="cm-property">split</span>(<span class="cm-string-2">/[ :\-]/</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">slot</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">floor</span>((<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">3</span>]) <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">+</span> <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">4</span>])) <span class="cm-operator">/</span> <span class="cm-number">10</span>) <span class="cm-operator">+</span> <span class="cm-number">1</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">               <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">slot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">emitFn</span>(<span class="cm-variable-2">r</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 621px;"></div><div class="CodeMirror-gutters" style="height: 634px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 750px; margin-bottom: -17px; border-right-width: 13px; min-height: 75px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%%</span><span class="cm-variable">bigquery</span> <span class="cm-variable">execute</span> <span class="cm-operator">-</span><span class="cm-variable">t</span> <span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp_test</span>.<span class="cm-variable">weather</span> <span class="cm-operator">-</span><span class="cm-variable">m</span> <span class="cm-variable">overwrite</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SELECT</span> <span class="cm-variable">time</span>, <span class="cm-variable">weather</span>, <span class="cm-variable">temperature</span>, <span class="cm-variable">pm25</span>, <span class="cm-variable">timeslot</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FROM</span> <span class="cm-variable">transform_weather_time</span>([<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp_test</span>.<span class="cm-variable">weather</span>])</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 75px;"></div><div class="CodeMirror-gutters" style="height: 88px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[9]:</div><div class="output_subarea output_html rendered_html output_result">
    <div class="bqtv" id="3_146538653184"><div class="google-visualization-table" style="position: relative; z-index: 0; max-width: 100%; max-height: 100%;"><div style="position: relative; overflow: auto; max-width: 100%; max-height: 100%;"><table class="google-visualization-table-table" cellspacing="0"><thead><tr class="gchart-table-headerrow"><th class="gchart-table-headercell">&nbsp;</th><th class="gchart-table-headercell">time</th><th class="gchart-table-headercell">weather</th><th class="gchart-table-headercell">temperature</th><th class="gchart-table-headercell">pm25</th><th class="gchart-table-headercell">timeslot</th></tr></thead><tbody><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">1</td><td class="gchart-table-cell">2016-01-22 07:02:10</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">51</td><td class="gchart-table-cell">2016-01-22-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">2</td><td class="gchart-table-cell">2016-01-22 07:22:35</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">2</td><td class="gchart-table-cell google-visualization-table-td-number">51</td><td class="gchart-table-cell">2016-01-22-45</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">3</td><td class="gchart-table-cell">2016-01-22 09:12:48</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">53</td><td class="gchart-table-cell">2016-01-22-56</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">4</td><td class="gchart-table-cell">2016-01-22 09:28:39</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">53</td><td class="gchart-table-cell">2016-01-22-57</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">5</td><td class="gchart-table-cell">2016-01-22 15:12:31</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-22-92</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">6</td><td class="gchart-table-cell">2016-01-22 19:28:07</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">52</td><td class="gchart-table-cell">2016-01-22-117</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">7</td><td class="gchart-table-cell">2016-01-22 23:07:35</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">98</td><td class="gchart-table-cell">2016-01-22-139</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">8</td><td class="gchart-table-cell">2016-01-22 23:21:04</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">98</td><td class="gchart-table-cell">2016-01-22-141</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">9</td><td class="gchart-table-cell">2016-01-28 09:02:32</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">86</td><td class="gchart-table-cell">2016-01-28-55</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">10</td><td class="gchart-table-cell">2016-01-28 11:11:56</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">80</td><td class="gchart-table-cell">2016-01-28-68</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">11</td><td class="gchart-table-cell">2016-01-28 13:01:28</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">79</td><td class="gchart-table-cell">2016-01-28-79</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">12</td><td class="gchart-table-cell">2016-01-28 13:11:09</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">79</td><td class="gchart-table-cell">2016-01-28-80</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">13</td><td class="gchart-table-cell">2016-01-28 13:20:38</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">79</td><td class="gchart-table-cell">2016-01-28-81</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">14</td><td class="gchart-table-cell">2016-01-28 15:01:30</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">79</td><td class="gchart-table-cell">2016-01-28-91</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">15</td><td class="gchart-table-cell">2016-01-28 15:21:37</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">79</td><td class="gchart-table-cell">2016-01-28-93</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">16</td><td class="gchart-table-cell">2016-01-28 17:12:07</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">90</td><td class="gchart-table-cell">2016-01-28-104</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">17</td><td class="gchart-table-cell">2016-01-28 19:11:11</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">5</td><td class="gchart-table-cell google-visualization-table-td-number">94</td><td class="gchart-table-cell">2016-01-28-116</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">18</td><td class="gchart-table-cell">2016-01-28 21:12:54</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">79</td><td class="gchart-table-cell">2016-01-28-128</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">19</td><td class="gchart-table-cell">2016-01-28 23:01:36</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">58</td><td class="gchart-table-cell">2016-01-28-139</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">20</td><td class="gchart-table-cell">2016-01-28 23:11:31</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">58</td><td class="gchart-table-cell">2016-01-28-140</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">21</td><td class="gchart-table-cell">2016-01-28 23:20:46</td><td class="gchart-table-cell google-visualization-table-td-number">4</td><td class="gchart-table-cell google-visualization-table-td-number">6</td><td class="gchart-table-cell google-visualization-table-td-number">58</td><td class="gchart-table-cell">2016-01-28-141</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">22</td><td class="gchart-table-cell">2016-01-26 07:01:16</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-2</td><td class="gchart-table-cell google-visualization-table-td-number">60</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">23</td><td class="gchart-table-cell">2016-01-26 07:10:50</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-2</td><td class="gchart-table-cell google-visualization-table-td-number">60</td><td class="gchart-table-cell">2016-01-26-44</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">24</td><td class="gchart-table-cell">2016-01-26 07:20:47</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">-2</td><td class="gchart-table-cell google-visualization-table-td-number">60</td><td class="gchart-table-cell">2016-01-26-45</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">25</td><td class="gchart-table-cell">2016-01-26 11:01:15</td><td class="gchart-table-cell google-visualization-table-td-number">1</td><td class="gchart-table-cell google-visualization-table-td-number">3</td><td class="gchart-table-cell google-visualization-table-td-number">65</td><td class="gchart-table-cell">2016-01-26-67</td></tr></tbody></table></div><div class="google-visualization-table-div-page gradient"><div class="charts-inline-block charts-custom-button charts-custom-button-disabled charts-custom-button-collapse-right" role="button" aria-disabled="true" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-prev"></span></div></div></div><div class="charts-inline-block charts-custom-button charts-custom-button-collapse-left" role="button" tabindex="0" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-next"></span></div></div></div></div><div style="clear: both; width: 100%; height: 0px;"></div></div></div>
    <br>(rows: 78, time: 1.3s,     3KB processed, job: job_fwuykH66zniNveDyzEZwERLXjX4)<br>
    <script>
      require(['extensions/charting', 'element!3_146538653184', 'style!/static/extensions/charting.css'],
        function(charts, dom) {
          charts.render(dom,
            {
              chartStyle:"paged_table",
              dataName:"1",
              fields:"time,weather,temperature,pm25,timeslot",
              totalRows:78,
              rowsPerPage:25,
            }, {}, {"rows": [{"c": [{"v": "2016-01-22 07:02:10"}, {"v": 2}, {"v": 2.0}, {"v": 51.0}, {"v": "2016-01-22-43"}]}, {"c": [{"v": "2016-01-22 07:22:35"}, {"v": 2}, {"v": 2.0}, {"v": 51.0}, {"v": "2016-01-22-45"}]}, {"c": [{"v": "2016-01-22 09:12:48"}, {"v": 4}, {"v": 1.0}, {"v": 53.0}, {"v": "2016-01-22-56"}]}, {"c": [{"v": "2016-01-22 09:28:39"}, {"v": 4}, {"v": 1.0}, {"v": 53.0}, {"v": "2016-01-22-57"}]}, {"c": [{"v": "2016-01-22 15:12:31"}, {"v": 6}, {"v": 1.0}, {"v": 64.0}, {"v": "2016-01-22-92"}]}, {"c": [{"v": "2016-01-22 19:28:07"}, {"v": 4}, {"v": 1.0}, {"v": 52.0}, {"v": "2016-01-22-117"}]}, {"c": [{"v": "2016-01-22 23:07:35"}, {"v": 6}, {"v": 1.0}, {"v": 98.0}, {"v": "2016-01-22-139"}]}, {"c": [{"v": "2016-01-22 23:21:04"}, {"v": 6}, {"v": 1.0}, {"v": 98.0}, {"v": "2016-01-22-141"}]}, {"c": [{"v": "2016-01-28 09:02:32"}, {"v": 4}, {"v": 4.0}, {"v": 86.0}, {"v": "2016-01-28-55"}]}, {"c": [{"v": "2016-01-28 11:11:56"}, {"v": 4}, {"v": 5.0}, {"v": 80.0}, {"v": "2016-01-28-68"}]}, {"c": [{"v": "2016-01-28 13:01:28"}, {"v": 4}, {"v": 5.0}, {"v": 79.0}, {"v": "2016-01-28-79"}]}, {"c": [{"v": "2016-01-28 13:11:09"}, {"v": 4}, {"v": 5.0}, {"v": 79.0}, {"v": "2016-01-28-80"}]}, {"c": [{"v": "2016-01-28 13:20:38"}, {"v": 4}, {"v": 5.0}, {"v": 79.0}, {"v": "2016-01-28-81"}]}, {"c": [{"v": "2016-01-28 15:01:30"}, {"v": 4}, {"v": 5.0}, {"v": 79.0}, {"v": "2016-01-28-91"}]}, {"c": [{"v": "2016-01-28 15:21:37"}, {"v": 4}, {"v": 5.0}, {"v": 79.0}, {"v": "2016-01-28-93"}]}, {"c": [{"v": "2016-01-28 17:12:07"}, {"v": 4}, {"v": 5.0}, {"v": 90.0}, {"v": "2016-01-28-104"}]}, {"c": [{"v": "2016-01-28 19:11:11"}, {"v": 4}, {"v": 5.0}, {"v": 94.0}, {"v": "2016-01-28-116"}]}, {"c": [{"v": "2016-01-28 21:12:54"}, {"v": 4}, {"v": 6.0}, {"v": 79.0}, {"v": "2016-01-28-128"}]}, {"c": [{"v": "2016-01-28 23:01:36"}, {"v": 4}, {"v": 6.0}, {"v": 58.0}, {"v": "2016-01-28-139"}]}, {"c": [{"v": "2016-01-28 23:11:31"}, {"v": 4}, {"v": 6.0}, {"v": 58.0}, {"v": "2016-01-28-140"}]}, {"c": [{"v": "2016-01-28 23:20:46"}, {"v": 4}, {"v": 6.0}, {"v": 58.0}, {"v": "2016-01-28-141"}]}, {"c": [{"v": "2016-01-26 07:01:16"}, {"v": 1}, {"v": -2.0}, {"v": 60.0}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "2016-01-26 07:10:50"}, {"v": 1}, {"v": -2.0}, {"v": 60.0}, {"v": "2016-01-26-44"}]}, {"c": [{"v": "2016-01-26 07:20:47"}, {"v": 1}, {"v": -2.0}, {"v": 60.0}, {"v": "2016-01-26-45"}]}, {"c": [{"v": "2016-01-26 11:01:15"}, {"v": 1}, {"v": 3.0}, {"v": 65.0}, {"v": "2016-01-26-67"}]}], "cols": [{"type": "string", "id": "time", "label": "time"}, {"type": "number", "id": "weather", "label": "weather"}, {"type": "number", "id": "temperature", "label": "temperature"}, {"type": "number", "id": "pm25", "label": "pm25"}, {"type": "string", "id": "timeslot", "label": "timeslot"}]});
        }
      );
    </script>
  </div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Traffic</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Traffic">Traffic<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#Traffic">¶</a></h2>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 741px; margin-bottom: -17px; border-right-width: 13px; min-height: 432px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>20</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp_test.traffic'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>([</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'district_hash'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'tj_level1'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'tj_level2'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'tj_level3'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'tj_level4'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      {<span class="cm-string">'name'</span>: <span class="cm-string">'tj_time'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">wildpath</span> = <span class="cm-string">'season_1/test_set_1/traffic_data/*'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">localpath</span> <span class="cm-keyword">in</span> <span class="cm-variable">glob</span>.<span class="cm-variable">glob</span>(<span class="cm-variable">wildpath</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">localpath</span>, <span class="cm-string">'rb'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">text</span> = <span class="cm-variable">f</span>.<span class="cm-variable">read</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">localpath</span>, <span class="cm-string">'wb'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">f</span>.<span class="cm-variable">write</span>(<span class="cm-variable">re</span>.<span class="cm-variable">sub</span>(<span class="cm-string">r'\b\t[0-9]:\b'</span>, <span class="cm-string">'\t'</span>, <span class="cm-variable">text</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">storagepath</span> = <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">bucket_path</span>,<span class="cm-variable">localpath</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">process_datafile</span>(<span class="cm-variable">localpath</span>, <span class="cm-variable">storagepath</span>, <span class="cm-variable">table</span>, <span class="cm-variable">mode</span>=<span class="cm-string">'append'</span>, <span class="cm-variable">overwrite</span>=<span class="cm-builtin">True</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 432px;"></div><div class="CodeMirror-gutters" style="height: 445px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 17px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 17px; left: 34px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 17px; width: 17px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 939px; margin-bottom: -17px; border-right-width: 13px; min-height: 642px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>30</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%bigquery udf --module transform_traffic_time</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Pad with 0 or given string.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int n Number to add padding to.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int width Width of number + padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param string z (Optional) Other string to replace '0' as padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-variable">pad</span>(<span class="cm-def">n</span>, <span class="cm-def">width</span>, <span class="cm-def">z</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">z</span> <span class="cm-operator">=</span> <span class="cm-variable-2">z</span> <span class="cm-operator">||</span> <span class="cm-string">'0'</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">n</span> <span class="cm-operator">=</span> <span class="cm-variable-2">n</span> <span class="cm-operator">+</span> <span class="cm-string">''</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable-2">width</span> <span class="cm-operator">?</span> <span class="cm-variable-2">n</span> : <span class="cm-keyword">new</span> <span class="cm-variable">Array</span>(<span class="cm-variable-2">width</span> <span class="cm-operator">-</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>).<span class="cm-property">join</span>(<span class="cm-variable-2">z</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">n</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Transform timestamps of weather table into timeslots in traffic table.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param {{district_hash: string, tj_level1: integer, tj_level2: integer, tj_level3: integer, </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">            tj_level4: integer, tj_time: string}} r</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param function({{district_hash: string, tj_level1: integer, tj_level2: integer, tj_level3: integer, </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     tj_level4: integer, tj_time: string, timeslot: string}}) emitFn</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span>(<span class="cm-def">r</span>, <span class="cm-def">emitFn</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">t</span> <span class="cm-operator">=</span> <span class="cm-variable-2">r</span>.<span class="cm-property">tj_time</span>.<span class="cm-property">split</span>(<span class="cm-string-2">/[ :\-]/</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">slot</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">floor</span>((<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">3</span>]) <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">+</span> <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">4</span>])) <span class="cm-operator">/</span> <span class="cm-number">10</span>) <span class="cm-operator">+</span> <span class="cm-number">1</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">               <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">slot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">emitFn</span>(<span class="cm-variable-2">r</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 642px;"></div><div class="CodeMirror-gutters" style="height: 655px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 750px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%%</span><span class="cm-variable">bigquery</span> <span class="cm-variable">execute</span> <span class="cm-operator">-</span><span class="cm-variable">t</span> <span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp_test</span>.<span class="cm-variable">traffic</span> <span class="cm-operator">-</span><span class="cm-variable">m</span> <span class="cm-variable">overwrite</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SELECT</span> <span class="cm-variable">district_hash</span>, <span class="cm-variable">tj_level1</span>, <span class="cm-variable">tj_level2</span>, <span class="cm-variable">tj_level3</span>, <span class="cm-variable">tj_level4</span>, <span class="cm-variable">tj_time</span>, <span class="cm-variable">timeslot</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FROM</span> <span class="cm-variable">transform_traffic_time</span>([<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp_test</span>.<span class="cm-variable">traffic</span>])</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="height: 109px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[13]:</div><div class="output_subarea output_html rendered_html output_result">
    <div class="bqtv" id="4_146538680533"><div class="google-visualization-table" style="position: relative; z-index: 0; max-width: 100%; max-height: 100%;"><div style="position: relative; overflow: auto; max-width: 100%; max-height: 100%;"><table class="google-visualization-table-table" cellspacing="0"><thead><tr class="gchart-table-headerrow"><th class="gchart-table-headercell">&nbsp;</th><th class="gchart-table-headercell">district_hash</th><th class="gchart-table-headercell">tj_level1</th><th class="gchart-table-headercell">tj_level2</th><th class="gchart-table-headercell">tj_level3</th><th class="gchart-table-headercell">tj_level4</th><th class="gchart-table-headercell">tj_time</th><th class="gchart-table-headercell">timeslot</th></tr></thead><tbody><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">1</td><td class="gchart-table-cell">62afaf3288e236b389af9cfdc5206415</td><td class="gchart-table-cell google-visualization-table-td-number">2,355</td><td class="gchart-table-cell google-visualization-table-td-number">385</td><td class="gchart-table-cell google-visualization-table-td-number">70</td><td class="gchart-table-cell google-visualization-table-td-number">77</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">2</td><td class="gchart-table-cell">62afaf3288e236b389af9cfdc5206415</td><td class="gchart-table-cell google-visualization-table-td-number">2,355</td><td class="gchart-table-cell google-visualization-table-td-number">385</td><td class="gchart-table-cell google-visualization-table-td-number">70</td><td class="gchart-table-cell google-visualization-table-td-number">77</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">3</td><td class="gchart-table-cell">62afaf3288e236b389af9cfdc5206415</td><td class="gchart-table-cell google-visualization-table-td-number">2,355</td><td class="gchart-table-cell google-visualization-table-td-number">385</td><td class="gchart-table-cell google-visualization-table-td-number">70</td><td class="gchart-table-cell google-visualization-table-td-number">77</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">4</td><td class="gchart-table-cell">62afaf3288e236b389af9cfdc5206415</td><td class="gchart-table-cell google-visualization-table-td-number">2,355</td><td class="gchart-table-cell google-visualization-table-td-number">385</td><td class="gchart-table-cell google-visualization-table-td-number">70</td><td class="gchart-table-cell google-visualization-table-td-number">77</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">5</td><td class="gchart-table-cell">d4ec2125aff74eded207d2d915ef682f</td><td class="gchart-table-cell google-visualization-table-td-number">3,738</td><td class="gchart-table-cell google-visualization-table-td-number">705</td><td class="gchart-table-cell google-visualization-table-td-number">194</td><td class="gchart-table-cell google-visualization-table-td-number">131</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">6</td><td class="gchart-table-cell">d4ec2125aff74eded207d2d915ef682f</td><td class="gchart-table-cell google-visualization-table-td-number">3,738</td><td class="gchart-table-cell google-visualization-table-td-number">705</td><td class="gchart-table-cell google-visualization-table-td-number">194</td><td class="gchart-table-cell google-visualization-table-td-number">131</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">7</td><td class="gchart-table-cell">d4ec2125aff74eded207d2d915ef682f</td><td class="gchart-table-cell google-visualization-table-td-number">3,738</td><td class="gchart-table-cell google-visualization-table-td-number">705</td><td class="gchart-table-cell google-visualization-table-td-number">194</td><td class="gchart-table-cell google-visualization-table-td-number">131</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">8</td><td class="gchart-table-cell">d4ec2125aff74eded207d2d915ef682f</td><td class="gchart-table-cell google-visualization-table-td-number">3,738</td><td class="gchart-table-cell google-visualization-table-td-number">705</td><td class="gchart-table-cell google-visualization-table-td-number">194</td><td class="gchart-table-cell google-visualization-table-td-number">131</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">9</td><td class="gchart-table-cell">4725c39a5e5f4c188d382da3910b3f3f</td><td class="gchart-table-cell google-visualization-table-td-number">2,737</td><td class="gchart-table-cell google-visualization-table-td-number">573</td><td class="gchart-table-cell google-visualization-table-td-number">193</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">10</td><td class="gchart-table-cell">4725c39a5e5f4c188d382da3910b3f3f</td><td class="gchart-table-cell google-visualization-table-td-number">2,737</td><td class="gchart-table-cell google-visualization-table-td-number">573</td><td class="gchart-table-cell google-visualization-table-td-number">193</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">11</td><td class="gchart-table-cell">4725c39a5e5f4c188d382da3910b3f3f</td><td class="gchart-table-cell google-visualization-table-td-number">2,737</td><td class="gchart-table-cell google-visualization-table-td-number">573</td><td class="gchart-table-cell google-visualization-table-td-number">193</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">12</td><td class="gchart-table-cell">4725c39a5e5f4c188d382da3910b3f3f</td><td class="gchart-table-cell google-visualization-table-td-number">2,737</td><td class="gchart-table-cell google-visualization-table-td-number">573</td><td class="gchart-table-cell google-visualization-table-td-number">193</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">13</td><td class="gchart-table-cell">1afd7afbc81ecc1b13886a569d869e8a</td><td class="gchart-table-cell google-visualization-table-td-number">1,249</td><td class="gchart-table-cell google-visualization-table-td-number">255</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">14</td><td class="gchart-table-cell">1afd7afbc81ecc1b13886a569d869e8a</td><td class="gchart-table-cell google-visualization-table-td-number">1,249</td><td class="gchart-table-cell google-visualization-table-td-number">255</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">15</td><td class="gchart-table-cell">1afd7afbc81ecc1b13886a569d869e8a</td><td class="gchart-table-cell google-visualization-table-td-number">1,249</td><td class="gchart-table-cell google-visualization-table-td-number">255</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">16</td><td class="gchart-table-cell">1afd7afbc81ecc1b13886a569d869e8a</td><td class="gchart-table-cell google-visualization-table-td-number">1,249</td><td class="gchart-table-cell google-visualization-table-td-number">255</td><td class="gchart-table-cell google-visualization-table-td-number">67</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">17</td><td class="gchart-table-cell">82cc4851f9e4faa4e54309f8bb73fd7c</td><td class="gchart-table-cell google-visualization-table-td-number">2,534</td><td class="gchart-table-cell google-visualization-table-td-number">338</td><td class="gchart-table-cell google-visualization-table-td-number">119</td><td class="gchart-table-cell google-visualization-table-td-number">95</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">18</td><td class="gchart-table-cell">82cc4851f9e4faa4e54309f8bb73fd7c</td><td class="gchart-table-cell google-visualization-table-td-number">2,534</td><td class="gchart-table-cell google-visualization-table-td-number">338</td><td class="gchart-table-cell google-visualization-table-td-number">119</td><td class="gchart-table-cell google-visualization-table-td-number">95</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">19</td><td class="gchart-table-cell">82cc4851f9e4faa4e54309f8bb73fd7c</td><td class="gchart-table-cell google-visualization-table-td-number">2,534</td><td class="gchart-table-cell google-visualization-table-td-number">338</td><td class="gchart-table-cell google-visualization-table-td-number">119</td><td class="gchart-table-cell google-visualization-table-td-number">95</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">20</td><td class="gchart-table-cell">82cc4851f9e4faa4e54309f8bb73fd7c</td><td class="gchart-table-cell google-visualization-table-td-number">2,534</td><td class="gchart-table-cell google-visualization-table-td-number">338</td><td class="gchart-table-cell google-visualization-table-td-number">119</td><td class="gchart-table-cell google-visualization-table-td-number">95</td><td class="gchart-table-cell">2016-01-26 07:00:26</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">21</td><td class="gchart-table-cell">b05379ac3f9b7d99370d443cfd5dcc28</td><td class="gchart-table-cell google-visualization-table-td-number">1,554</td><td class="gchart-table-cell google-visualization-table-td-number">256</td><td class="gchart-table-cell google-visualization-table-td-number">66</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:27</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">22</td><td class="gchart-table-cell">b05379ac3f9b7d99370d443cfd5dcc28</td><td class="gchart-table-cell google-visualization-table-td-number">1,554</td><td class="gchart-table-cell google-visualization-table-td-number">256</td><td class="gchart-table-cell google-visualization-table-td-number">66</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:27</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">23</td><td class="gchart-table-cell">b05379ac3f9b7d99370d443cfd5dcc28</td><td class="gchart-table-cell google-visualization-table-td-number">1,554</td><td class="gchart-table-cell google-visualization-table-td-number">256</td><td class="gchart-table-cell google-visualization-table-td-number">66</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:27</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">24</td><td class="gchart-table-cell">b05379ac3f9b7d99370d443cfd5dcc28</td><td class="gchart-table-cell google-visualization-table-td-number">1,554</td><td class="gchart-table-cell google-visualization-table-td-number">256</td><td class="gchart-table-cell google-visualization-table-td-number">66</td><td class="gchart-table-cell google-visualization-table-td-number">64</td><td class="gchart-table-cell">2016-01-26 07:00:27</td><td class="gchart-table-cell">2016-01-26-43</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">25</td><td class="gchart-table-cell">90c5a34f06ac86aee0fd70e2adce7d8a</td><td class="gchart-table-cell google-visualization-table-td-number">1,343</td><td class="gchart-table-cell google-visualization-table-td-number">202</td><td class="gchart-table-cell google-visualization-table-td-number">55</td><td class="gchart-table-cell google-visualization-table-td-number">55</td><td class="gchart-table-cell">2016-01-26 07:00:27</td><td class="gchart-table-cell">2016-01-26-43</td></tr></tbody></table></div><div class="google-visualization-table-div-page gradient"><div class="charts-inline-block charts-custom-button charts-custom-button-disabled charts-custom-button-collapse-right" role="button" aria-disabled="true" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-prev"></span></div></div></div><div class="charts-inline-block charts-custom-button charts-custom-button-collapse-left" role="button" tabindex="0" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-next"></span></div></div></div></div><div style="clear: both; width: 100%; height: 0px;"></div></div></div>
    <br>(rows: 27288, time: 1.8s,     2MB processed, job: job_1uB6Q1t0SAl2meLLmnxftkuJrYY)<br>
    <script>
      require(['extensions/charting', 'element!4_146538680533', 'style!/static/extensions/charting.css'],
        function(charts, dom) {
          charts.render(dom,
            {
              chartStyle:"paged_table",
              dataName:"2",
              fields:"district_hash,tj_level1,tj_level2,tj_level3,tj_level4,tj_time,timeslot",
              totalRows:27288,
              rowsPerPage:25,
            }, {}, {"rows": [{"c": [{"v": "62afaf3288e236b389af9cfdc5206415"}, {"v": 2355}, {"v": 385}, {"v": 70}, {"v": 77}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "62afaf3288e236b389af9cfdc5206415"}, {"v": 2355}, {"v": 385}, {"v": 70}, {"v": 77}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "62afaf3288e236b389af9cfdc5206415"}, {"v": 2355}, {"v": 385}, {"v": 70}, {"v": 77}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "62afaf3288e236b389af9cfdc5206415"}, {"v": 2355}, {"v": 385}, {"v": 70}, {"v": 77}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "d4ec2125aff74eded207d2d915ef682f"}, {"v": 3738}, {"v": 705}, {"v": 194}, {"v": 131}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "d4ec2125aff74eded207d2d915ef682f"}, {"v": 3738}, {"v": 705}, {"v": 194}, {"v": 131}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "d4ec2125aff74eded207d2d915ef682f"}, {"v": 3738}, {"v": 705}, {"v": 194}, {"v": 131}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "d4ec2125aff74eded207d2d915ef682f"}, {"v": 3738}, {"v": 705}, {"v": 194}, {"v": 131}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "4725c39a5e5f4c188d382da3910b3f3f"}, {"v": 2737}, {"v": 573}, {"v": 193}, {"v": 128}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "4725c39a5e5f4c188d382da3910b3f3f"}, {"v": 2737}, {"v": 573}, {"v": 193}, {"v": 128}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "4725c39a5e5f4c188d382da3910b3f3f"}, {"v": 2737}, {"v": 573}, {"v": 193}, {"v": 128}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "4725c39a5e5f4c188d382da3910b3f3f"}, {"v": 2737}, {"v": 573}, {"v": 193}, {"v": 128}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "1afd7afbc81ecc1b13886a569d869e8a"}, {"v": 1249}, {"v": 255}, {"v": 67}, {"v": 64}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "1afd7afbc81ecc1b13886a569d869e8a"}, {"v": 1249}, {"v": 255}, {"v": 67}, {"v": 64}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "1afd7afbc81ecc1b13886a569d869e8a"}, {"v": 1249}, {"v": 255}, {"v": 67}, {"v": 64}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "1afd7afbc81ecc1b13886a569d869e8a"}, {"v": 1249}, {"v": 255}, {"v": 67}, {"v": 64}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "82cc4851f9e4faa4e54309f8bb73fd7c"}, {"v": 2534}, {"v": 338}, {"v": 119}, {"v": 95}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "82cc4851f9e4faa4e54309f8bb73fd7c"}, {"v": 2534}, {"v": 338}, {"v": 119}, {"v": 95}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "82cc4851f9e4faa4e54309f8bb73fd7c"}, {"v": 2534}, {"v": 338}, {"v": 119}, {"v": 95}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "82cc4851f9e4faa4e54309f8bb73fd7c"}, {"v": 2534}, {"v": 338}, {"v": 119}, {"v": 95}, {"v": "2016-01-26 07:00:26"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "b05379ac3f9b7d99370d443cfd5dcc28"}, {"v": 1554}, {"v": 256}, {"v": 66}, {"v": 64}, {"v": "2016-01-26 07:00:27"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "b05379ac3f9b7d99370d443cfd5dcc28"}, {"v": 1554}, {"v": 256}, {"v": 66}, {"v": 64}, {"v": "2016-01-26 07:00:27"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "b05379ac3f9b7d99370d443cfd5dcc28"}, {"v": 1554}, {"v": 256}, {"v": 66}, {"v": 64}, {"v": "2016-01-26 07:00:27"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "b05379ac3f9b7d99370d443cfd5dcc28"}, {"v": 1554}, {"v": 256}, {"v": 66}, {"v": 64}, {"v": "2016-01-26 07:00:27"}, {"v": "2016-01-26-43"}]}, {"c": [{"v": "90c5a34f06ac86aee0fd70e2adce7d8a"}, {"v": 1343}, {"v": 202}, {"v": 55}, {"v": 55}, {"v": "2016-01-26 07:00:27"}, {"v": "2016-01-26-43"}]}], "cols": [{"type": "string", "id": "district_hash", "label": "district_hash"}, {"type": "number", "id": "tj_level1", "label": "tj_level1"}, {"type": "number", "id": "tj_level2", "label": "tj_level2"}, {"type": "number", "id": "tj_level3", "label": "tj_level3"}, {"type": "number", "id": "tj_level4", "label": "tj_level4"}, {"type": "string", "id": "tj_time", "label": "tj_time"}, {"type": "string", "id": "timeslot", "label": "timeslot"}]});
        }
      );
    </script>
  </div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## POIs</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="POIs">POIs<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#POIs">¶</a></h2>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 894px; margin-bottom: -17px; border-right-width: 13px; min-height: 810px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>38</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp_test.pois'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">localpath</span> = <span class="cm-string">'season_1/test_set_1/poi_data/poi_data'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">pois</span> = []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">pois_schema</span> = [{<span class="cm-string">'name'</span>: <span class="cm-string">'district_hash'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>}]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">localpath</span>, <span class="cm-string">'rb'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">line_pois</span> = <span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: [<span class="cm-string">'f{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">':'</span>)[<span class="cm-number">0</span>].<span class="cm-variable">replace</span>(<span class="cm-string">'#'</span>, <span class="cm-string">'_'</span>)), <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">':'</span>)[<span class="cm-number">1</span>]],</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      <span class="cm-variable">line</span>.<span class="cm-variable">split</span>(<span class="cm-string">'\t'</span>)[<span class="cm-number">1</span>:])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">poi</span> <span class="cm-keyword">in</span> <span class="cm-variable">line_pois</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">if</span> <span class="cm-variable">poi</span>[<span class="cm-number">0</span>] <span class="cm-keyword">not</span> <span class="cm-keyword">in</span> <span class="cm-variable">pois</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">pois</span>.<span class="cm-variable">append</span>(<span class="cm-variable">poi</span>[<span class="cm-number">0</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">pois_schema</span>.<span class="cm-variable">append</span>({<span class="cm-string">'name'</span>: <span class="cm-variable">poi</span>[<span class="cm-number">0</span>], <span class="cm-string">'type'</span>: <span class="cm-string">'INTEGER'</span>})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">pois</span>.<span class="cm-variable">sort</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">pois_schema</span> = <span class="cm-builtin">sorted</span>(<span class="cm-variable">pois_schema</span>, <span class="cm-variable">key</span>=<span class="cm-keyword">lambda</span> <span class="cm-variable">k</span>: <span class="cm-variable">k</span>[<span class="cm-string">'name'</span>]) </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>.<span class="cm-variable">from_data</span>(<span class="cm-variable">pois_schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">pois_data</span> = <span class="cm-variable">pd</span>.<span class="cm-variable">DataFrame</span>(<span class="cm-variable">columns</span>=[<span class="cm-string">'district_hash'</span>] <span class="cm-operator">+</span> <span class="cm-variable">pois</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">localpath</span>, <span class="cm-string">'rb'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">f</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">hash_pois</span> = {}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">for</span> <span class="cm-variable">poi_line</span> <span class="cm-keyword">in</span> <span class="cm-variable">line</span>.<span class="cm-variable">split</span>(<span class="cm-string">'\t'</span>)[<span class="cm-number">1</span>:]:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">hash_pois</span>[<span class="cm-string">'f{}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">poi_line</span>.<span class="cm-variable">split</span>(<span class="cm-string">':'</span>)[<span class="cm-number">0</span>].<span class="cm-variable">replace</span>(<span class="cm-string">'#'</span>, <span class="cm-string">'_'</span>))] = <span class="cm-variable">poi_line</span>.<span class="cm-variable">split</span>(<span class="cm-string">':'</span>)[<span class="cm-number">1</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">poi_data</span> = [<span class="cm-variable">line</span>.<span class="cm-variable">split</span>(<span class="cm-string">'\t'</span>)[<span class="cm-number">0</span>]]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment"># hash_pois = {f1_1: 15, ...}</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment"># pois = ['f1_1', ...]</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">for</span> <span class="cm-variable">poi</span> <span class="cm-keyword">in</span> <span class="cm-variable">pois</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">value</span> = <span class="cm-string">'0'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">poi</span> <span class="cm-keyword">in</span> <span class="cm-variable">hash_pois</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-variable">value</span> = <span class="cm-variable">hash_pois</span>[<span class="cm-variable">poi</span>].<span class="cm-variable">strip</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">poi_data</span>.<span class="cm-variable">append</span>(<span class="cm-variable">value</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">pois_data</span>.<span class="cm-variable">loc</span>[<span class="cm-builtin">len</span>(<span class="cm-variable">pois_data</span>)] = <span class="cm-variable">poi_data</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">poi</span> <span class="cm-keyword">in</span> <span class="cm-variable">pois</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">pois_data</span>[<span class="cm-variable">poi</span>] = <span class="cm-variable">pd</span>.<span class="cm-variable">to_numeric</span>(<span class="cm-variable">pois_data</span>[<span class="cm-variable">poi</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">insert_data</span>(<span class="cm-variable">pois_data</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 810px;"></div><div class="CodeMirror-gutters" style="height: 823px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Orders</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Orders">Orders<a class="anchor-link" href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#Orders">¶</a></h2>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 651px; margin-bottom: -17px; border-right-width: 13px; min-height: 348px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>16</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">table</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Table</span>(<span class="cm-string">'datalab-projects-1331:xjk_algo_comp_test.orders'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">table</span>.<span class="cm-variable">exists</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">schema</span> = <span class="cm-variable">bq</span>.<span class="cm-variable">Schema</span>([{<span class="cm-string">'name'</span>: <span class="cm-string">'order_id'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      {<span class="cm-string">'name'</span>: <span class="cm-string">'driver_id'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      {<span class="cm-string">'name'</span>: <span class="cm-string">'passenger_id'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      {<span class="cm-string">'name'</span>: <span class="cm-string">'start_district_hash'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      {<span class="cm-string">'name'</span>: <span class="cm-string">'dest_district_hash'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      {<span class="cm-string">'name'</span>: <span class="cm-string">'price'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'FLOAT'</span>},</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                      {<span class="cm-string">'name'</span>: <span class="cm-string">'time'</span>, <span class="cm-string">'type'</span>: <span class="cm-string">'STRING'</span>}])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">table</span>.<span class="cm-variable">create</span>(<span class="cm-variable">schema</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">wildpath</span> = <span class="cm-string">'season_1/test_set_1/order_data/*'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">localpath</span> <span class="cm-keyword">in</span> <span class="cm-variable">glob</span>.<span class="cm-variable">glob</span>(<span class="cm-variable">wildpath</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">print</span> <span class="cm-string">'loading {}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">localpath</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">storagepath</span> = <span class="cm-variable">os</span>.<span class="cm-variable">path</span>.<span class="cm-variable">join</span>(<span class="cm-variable">bucket_path</span>,<span class="cm-variable">localpath</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">process_datafile</span>(<span class="cm-variable">localpath</span>, <span class="cm-variable">storagepath</span>, <span class="cm-variable">table</span>, <span class="cm-variable">mode</span>=<span class="cm-string">'append'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 348px;"></div><div class="CodeMirror-gutters" style="height: 361px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 894px; margin-bottom: -17px; border-right-width: 13px; min-height: 747px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>35</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-magic">%%bigquery udf -m orders_create_additional_fields</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Pad with 0 or given string.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int n Number to add padding to.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param int width Width of number + padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param string z (Optional) Other string to replace '0' as padding.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-variable">pad</span>(<span class="cm-def">n</span>, <span class="cm-def">width</span>, <span class="cm-def">z</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">z</span> <span class="cm-operator">=</span> <span class="cm-variable-2">z</span> <span class="cm-operator">||</span> <span class="cm-string">'0'</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">n</span> <span class="cm-operator">=</span> <span class="cm-variable-2">n</span> <span class="cm-operator">+</span> <span class="cm-string">''</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable-2">width</span> <span class="cm-operator">?</span> <span class="cm-variable-2">n</span> : <span class="cm-keyword">new</span> <span class="cm-variable">Array</span>(<span class="cm-variable-2">width</span> <span class="cm-operator">-</span> <span class="cm-variable-2">n</span>.<span class="cm-property">length</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>).<span class="cm-property">join</span>(<span class="cm-variable-2">z</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">n</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * Create additional fields on orders table for gaps table creation.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> *</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param {{order_id: string, driver_id: string, passenger_id: string,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">            start_district_hash: string, dest_district_hash: string, price: float,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">            time: string}} r</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> * @param function({{order_id: string, driver_id: string, passenger_id: string,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     start_district_hash: string, dest_district_hash: string, price: float,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     time: string, timeslot: string, timeofday_slot: integer, day_in_week: integer,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">                     date: string}}) emitFn</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"> */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span>(<span class="cm-def">r</span>, <span class="cm-def">emitFn</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">t</span> <span class="cm-operator">=</span> <span class="cm-variable-2">r</span>.<span class="cm-property">time</span>.<span class="cm-property">split</span>(<span class="cm-string-2">/[ :\-]/</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">slot</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">floor</span>((<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">3</span>]) <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">+</span> <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">4</span>])) <span class="cm-operator">/</span> <span class="cm-number">10</span>) <span class="cm-operator">+</span> <span class="cm-number">1</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeslot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">               <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">slot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">timeofday_slot</span> <span class="cm-operator">=</span> <span class="cm-variable-2">slot</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">date</span> <span class="cm-operator">=</span> <span class="cm-variable-2">t</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>], <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">'-'</span> <span class="cm-operator">+</span> <span class="cm-variable">pad</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>], <span class="cm-number">2</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">r</span>.<span class="cm-property">day_in_week</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Date</span>(<span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">0</span>]), <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">1</span>])<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">parseInt</span>(<span class="cm-variable-2">t</span>[<span class="cm-number">2</span>])).<span class="cm-property">getDay</span>();</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable-2">emitFn</span>(<span class="cm-variable-2">r</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 747px;"></div><div class="CodeMirror-gutters" style="height: 760px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered completed" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 804px; margin-bottom: -17px; border-right-width: 13px; min-height: 117px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%%</span><span class="cm-variable">bigquery</span> <span class="cm-variable">execute</span> <span class="cm-operator">-</span><span class="cm-variable">t</span> <span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp_test</span>.<span class="cm-variable">orders</span> <span class="cm-operator">-</span><span class="cm-variable">m</span> <span class="cm-variable">overwrite</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SELECT</span> <span class="cm-variable">order_id</span>, <span class="cm-variable">driver_id</span>, <span class="cm-variable">passenger_id</span>, <span class="cm-variable">start_district_hash</span>, <span class="cm-variable">dest_district_hash</span>, <span class="cm-variable">price</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">time</span>, <span class="cm-variable">timeslot</span>, <span class="cm-variable">timeofday_slot</span>, <span class="cm-variable">date</span>, <span class="cm-variable">day_in_week</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FROM</span> <span class="cm-variable">orders_create_additional_fields</span>([<span class="cm-variable">datalab</span><span class="cm-operator">-</span><span class="cm-variable">projects</span><span class="cm-operator">-</span><span class="cm-number">1331</span>:<span class="cm-variable">xjk_algo_comp_test</span>.<span class="cm-variable">orders</span>])</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 117px;"></div><div class="CodeMirror-gutters" style="height: 130px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: block;"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[3]:</div><div class="output_subarea output_html rendered_html output_result">
    <div class="bqtv" id="1_146549387419"><div class="google-visualization-table" style="position: relative; z-index: 0; max-width: 100%; max-height: 100%;"><div style="position: relative; overflow: auto; max-width: 100%; max-height: 100%;"><table class="google-visualization-table-table" cellspacing="0"><thead><tr class="gchart-table-headerrow"><th class="gchart-table-headercell">&nbsp;</th><th class="gchart-table-headercell">order_id</th><th class="gchart-table-headercell">driver_id</th><th class="gchart-table-headercell">passenger_id</th><th class="gchart-table-headercell">start_district_hash</th><th class="gchart-table-headercell">dest_district_hash</th><th class="gchart-table-headercell">price</th><th class="gchart-table-headercell">time</th><th class="gchart-table-headercell">timeslot</th><th class="gchart-table-headercell">timeofday_slot</th><th class="gchart-table-headercell">date</th><th class="gchart-table-headercell">day_in_week</th></tr></thead><tbody><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">1</td><td class="gchart-table-cell">3d68aa9d021dfbf070e56cec54c46c11</td><td class="gchart-table-cell">1174042ae988e200295e54ef39f43b0d</td><td class="gchart-table-cell">87e50acb153606c26aa7ed2dc5f4c533</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-26 21:28:52</td><td class="gchart-table-cell">2016-01-26-129</td><td class="gchart-table-cell google-visualization-table-td-number">129</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">2</td><td class="gchart-table-cell">b6870dc99102e5a35887641f2dd57b71</td><td class="gchart-table-cell">6155afae0e14fb616a5a75318f22c56f</td><td class="gchart-table-cell">9797a692951c7d79e9330020a09f4273</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-26 07:23:28</td><td class="gchart-table-cell">2016-01-26-45</td><td class="gchart-table-cell google-visualization-table-td-number">45</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">3</td><td class="gchart-table-cell">6b8cca23b24af32477711c3993280394</td><td class="gchart-table-cell">1174042ae988e200295e54ef39f43b0d</td><td class="gchart-table-cell">59babb03945acac06b73c1977f2a69aa</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-26 21:19:34</td><td class="gchart-table-cell">2016-01-26-128</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">4</td><td class="gchart-table-cell">dcf6c7228a5b21c40adbd9f55fb2aa04</td><td class="gchart-table-cell">NULL</td><td class="gchart-table-cell">6ded06900eaa1c219cdebe9efbb4a6f8</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">cb6041cc08444746caf6039d8b9e43cb</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-26 09:15:05</td><td class="gchart-table-cell">2016-01-26-56</td><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">5</td><td class="gchart-table-cell">9b8c9a93a23b571ae58e5d8ebfcb6545</td><td class="gchart-table-cell">5386562275ede161220b4ae77edd7775</td><td class="gchart-table-cell">6ded06900eaa1c219cdebe9efbb4a6f8</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">cb6041cc08444746caf6039d8b9e43cb</td><td class="gchart-table-cell google-visualization-table-td-number">7</td><td class="gchart-table-cell">2016-01-26 09:15:05</td><td class="gchart-table-cell">2016-01-26-56</td><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">6</td><td class="gchart-table-cell">62b8a079d1e586c74c855bdc4bf4df27</td><td class="gchart-table-cell">1da7ee1e7523e9d934262bb9b3d5aee9</td><td class="gchart-table-cell">0813031bac24a031efebec8d7d94ddde</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell">2016-01-26 15:04:28</td><td class="gchart-table-cell">2016-01-26-91</td><td class="gchart-table-cell google-visualization-table-td-number">91</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">7</td><td class="gchart-table-cell">f59d4a95b041ac0043b61ae06cb23d64</td><td class="gchart-table-cell">NULL</td><td class="gchart-table-cell">0813031bac24a031efebec8d7d94ddde</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell">2016-01-26 15:04:28</td><td class="gchart-table-cell">2016-01-26-91</td><td class="gchart-table-cell google-visualization-table-td-number">91</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">8</td><td class="gchart-table-cell">4a10d50755e5a1ece9a6906fe5d3cf56</td><td class="gchart-table-cell">1174042ae988e200295e54ef39f43b0d</td><td class="gchart-table-cell">0813031bac24a031efebec8d7d94ddde</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">8</td><td class="gchart-table-cell">2016-01-26 15:18:25</td><td class="gchart-table-cell">2016-01-26-92</td><td class="gchart-table-cell google-visualization-table-td-number">92</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">9</td><td class="gchart-table-cell">0d73b62e3e4c06210cd2cf4034b75baa</td><td class="gchart-table-cell">d241c8d4d54d1e30adba236a118767f2</td><td class="gchart-table-cell">eb8da663eb7f6c3b78f198b54f08c0a0</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell google-visualization-table-td-number">9</td><td class="gchart-table-cell">2016-01-26 19:06:39</td><td class="gchart-table-cell">2016-01-26-115</td><td class="gchart-table-cell google-visualization-table-td-number">115</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">10</td><td class="gchart-table-cell">968884d836ad4948582e511bd2ec9765</td><td class="gchart-table-cell">d5e50828ccd280ce9d42200552f44648</td><td class="gchart-table-cell">18c9179145d22516315fe211b4a3556a</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">0a4408280f103ae7fad4065de88d049e</td><td class="gchart-table-cell google-visualization-table-td-number">10</td><td class="gchart-table-cell">2016-01-26 15:26:18</td><td class="gchart-table-cell">2016-01-26-93</td><td class="gchart-table-cell google-visualization-table-td-number">93</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">11</td><td class="gchart-table-cell">4ba5e262e921ca46aaf70f12efe90934</td><td class="gchart-table-cell">e7ea7e22c525161d1b2e4bd17df1f73e</td><td class="gchart-table-cell">56018323b921dd2c5444f98fb45509de</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3e12208dd0be281c92a6ab57d9a6fb32</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell">2016-01-26 21:16:06</td><td class="gchart-table-cell">2016-01-26-128</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">12</td><td class="gchart-table-cell">ca44a219c429dfd899c500919d37b0a4</td><td class="gchart-table-cell">0dbef77f3120fa3e3185b73dd817ebd7</td><td class="gchart-table-cell">6e451bcf8da235e6709a2989781c4ec4</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">52d7b69796362a8ed1691a6cc02ddde4</td><td class="gchart-table-cell google-visualization-table-td-number">12</td><td class="gchart-table-cell">2016-01-26 17:04:00</td><td class="gchart-table-cell">2016-01-26-103</td><td class="gchart-table-cell google-visualization-table-td-number">103</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">13</td><td class="gchart-table-cell">176e7ac4216aacf9159331e8bc65c670</td><td class="gchart-table-cell">19a19f1a1f21c9c53bdabfbe615f2aa6</td><td class="gchart-table-cell">298ef85c696035277cefe05a3cfebfa9</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3528a3093d9166b20436940c5cb3d2f4</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell">2016-01-26 11:28:39</td><td class="gchart-table-cell">2016-01-26-69</td><td class="gchart-table-cell google-visualization-table-td-number">69</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">14</td><td class="gchart-table-cell">66f8620fa14b9449b41d11268e232f76</td><td class="gchart-table-cell">7c1785c6f45afd95904a6f7048dbc422</td><td class="gchart-table-cell">56018323b921dd2c5444f98fb45509de</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3e12208dd0be281c92a6ab57d9a6fb32</td><td class="gchart-table-cell google-visualization-table-td-number">13</td><td class="gchart-table-cell">2016-01-26 09:15:23</td><td class="gchart-table-cell">2016-01-26-56</td><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">15</td><td class="gchart-table-cell">f833baefb8c58b4b09a6b2a8582f17bf</td><td class="gchart-table-cell">2fafcde76612a4be06a49c76f8c13226</td><td class="gchart-table-cell">f0c20a91742d12f73e28cda7cb98760e</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3e12208dd0be281c92a6ab57d9a6fb32</td><td class="gchart-table-cell google-visualization-table-td-number">15</td><td class="gchart-table-cell">2016-01-26 11:13:20</td><td class="gchart-table-cell">2016-01-26-68</td><td class="gchart-table-cell google-visualization-table-td-number">68</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">16</td><td class="gchart-table-cell">92304a6a3435384ea12ad383ff459f0c</td><td class="gchart-table-cell">NULL</td><td class="gchart-table-cell">298ef85c696035277cefe05a3cfebfa9</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3528a3093d9166b20436940c5cb3d2f4</td><td class="gchart-table-cell google-visualization-table-td-number">16</td><td class="gchart-table-cell">2016-01-26 11:13:52</td><td class="gchart-table-cell">2016-01-26-68</td><td class="gchart-table-cell google-visualization-table-td-number">68</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">17</td><td class="gchart-table-cell">680a120b644d394c49a91123c84ab960</td><td class="gchart-table-cell">NULL</td><td class="gchart-table-cell">298ef85c696035277cefe05a3cfebfa9</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3528a3093d9166b20436940c5cb3d2f4</td><td class="gchart-table-cell google-visualization-table-td-number">17</td><td class="gchart-table-cell">2016-01-26 11:16:26</td><td class="gchart-table-cell">2016-01-26-68</td><td class="gchart-table-cell google-visualization-table-td-number">68</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">18</td><td class="gchart-table-cell">1d323c7f1a6a45432ba1d42c74624996</td><td class="gchart-table-cell">4acac203d9e16ffcae14af4109f03aea</td><td class="gchart-table-cell">0f1a8c25a3b8cbba838b7fd8ddc2927a</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">cb6041cc08444746caf6039d8b9e43cb</td><td class="gchart-table-cell google-visualization-table-td-number">17</td><td class="gchart-table-cell">2016-01-26 21:13:45</td><td class="gchart-table-cell">2016-01-26-128</td><td class="gchart-table-cell google-visualization-table-td-number">128</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">19</td><td class="gchart-table-cell">c304a74c93e5333df108dcd9838289a1</td><td class="gchart-table-cell">14affe840571d7f6efeeafb124e0e7d4</td><td class="gchart-table-cell">c8753295b7be0567c67e00ee5adb154b</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">38d5ad2d22b61109fd8e7b43cd0e8901</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell">2016-01-26 17:09:25</td><td class="gchart-table-cell">2016-01-26-103</td><td class="gchart-table-cell google-visualization-table-td-number">103</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">20</td><td class="gchart-table-cell">95dbd100e051ae026da040b26217731d</td><td class="gchart-table-cell">7bcf2f1415f8e14d3be7e430dd34b082</td><td class="gchart-table-cell">bbe927e10e01b9078bb5703da273ef12</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">d4ec2125aff74eded207d2d915ef682f</td><td class="gchart-table-cell google-visualization-table-td-number">18</td><td class="gchart-table-cell">2016-01-26 11:18:33</td><td class="gchart-table-cell">2016-01-26-68</td><td class="gchart-table-cell google-visualization-table-td-number">68</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">21</td><td class="gchart-table-cell">bbad25e586b6b90ee80fff92dc30d3a2</td><td class="gchart-table-cell">NULL</td><td class="gchart-table-cell">f6d20c100ed3dd737bc5921090440b30</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">52d7b69796362a8ed1691a6cc02ddde4</td><td class="gchart-table-cell google-visualization-table-td-number">19</td><td class="gchart-table-cell">2016-01-26 19:08:36</td><td class="gchart-table-cell">2016-01-26-115</td><td class="gchart-table-cell google-visualization-table-td-number">115</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">22</td><td class="gchart-table-cell">8196fa08afdf43a8788d08784444c382</td><td class="gchart-table-cell">7edd19f651d86ba85bbdd4002c2325b5</td><td class="gchart-table-cell">56018323b921dd2c5444f98fb45509de</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">52d7b69796362a8ed1691a6cc02ddde4</td><td class="gchart-table-cell google-visualization-table-td-number">20</td><td class="gchart-table-cell">2016-01-26 19:06:40</td><td class="gchart-table-cell">2016-01-26-115</td><td class="gchart-table-cell google-visualization-table-td-number">115</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">23</td><td class="gchart-table-cell">47dfe051b96b9412e20e03c6ffc7bbc4</td><td class="gchart-table-cell">6ebd393f352c145ac91a1a5a2dd7fe4a</td><td class="gchart-table-cell">b5f4b04cc910b1c90e7f55111c9657b3</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">a01d1425bf21f16edc6055817badd907</td><td class="gchart-table-cell google-visualization-table-td-number">21</td><td class="gchart-table-cell">2016-01-26 13:27:12</td><td class="gchart-table-cell">2016-01-26-81</td><td class="gchart-table-cell google-visualization-table-td-number">81</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-oddrow"><td class="gchart-table-cell gchart-table-rownumcell">24</td><td class="gchart-table-cell">773950d614c0a849f9db516ee7d457fd</td><td class="gchart-table-cell">87c5fa1a4614785b833efde1055a92fc</td><td class="gchart-table-cell">6d29c25f0c662a9515d82706d21faf3a</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">3e12208dd0be281c92a6ab57d9a6fb32</td><td class="gchart-table-cell google-visualization-table-td-number">22</td><td class="gchart-table-cell">2016-01-26 09:19:40</td><td class="gchart-table-cell">2016-01-26-56</td><td class="gchart-table-cell google-visualization-table-td-number">56</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr><tr class="gchart-table-row"><td class="gchart-table-cell gchart-table-rownumcell">25</td><td class="gchart-table-cell">7a4ce3873a323d761038060a8f31ff4f</td><td class="gchart-table-cell">a4e64e5e546dfc391fd6388ea9f8442d</td><td class="gchart-table-cell">4c0c443def0bcd640b9126830dccb744</td><td class="gchart-table-cell">08232402614a9b48895cc3d0aeb0e9f2</td><td class="gchart-table-cell">cb6041cc08444746caf6039d8b9e43cb</td><td class="gchart-table-cell google-visualization-table-td-number">22</td><td class="gchart-table-cell">2016-01-26 23:23:41</td><td class="gchart-table-cell">2016-01-26-141</td><td class="gchart-table-cell google-visualization-table-td-number">141</td><td class="gchart-table-cell">2016-01-26</td><td class="gchart-table-cell google-visualization-table-td-number">2</td></tr></tbody></table></div><div class="google-visualization-table-div-page gradient"><div class="charts-inline-block charts-custom-button charts-custom-button-disabled charts-custom-button-collapse-right" role="button" aria-disabled="true" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-prev"></span></div></div></div><div class="charts-inline-block charts-custom-button charts-custom-button-collapse-left" role="button" tabindex="0" style="-webkit-user-select: none;"><div class="charts-inline-block charts-custom-button-outer-box"><div class="charts-inline-block charts-custom-button-inner-box"><span class="google-visualization-table-page-next"></span></div></div></div></div><div style="clear: both; width: 100%; height: 0px;"></div></div></div>
    <br>(rows: 557985, time: 30.5s,   107MB processed, job: job_8DFAu3sNmBfhKzPXu9vn_aWkMBY)<br>
    <script>
      require(['extensions/charting', 'element!1_146549387419', 'style!/static/extensions/charting.css'],
        function(charts, dom) {
          charts.render(dom,
            {
              chartStyle:"paged_table",
              dataName:"0",
              fields:"order_id,driver_id,passenger_id,start_district_hash,dest_district_hash,price,time,timeslot,timeofday_slot,date,day_in_week",
              totalRows:557985,
              rowsPerPage:25,
            }, {}, {"rows": [{"c": [{"v": "3d68aa9d021dfbf070e56cec54c46c11"}, {"v": "1174042ae988e200295e54ef39f43b0d"}, {"v": "87e50acb153606c26aa7ed2dc5f4c533"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 7.0}, {"v": "2016-01-26 21:28:52"}, {"v": "2016-01-26-129"}, {"v": 129}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "b6870dc99102e5a35887641f2dd57b71"}, {"v": "6155afae0e14fb616a5a75318f22c56f"}, {"v": "9797a692951c7d79e9330020a09f4273"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 7.0}, {"v": "2016-01-26 07:23:28"}, {"v": "2016-01-26-45"}, {"v": 45}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "6b8cca23b24af32477711c3993280394"}, {"v": "1174042ae988e200295e54ef39f43b0d"}, {"v": "59babb03945acac06b73c1977f2a69aa"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 7.0}, {"v": "2016-01-26 21:19:34"}, {"v": "2016-01-26-128"}, {"v": 128}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "dcf6c7228a5b21c40adbd9f55fb2aa04"}, {"v": "NULL"}, {"v": "6ded06900eaa1c219cdebe9efbb4a6f8"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "cb6041cc08444746caf6039d8b9e43cb"}, {"v": 7.0}, {"v": "2016-01-26 09:15:05"}, {"v": "2016-01-26-56"}, {"v": 56}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "9b8c9a93a23b571ae58e5d8ebfcb6545"}, {"v": "5386562275ede161220b4ae77edd7775"}, {"v": "6ded06900eaa1c219cdebe9efbb4a6f8"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "cb6041cc08444746caf6039d8b9e43cb"}, {"v": 7.0}, {"v": "2016-01-26 09:15:05"}, {"v": "2016-01-26-56"}, {"v": 56}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "62b8a079d1e586c74c855bdc4bf4df27"}, {"v": "1da7ee1e7523e9d934262bb9b3d5aee9"}, {"v": "0813031bac24a031efebec8d7d94ddde"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 8.0}, {"v": "2016-01-26 15:04:28"}, {"v": "2016-01-26-91"}, {"v": 91}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "f59d4a95b041ac0043b61ae06cb23d64"}, {"v": "NULL"}, {"v": "0813031bac24a031efebec8d7d94ddde"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 8.0}, {"v": "2016-01-26 15:04:28"}, {"v": "2016-01-26-91"}, {"v": 91}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "4a10d50755e5a1ece9a6906fe5d3cf56"}, {"v": "1174042ae988e200295e54ef39f43b0d"}, {"v": "0813031bac24a031efebec8d7d94ddde"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 8.0}, {"v": "2016-01-26 15:18:25"}, {"v": "2016-01-26-92"}, {"v": 92}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "0d73b62e3e4c06210cd2cf4034b75baa"}, {"v": "d241c8d4d54d1e30adba236a118767f2"}, {"v": "eb8da663eb7f6c3b78f198b54f08c0a0"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": 9.0}, {"v": "2016-01-26 19:06:39"}, {"v": "2016-01-26-115"}, {"v": 115}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "968884d836ad4948582e511bd2ec9765"}, {"v": "d5e50828ccd280ce9d42200552f44648"}, {"v": "18c9179145d22516315fe211b4a3556a"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "0a4408280f103ae7fad4065de88d049e"}, {"v": 10.0}, {"v": "2016-01-26 15:26:18"}, {"v": "2016-01-26-93"}, {"v": 93}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "4ba5e262e921ca46aaf70f12efe90934"}, {"v": "e7ea7e22c525161d1b2e4bd17df1f73e"}, {"v": "56018323b921dd2c5444f98fb45509de"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3e12208dd0be281c92a6ab57d9a6fb32"}, {"v": 12.0}, {"v": "2016-01-26 21:16:06"}, {"v": "2016-01-26-128"}, {"v": 128}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "ca44a219c429dfd899c500919d37b0a4"}, {"v": "0dbef77f3120fa3e3185b73dd817ebd7"}, {"v": "6e451bcf8da235e6709a2989781c4ec4"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "52d7b69796362a8ed1691a6cc02ddde4"}, {"v": 12.0}, {"v": "2016-01-26 17:04:00"}, {"v": "2016-01-26-103"}, {"v": 103}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "176e7ac4216aacf9159331e8bc65c670"}, {"v": "19a19f1a1f21c9c53bdabfbe615f2aa6"}, {"v": "298ef85c696035277cefe05a3cfebfa9"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3528a3093d9166b20436940c5cb3d2f4"}, {"v": 13.0}, {"v": "2016-01-26 11:28:39"}, {"v": "2016-01-26-69"}, {"v": 69}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "66f8620fa14b9449b41d11268e232f76"}, {"v": "7c1785c6f45afd95904a6f7048dbc422"}, {"v": "56018323b921dd2c5444f98fb45509de"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3e12208dd0be281c92a6ab57d9a6fb32"}, {"v": 13.0}, {"v": "2016-01-26 09:15:23"}, {"v": "2016-01-26-56"}, {"v": 56}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "f833baefb8c58b4b09a6b2a8582f17bf"}, {"v": "2fafcde76612a4be06a49c76f8c13226"}, {"v": "f0c20a91742d12f73e28cda7cb98760e"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3e12208dd0be281c92a6ab57d9a6fb32"}, {"v": 15.0}, {"v": "2016-01-26 11:13:20"}, {"v": "2016-01-26-68"}, {"v": 68}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "92304a6a3435384ea12ad383ff459f0c"}, {"v": "NULL"}, {"v": "298ef85c696035277cefe05a3cfebfa9"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3528a3093d9166b20436940c5cb3d2f4"}, {"v": 16.0}, {"v": "2016-01-26 11:13:52"}, {"v": "2016-01-26-68"}, {"v": 68}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "680a120b644d394c49a91123c84ab960"}, {"v": "NULL"}, {"v": "298ef85c696035277cefe05a3cfebfa9"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3528a3093d9166b20436940c5cb3d2f4"}, {"v": 17.0}, {"v": "2016-01-26 11:16:26"}, {"v": "2016-01-26-68"}, {"v": 68}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "1d323c7f1a6a45432ba1d42c74624996"}, {"v": "4acac203d9e16ffcae14af4109f03aea"}, {"v": "0f1a8c25a3b8cbba838b7fd8ddc2927a"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "cb6041cc08444746caf6039d8b9e43cb"}, {"v": 17.0}, {"v": "2016-01-26 21:13:45"}, {"v": "2016-01-26-128"}, {"v": 128}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "c304a74c93e5333df108dcd9838289a1"}, {"v": "14affe840571d7f6efeeafb124e0e7d4"}, {"v": "c8753295b7be0567c67e00ee5adb154b"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "38d5ad2d22b61109fd8e7b43cd0e8901"}, {"v": 18.0}, {"v": "2016-01-26 17:09:25"}, {"v": "2016-01-26-103"}, {"v": 103}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "95dbd100e051ae026da040b26217731d"}, {"v": "7bcf2f1415f8e14d3be7e430dd34b082"}, {"v": "bbe927e10e01b9078bb5703da273ef12"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "d4ec2125aff74eded207d2d915ef682f"}, {"v": 18.0}, {"v": "2016-01-26 11:18:33"}, {"v": "2016-01-26-68"}, {"v": 68}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "bbad25e586b6b90ee80fff92dc30d3a2"}, {"v": "NULL"}, {"v": "f6d20c100ed3dd737bc5921090440b30"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "52d7b69796362a8ed1691a6cc02ddde4"}, {"v": 19.0}, {"v": "2016-01-26 19:08:36"}, {"v": "2016-01-26-115"}, {"v": 115}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "8196fa08afdf43a8788d08784444c382"}, {"v": "7edd19f651d86ba85bbdd4002c2325b5"}, {"v": "56018323b921dd2c5444f98fb45509de"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "52d7b69796362a8ed1691a6cc02ddde4"}, {"v": 20.0}, {"v": "2016-01-26 19:06:40"}, {"v": "2016-01-26-115"}, {"v": 115}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "47dfe051b96b9412e20e03c6ffc7bbc4"}, {"v": "6ebd393f352c145ac91a1a5a2dd7fe4a"}, {"v": "b5f4b04cc910b1c90e7f55111c9657b3"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "a01d1425bf21f16edc6055817badd907"}, {"v": 21.0}, {"v": "2016-01-26 13:27:12"}, {"v": "2016-01-26-81"}, {"v": 81}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "773950d614c0a849f9db516ee7d457fd"}, {"v": "87c5fa1a4614785b833efde1055a92fc"}, {"v": "6d29c25f0c662a9515d82706d21faf3a"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "3e12208dd0be281c92a6ab57d9a6fb32"}, {"v": 22.0}, {"v": "2016-01-26 09:19:40"}, {"v": "2016-01-26-56"}, {"v": 56}, {"v": "2016-01-26"}, {"v": 2}]}, {"c": [{"v": "7a4ce3873a323d761038060a8f31ff4f"}, {"v": "a4e64e5e546dfc391fd6388ea9f8442d"}, {"v": "4c0c443def0bcd640b9126830dccb744"}, {"v": "08232402614a9b48895cc3d0aeb0e9f2"}, {"v": "cb6041cc08444746caf6039d8b9e43cb"}, {"v": 22.0}, {"v": "2016-01-26 23:23:41"}, {"v": "2016-01-26-141"}, {"v": 141}, {"v": "2016-01-26"}, {"v": 2}]}], "cols": [{"type": "string", "id": "order_id", "label": "order_id"}, {"type": "string", "id": "driver_id", "label": "driver_id"}, {"type": "string", "id": "passenger_id", "label": "passenger_id"}, {"type": "string", "id": "start_district_hash", "label": "start_district_hash"}, {"type": "string", "id": "dest_district_hash", "label": "dest_district_hash"}, {"type": "number", "id": "price", "label": "price"}, {"type": "string", "id": "time", "label": "time"}, {"type": "string", "id": "timeslot", "label": "timeslot"}, {"type": "number", "id": "timeofday_slot", "label": "timeofday_slot"}, {"type": "string", "id": "date", "label": "date"}, {"type": "number", "id": "day_in_week", "label": "day_in_week"}]});
        }
      );
    </script>
  </div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 6px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 34px; min-width: 3px; margin-bottom: -17px; border-right-width: 13px; min-height: 33px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -34px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; top: 33px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 33px;"></div></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
              <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
            </div>
          </div>
        </div>
      </div>
      <div id="sidebarArea">
        <div id="sidebarToolbar">
          <div class="btn-toolbar pull-left">
            <div class="btn-group">
              <button id="toggleSidebarButton" type="button" class="btn" title="Toggle the size of the sidebar">
                <span class="fa fa-chevron-right fa-flip-horizontal"></span>
              </button>
            </div>
            <div class="btn-group">
              <button id="navigationButton" type="button" class="btn">Navigation</button>
              <button id="helpButton" type="button" class="btn active">Help</button>
            </div>
          </div>
        </div>
        <div id="sidebarContent">
          <div id="navigation" style="display: none"><div><b>Notebook Outline</b></div><br><div><a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" cellindex="3">Process Test Data</a></div><div>&nbsp;&nbsp;&nbsp;<a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" cellindex="4">Districts</a></div><div>&nbsp;&nbsp;&nbsp;<a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" cellindex="6">Weather</a></div><div>&nbsp;&nbsp;&nbsp;<a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" cellindex="10">Traffic</a></div><div>&nbsp;&nbsp;&nbsp;<a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" cellindex="14">POIs</a></div><div>&nbsp;&nbsp;&nbsp;<a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/Xiaojukeji%20Algorithm%20Competition/1.b.%20Export%20to%20Google%20BigQuery%20-%20test%20data.ipynb#" cellindex="16">Orders</a></div></div>
          <div id="help">
            <p><b>Help for Python APIs</b></p>
            <p>
              You can enter <code>class?</code> or <code>member?</code> within a code cell in the
              notebook to get help on a Python API.
            </p>
            <br>
            <p>
              For example, try <code>str?</code> to get help information on the built-in Python
              method to convert a value to its string representation.
            </p>
            <br>
            <p>
              Additional help topics and links are also available from the menu off the Help
              icon on the top of the page.
            </p>
            <br>
            <p><b>Docs and Samples</b></p>
            <p>
              The <a href="https://main-dot-datalab-dot-datalab-projects-1331.appspot.com/notebooks/datalab/Readme.ipynb" target"_blank"="">Cloud Datalab Guide</a> featuring
              documentation and sample notebooks is also a great way to check out how you can use Cloud Datalab.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="./1.b. Export to Google BigQuery - test data_files/promise.min.js"></script>
  <script src="./1.b. Export to Google BigQuery - test data_files/socket.io.js"></script>
  <script src="./1.b. Export to Google BigQuery - test data_files/require.js"></script>
  <script>
    window.mathjax_url = '';
    window.sys_info = {};
    require.config({
      baseUrl: '/static/',
      paths: {
        'auth/js/main': 'auth/js/main.min',
        custom : '/custom',
        nbextensions : '/nbextensions',
        widgets : '/deprecatedwidgets',
        kernelspecs : '/kernelspecs',
        underscore : 'components/underscore/underscore-min',
        backbone : 'components/backbone/backbone-min',
        jquery: 'components/jquery/jquery.min',
        bootstrap: 'components/bootstrap/js/bootstrap.min',
        bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
        jqueryui: 'components/jquery-ui/ui/minified/jquery-ui.min',
        moment: 'components/moment/moment',
        codemirror: 'components/codemirror',
        termjs: 'components/term.js/src/term',
      },
      shim: {
        underscore: {
          exports: '_'
        },
        backbone: {
          deps: ["underscore", "jquery"],
          exports: "Backbone"
        },
        bootstrap: {
          deps: ["jquery"],
          exports: "bootstrap"
        },
        bootstraptour: {
          deps: ["bootstrap"],
          exports: "Tour"
        },
        jqueryui: {
          deps: ["jquery"],
          exports: "$"
        }
      }
    });
    require.config({
       map: {
         '*': {
           'contents': 'services/contents',
         }
       }
     });
     window.datalab = {};
  </script>
  <script src="./1.b. Export to Google BigQuery - test data_files/main.min.js" charset="utf-8"></script>
  <script src="./1.b. Export to Google BigQuery - test data_files/api.js" async="true" defer="true"></script>
  <script type="text/fragment" id="cellStatus">
    <div class="status" style="display: none;">
      Running...
      <div class="progress progress-striped active">
        <div class="progress-bar" style="width: 100%"></div>
      </div>
    </div>
  </script>
  <script type="text/fragment" id="shortcutsHelp">
    <p>The notebook has two keyboard modes: Edit mode allows you to type code/text into a cell indicated by a raised cell with a shadow. Command mode allows notebook level actions.</p>
    <br>
    <p><b>Command Mode</b> (<code>Esc</code> to enable)</p>
    <div>
      <div><code>Enter</code>: edit mode</div>
      <div><code>Ctrl/Cmd+S</code>: save notebook</div>
      <div><code>Shift+Enter</code>: run cell, select next</div>
      <div><code>Ctrl+Enter</code>: run cell</div>
      <div><code>y</code>: to code</div>
      <div><code>m</code>: to markdown</div>
      <div><code>Up</code>: select previous cell</div>
      <div><code>Down</code>: select next cell</div>
      <div><code>Ctrl+K</code>: move cell up</div>
      <div><code>Ctrl+J</code>: move cell down</div>
      <div><code>a</code>: insert cell above</div>
      <div><code>b</code>: insert cell below</div>
      <div><code>x</code>: cut cell</div>
      <div><code>c</code>: copy cell</div>
      <div><code>v</code>: paste below</div>
      <div><code>dd</code>: delete cell</div>
      <div><code>z</code>: undo delete cell</div>
    </div>
    <br>
    <p><b>Edit Mode</b> (<code>Enter</code> to enable)</p>
    <div>
      <div><code>Esc</code>: command mode</div>
      <div><code>Ctrl/Cmd+S</code>: save notebook</div>
      <div><code>Shift+Enter</code>: run cell, select next</div>
      <div><code>Tab</code>: code completion or indent</div>
      <div><code>Shift+Tab</code>: quick help</div>
      <div><code>Ctrl/Cmd+]</code>: indent</div>
      <div><code>Ctrl/Cmd+[</code>: dedent</div>
      <div><code>Ctrl/Cmd+a</code>: select all</div>
      <div><code>Ctrl/Cmd+z</code>: undo</div>
      <div><code>Ctrl/Cmd+Shift+z</code>: redo</div>
      <div><code>Ctrl/Cmd+x</code>: cut selected</div>
      <div><code>Ctrl/Cmd+c</code>: copy selected</div>
      <div><code>Ctrl/Cmd+v</code>: paste</div>
    </div>
  </script>
  <script type="text/fragment" id="markdownHelp">
  <b>Markdown Syntax</b><br /><br />
      <b>Headers</b>
<pre># This is a level 1 header.
## This is a level 2 header.
### This is a level 3 header.</pre>
      <b>Emphasis</b>
<pre>*Italic text*
_Also italic_

**Bold text</pre>
      <b>Unordered Lists</b>
<pre>* Item 1
* Item 2
  * Item 2a</pre>
      <b>Ordered Lists</b>
<pre>1. Item 1
2. Item 2
   * Item 2a</pre>
      <b>Links</b>
<pre>http://cloud.google.com - automatic
[Text](url)</pre>
      <b>Images</b>
      <pre>![Alt Text](url)</pre>
      <b>Quoted Text</b>
<pre>&gt; Quoted Line 1
&gt; Quoted Line 2</pre>
      <b>Inline Code</b>
      <pre>Some `code` inline</pre>
      <b>Code Block</b>
<pre>Normal text

    Indented code text</pre>
    </div>
  </script>


</body></html>